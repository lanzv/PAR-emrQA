2024-05-09 21:01:41 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 143 ---------------
2024-05-09 21:01:41 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-09 21:01:41 INFO     Contexts were splited into 1160 paragraphs, which are 3.8926174496644297 paragraphs on average per one report. There are 6 unique topics with frequency threshold (greater or equal) 143. The overall paragraph average length (characters) is 1455.0836206896552
2024-05-09 21:01:41 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-09 21:01:41 INFO     Contexts were splited into 160 paragraphs, which are 3.8095238095238093 paragraphs on average per one report. There are 6 unique topics with frequency threshold (greater or equal) 143. The overall paragraph average length (characters) is 1147.925
2024-05-09 21:01:42 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-09 21:01:42 INFO     Contexts were splited into 323 paragraphs, which are 3.755813953488372 paragraphs on average per one report. There are 6 unique topics with frequency threshold (greater or equal) 143. The overall paragraph average length (characters) is 1332.3188854489165
2024-05-09 21:02:19 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 21:10:55 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 23:27:08 INFO     the model is trained
2024-05-09 23:50:53 INFO     evaluation data are prepared
2024-05-10 04:50:50 INFO     QA scores: {'exact_match': 91.02825008429267, 'f1': 96.63932248858163}
2024-05-10 04:50:50 INFO     PR scores: {'p@1': 0.99487018929724, 'p@2': 0.9997832474350946, 'p@3': 1.0}
2024-05-10 04:51:00 INFO     PRQA scores: {'exact_match': 90.5592216174558, 'f1': 96.29735517847371}
{'loss': 0.6082, 'grad_norm': 6.011734485626221, 'learning_rate': 2.9150622876557194e-05, 'epoch': 0.028312570781426953}
{'loss': 0.213, 'grad_norm': 7.048251628875732, 'learning_rate': 2.8301245753114384e-05, 'epoch': 0.056625141562853906}
{'loss': 0.1867, 'grad_norm': 0.514907956123352, 'learning_rate': 2.7451868629671577e-05, 'epoch': 0.08493771234428087}
{'loss': 0.1785, 'grad_norm': 12.019368171691895, 'learning_rate': 2.6602491506228767e-05, 'epoch': 0.11325028312570781}
{'loss': 0.1442, 'grad_norm': 2.330886125564575, 'learning_rate': 2.5753114382785957e-05, 'epoch': 0.14156285390713477}
{'loss': 0.1327, 'grad_norm': 9.6502046585083, 'learning_rate': 2.4903737259343146e-05, 'epoch': 0.16987542468856173}
{'loss': 0.1246, 'grad_norm': 10.928606986999512, 'learning_rate': 2.405436013590034e-05, 'epoch': 0.19818799546998866}
{'loss': 0.1138, 'grad_norm': 0.11596649885177612, 'learning_rate': 2.320498301245753e-05, 'epoch': 0.22650056625141562}
{'loss': 0.112, 'grad_norm': 0.041118428111076355, 'learning_rate': 2.2355605889014723e-05, 'epoch': 0.2548131370328426}
{'loss': 0.112, 'grad_norm': 10.86608600616455, 'learning_rate': 2.1506228765571916e-05, 'epoch': 0.28312570781426954}
{'loss': 0.1149, 'grad_norm': 21.850656509399414, 'learning_rate': 2.0656851642129106e-05, 'epoch': 0.3114382785956965}
{'loss': 0.0959, 'grad_norm': 0.02368081919848919, 'learning_rate': 1.98074745186863e-05, 'epoch': 0.33975084937712347}
{'loss': 0.098, 'grad_norm': 0.32477787137031555, 'learning_rate': 1.895809739524349e-05, 'epoch': 0.36806342015855037}
{'loss': 0.0883, 'grad_norm': 0.04433031752705574, 'learning_rate': 1.8108720271800682e-05, 'epoch': 0.39637599093997733}
{'loss': 0.0858, 'grad_norm': 0.08059762418270111, 'learning_rate': 1.7259343148357872e-05, 'epoch': 0.4246885617214043}
{'loss': 0.0807, 'grad_norm': 0.12763625383377075, 'learning_rate': 1.640996602491506e-05, 'epoch': 0.45300113250283125}
{'loss': 0.0934, 'grad_norm': 0.010623058304190636, 'learning_rate': 1.556058890147225e-05, 'epoch': 0.4813137032842582}
{'loss': 0.0734, 'grad_norm': 9.929195404052734, 'learning_rate': 1.4711211778029445e-05, 'epoch': 0.5096262740656852}
{'loss': 0.0752, 'grad_norm': 1.0681251287460327, 'learning_rate': 1.3861834654586636e-05, 'epoch': 0.5379388448471121}
{'loss': 0.0649, 'grad_norm': 0.013749559409916401, 'learning_rate': 1.3012457531143828e-05, 'epoch': 0.5662514156285391}
{'loss': 0.0629, 'grad_norm': 4.749884128570557, 'learning_rate': 1.2163080407701019e-05, 'epoch': 0.594563986409966}
{'loss': 0.0697, 'grad_norm': 0.4687754511833191, 'learning_rate': 1.1313703284258212e-05, 'epoch': 0.622876557191393}
{'loss': 0.0646, 'grad_norm': 1.936747431755066, 'learning_rate': 1.0464326160815402e-05, 'epoch': 0.6511891279728199}
{'loss': 0.0581, 'grad_norm': 0.12669728696346283, 'learning_rate': 9.614949037372594e-06, 'epoch': 0.6795016987542469}
{'loss': 0.0634, 'grad_norm': 0.12682949006557465, 'learning_rate': 8.765571913929785e-06, 'epoch': 0.7078142695356738}
{'loss': 0.0647, 'grad_norm': 11.486739158630371, 'learning_rate': 7.916194790486977e-06, 'epoch': 0.7361268403171007}
{'loss': 0.0474, 'grad_norm': 0.16612739861011505, 'learning_rate': 7.066817667044167e-06, 'epoch': 0.7644394110985278}
{'loss': 0.0465, 'grad_norm': 0.004920412786304951, 'learning_rate': 6.21744054360136e-06, 'epoch': 0.7927519818799547}
{'loss': 0.0442, 'grad_norm': 0.02390267699956894, 'learning_rate': 5.36806342015855e-06, 'epoch': 0.8210645526613817}
{'loss': 0.0428, 'grad_norm': 0.006070475094020367, 'learning_rate': 4.518686296715742e-06, 'epoch': 0.8493771234428086}
{'loss': 0.0429, 'grad_norm': 0.04046383872628212, 'learning_rate': 3.669309173272933e-06, 'epoch': 0.8776896942242356}
{'loss': 0.0558, 'grad_norm': 13.350519180297852, 'learning_rate': 2.8199320498301245e-06, 'epoch': 0.9060022650056625}
{'loss': 0.0502, 'grad_norm': 2.2387895584106445, 'learning_rate': 1.970554926387316e-06, 'epoch': 0.9343148357870895}
{'loss': 0.0414, 'grad_norm': 0.17502841353416443, 'learning_rate': 1.1211778029445075e-06, 'epoch': 0.9626274065685164}
{'loss': 0.0432, 'grad_norm': 24.689228057861328, 'learning_rate': 2.718006795016988e-07, 'epoch': 0.9909399773499433}
{'eval_loss': 0.23511579632759094, 'eval_runtime': 3399.7881, 'eval_samples_per_second': 179.276, 'eval_steps_per_second': 0.7, 'epoch': 1.0}
{'train_runtime': 8171.8327, 'train_samples_per_second': 34.576, 'train_steps_per_second': 2.161, 'train_loss': 0.10209084016145423, 'epoch': 1.0}
Post-processing 654532 example predictions split into 1782048 features.
{
    "143": {
        "QA": {
            "exact_match": 91.02825008429267,
            "f1": 96.63932248858163
        },
        "PR": {
            "p@1": 0.99487018929724,
            "p@2": 0.9997832474350946,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 90.5592216174558,
            "f1": 96.29735517847371
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 3659667 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 3659667 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
