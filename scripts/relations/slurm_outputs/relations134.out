2024-05-09 20:43:23 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 134 ---------------
2024-05-09 20:43:23 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-09 20:43:23 INFO     Contexts were splited into 1585 paragraphs, which are 5.318791946308725 paragraphs on average per one report. There are 9 unique topics with frequency threshold (greater or equal) 134. The overall paragraph average length (characters) is 1064.9192429022082
2024-05-09 20:43:23 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-09 20:43:23 INFO     Contexts were splited into 204 paragraphs, which are 4.857142857142857 paragraphs on average per one report. There are 9 unique topics with frequency threshold (greater or equal) 134. The overall paragraph average length (characters) is 900.3333333333334
2024-05-09 20:43:24 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-09 20:43:24 INFO     Contexts were splited into 428 paragraphs, which are 4.976744186046512 paragraphs on average per one report. There are 9 unique topics with frequency threshold (greater or equal) 134. The overall paragraph average length (characters) is 1005.4649532710281
2024-05-09 20:44:02 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 20:52:17 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 22:58:18 INFO     the model is trained
2024-05-09 23:24:16 INFO     evaluation data are prepared
2024-05-10 04:54:20 INFO     QA scores: {'exact_match': 91.29919079042435, 'f1': 96.70482923569749}
2024-05-10 04:54:21 INFO     PR scores: {'p@1': 0.9949665237705313, 'p@2': 0.9999217282404509, 'p@3': 0.9999518327633544}
2024-05-10 04:54:31 INFO     PRQA scores: {'exact_match': 90.83317277587784, 'f1': 96.33966996907591}
{'loss': 0.5977, 'grad_norm': 8.662479400634766, 'learning_rate': 2.9077320538844805e-05, 'epoch': 0.03075598203850649}
{'loss': 0.2077, 'grad_norm': 4.136407375335693, 'learning_rate': 2.815464107768961e-05, 'epoch': 0.06151196407701298}
{'loss': 0.1676, 'grad_norm': 3.1842379570007324, 'learning_rate': 2.7231961616534418e-05, 'epoch': 0.09226794611551947}
{'loss': 0.155, 'grad_norm': 12.2179536819458, 'learning_rate': 2.6309282155379222e-05, 'epoch': 0.12302392815402596}
{'loss': 0.1279, 'grad_norm': 4.941551208496094, 'learning_rate': 2.5386602694224027e-05, 'epoch': 0.15377991019253245}
{'loss': 0.126, 'grad_norm': 5.150548934936523, 'learning_rate': 2.446392323306883e-05, 'epoch': 0.18453589223103894}
{'loss': 0.1245, 'grad_norm': 1.1013929843902588, 'learning_rate': 2.354124377191364e-05, 'epoch': 0.21529187426954544}
{'loss': 0.1119, 'grad_norm': 7.38391637802124, 'learning_rate': 2.2618564310758444e-05, 'epoch': 0.24604785630805193}
{'loss': 0.122, 'grad_norm': 6.0566887855529785, 'learning_rate': 2.1695884849603248e-05, 'epoch': 0.2768038383465584}
{'loss': 0.0935, 'grad_norm': 0.6916691064834595, 'learning_rate': 2.0773205388448053e-05, 'epoch': 0.3075598203850649}
{'loss': 0.1004, 'grad_norm': 0.0526130236685276, 'learning_rate': 1.9850525927292857e-05, 'epoch': 0.3383158024235714}
{'loss': 0.09, 'grad_norm': 19.421693801879883, 'learning_rate': 1.8927846466137665e-05, 'epoch': 0.3690717844620779}
{'loss': 0.0915, 'grad_norm': 0.20815232396125793, 'learning_rate': 1.800516700498247e-05, 'epoch': 0.3998277665005844}
{'loss': 0.0944, 'grad_norm': 2.3956522941589355, 'learning_rate': 1.7082487543827274e-05, 'epoch': 0.43058374853909087}
{'loss': 0.0816, 'grad_norm': 0.042793501168489456, 'learning_rate': 1.615980808267208e-05, 'epoch': 0.46133973057759736}
{'loss': 0.071, 'grad_norm': 2.1678974628448486, 'learning_rate': 1.5237128621516885e-05, 'epoch': 0.49209571261610385}
{'loss': 0.0789, 'grad_norm': 0.20762179791927338, 'learning_rate': 1.431444916036169e-05, 'epoch': 0.5228516946546103}
{'loss': 0.0669, 'grad_norm': 0.017786651849746704, 'learning_rate': 1.3391769699206495e-05, 'epoch': 0.5536076766931168}
{'loss': 0.0749, 'grad_norm': 0.028897052630782127, 'learning_rate': 1.24690902380513e-05, 'epoch': 0.5843636587316233}
{'loss': 0.0575, 'grad_norm': 11.8399658203125, 'learning_rate': 1.1546410776896106e-05, 'epoch': 0.6151196407701298}
{'loss': 0.0576, 'grad_norm': 19.414464950561523, 'learning_rate': 1.062373131574091e-05, 'epoch': 0.6458756228086363}
{'loss': 0.0596, 'grad_norm': 0.28852763772010803, 'learning_rate': 9.701051854585718e-06, 'epoch': 0.6766316048471428}
{'loss': 0.054, 'grad_norm': 0.00873500108718872, 'learning_rate': 8.778372393430523e-06, 'epoch': 0.7073875868856493}
{'loss': 0.0577, 'grad_norm': 0.037777822464704514, 'learning_rate': 7.855692932275329e-06, 'epoch': 0.7381435689241558}
{'loss': 0.0514, 'grad_norm': 0.018832476809620857, 'learning_rate': 6.933013471120133e-06, 'epoch': 0.7688995509626623}
{'loss': 0.0372, 'grad_norm': 0.007408710662275553, 'learning_rate': 6.010334009964938e-06, 'epoch': 0.7996555330011688}
{'loss': 0.0533, 'grad_norm': 0.017622018232941628, 'learning_rate': 5.0876545488097435e-06, 'epoch': 0.8304115150396753}
{'loss': 0.0463, 'grad_norm': 17.28207015991211, 'learning_rate': 4.164975087654549e-06, 'epoch': 0.8611674970781817}
{'loss': 0.0431, 'grad_norm': 0.015090548433363438, 'learning_rate': 3.242295626499354e-06, 'epoch': 0.8919234791166882}
{'loss': 0.0409, 'grad_norm': 0.022804228588938713, 'learning_rate': 2.3196161653441595e-06, 'epoch': 0.9226794611551947}
{'loss': 0.0472, 'grad_norm': 1.0765624046325684, 'learning_rate': 1.3969367041889649e-06, 'epoch': 0.9534354431937012}
{'loss': 0.0382, 'grad_norm': 0.1309109628200531, 'learning_rate': 4.7425724303377006e-07, 'epoch': 0.9841914252322077}
{'eval_loss': 0.2412390410900116, 'eval_runtime': 3181.304, 'eval_samples_per_second': 179.538, 'eval_steps_per_second': 0.702, 'epoch': 1.0}
{'train_runtime': 7560.1986, 'train_samples_per_second': 34.404, 'train_steps_per_second': 2.15, 'train_loss': 0.10006326847999762, 'epoch': 1.0}
Post-processing 897369 example predictions split into 1972030 features.
{
    "134": {
        "QA": {
            "exact_match": 91.29919079042435,
            "f1": 96.70482923569749
        },
        "PR": {
            "p@1": 0.9949665237705313,
            "p@2": 0.9999217282404509,
            "p@3": 0.9999518327633544
        },
        "PRQA": {
            "exact_match": 90.83317277587784,
            "f1": 96.33966996907591
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2741542 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2741542 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
