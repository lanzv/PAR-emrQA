2024-05-09 21:03:09 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 157 ---------------
2024-05-09 21:03:09 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-09 21:03:09 INFO     Contexts were splited into 555 paragraphs, which are 1.8624161073825503 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 3041.2558558558558
2024-05-09 21:03:09 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-09 21:03:09 INFO     Contexts were splited into 83 paragraphs, which are 1.9761904761904763 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2212.867469879518
2024-05-09 21:03:10 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-09 21:03:10 INFO     Contexts were splited into 163 paragraphs, which are 1.8953488372093024 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2640.116564417178
2024-05-09 21:03:48 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 21:13:44 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 23:48:13 INFO     the model is trained
2024-05-10 00:09:59 INFO     evaluation data are prepared
2024-05-10 04:33:17 INFO     QA scores: {'exact_match': 91.4551322190646, 'f1': 96.60851006853338}
2024-05-10 04:33:18 INFO     PR scores: {'p@1': 0.9995785366793507, 'p@2': 1.0, 'p@3': 1.0}
2024-05-10 04:33:28 INFO     PRQA scores: {'exact_match': 91.41298588699966, 'f1': 96.58468118078915}
{'loss': 0.6036, 'grad_norm': 8.22940444946289, 'learning_rate': 2.925808685329904e-05, 'epoch': 0.02473043822336532}
{'loss': 0.2218, 'grad_norm': 3.923910140991211, 'learning_rate': 2.8516173706598082e-05, 'epoch': 0.04946087644673064}
{'loss': 0.1838, 'grad_norm': 0.10071410983800888, 'learning_rate': 2.777426055989712e-05, 'epoch': 0.07419131467009596}
{'loss': 0.1609, 'grad_norm': 3.3512675762176514, 'learning_rate': 2.7032347413196164e-05, 'epoch': 0.09892175289346128}
{'loss': 0.143, 'grad_norm': 3.275097370147705, 'learning_rate': 2.6290434266495205e-05, 'epoch': 0.12365219111682658}
{'loss': 0.1342, 'grad_norm': 5.523402690887451, 'learning_rate': 2.5548521119794245e-05, 'epoch': 0.14838262934019192}
{'loss': 0.1196, 'grad_norm': 0.039619896560907364, 'learning_rate': 2.4806607973093283e-05, 'epoch': 0.17311306756355724}
{'loss': 0.138, 'grad_norm': 3.324822187423706, 'learning_rate': 2.4064694826392323e-05, 'epoch': 0.19784350578692256}
{'loss': 0.1191, 'grad_norm': 18.059532165527344, 'learning_rate': 2.3322781679691364e-05, 'epoch': 0.22257394401028785}
{'loss': 0.1097, 'grad_norm': 0.0016398370498791337, 'learning_rate': 2.2580868532990405e-05, 'epoch': 0.24730438223365317}
{'loss': 0.1071, 'grad_norm': 5.357349872589111, 'learning_rate': 2.1838955386289446e-05, 'epoch': 0.2720348204570185}
{'loss': 0.1056, 'grad_norm': 0.47821205854415894, 'learning_rate': 2.1097042239588487e-05, 'epoch': 0.29676525868038384}
{'loss': 0.1051, 'grad_norm': 0.04749542847275734, 'learning_rate': 2.0355129092887527e-05, 'epoch': 0.32149569690374913}
{'loss': 0.1008, 'grad_norm': 13.644977569580078, 'learning_rate': 1.9613215946186568e-05, 'epoch': 0.3462261351271145}
{'loss': 0.0885, 'grad_norm': 22.05729103088379, 'learning_rate': 1.8871302799485605e-05, 'epoch': 0.37095657335047977}
{'loss': 0.0868, 'grad_norm': 1.0590457916259766, 'learning_rate': 1.8129389652784646e-05, 'epoch': 0.3956870115738451}
{'loss': 0.0896, 'grad_norm': 0.20291557908058167, 'learning_rate': 1.7387476506083687e-05, 'epoch': 0.4204174497972104}
{'loss': 0.0824, 'grad_norm': 4.678496837615967, 'learning_rate': 1.664556335938273e-05, 'epoch': 0.4451478880205757}
{'loss': 0.0854, 'grad_norm': 0.13391846418380737, 'learning_rate': 1.5903650212681772e-05, 'epoch': 0.46987832624394105}
{'loss': 0.0847, 'grad_norm': 0.21668094396591187, 'learning_rate': 1.516173706598081e-05, 'epoch': 0.49460876446730634}
{'loss': 0.0722, 'grad_norm': 0.040641967207193375, 'learning_rate': 1.441982391927985e-05, 'epoch': 0.5193392026906717}
{'loss': 0.0756, 'grad_norm': 28.947589874267578, 'learning_rate': 1.367791077257889e-05, 'epoch': 0.544069640914037}
{'loss': 0.0705, 'grad_norm': 0.13060228526592255, 'learning_rate': 1.293599762587793e-05, 'epoch': 0.5688000791374023}
{'loss': 0.0694, 'grad_norm': 0.04324826970696449, 'learning_rate': 1.2194084479176972e-05, 'epoch': 0.5935305173607677}
{'loss': 0.0715, 'grad_norm': 14.648902893066406, 'learning_rate': 1.1452171332476011e-05, 'epoch': 0.618260955584133}
{'loss': 0.0689, 'grad_norm': 0.11446548253297806, 'learning_rate': 1.0710258185775052e-05, 'epoch': 0.6429913938074983}
{'loss': 0.0608, 'grad_norm': 0.16916869580745697, 'learning_rate': 9.968345039074093e-06, 'epoch': 0.6677218320308635}
{'loss': 0.0615, 'grad_norm': 21.985578536987305, 'learning_rate': 9.226431892373134e-06, 'epoch': 0.692452270254229}
{'loss': 0.054, 'grad_norm': 3.8948116302490234, 'learning_rate': 8.484518745672173e-06, 'epoch': 0.7171827084775942}
{'loss': 0.0513, 'grad_norm': 0.0013940682401880622, 'learning_rate': 7.742605598971213e-06, 'epoch': 0.7419131467009595}
{'loss': 0.0559, 'grad_norm': 0.07545860856771469, 'learning_rate': 7.000692452270254e-06, 'epoch': 0.7666435849243248}
{'loss': 0.0558, 'grad_norm': 0.07577254623174667, 'learning_rate': 6.258779305569295e-06, 'epoch': 0.7913740231476902}
{'loss': 0.0451, 'grad_norm': 27.93686866760254, 'learning_rate': 5.516866158868335e-06, 'epoch': 0.8161044613710555}
{'loss': 0.0471, 'grad_norm': 0.01211193110793829, 'learning_rate': 4.774953012167376e-06, 'epoch': 0.8408348995944208}
{'loss': 0.0472, 'grad_norm': 0.836586594581604, 'learning_rate': 4.033039865466416e-06, 'epoch': 0.8655653378177861}
{'loss': 0.0483, 'grad_norm': 0.3872912526130676, 'learning_rate': 3.2911267187654563e-06, 'epoch': 0.8902957760411514}
{'loss': 0.0559, 'grad_norm': 0.22116367518901825, 'learning_rate': 2.5492135720644967e-06, 'epoch': 0.9150262142645168}
{'loss': 0.0428, 'grad_norm': 0.020304864272475243, 'learning_rate': 1.8073004253635374e-06, 'epoch': 0.9397566524878821}
{'loss': 0.0445, 'grad_norm': 0.0034695123322308064, 'learning_rate': 1.0653872786625778e-06, 'epoch': 0.9644870907112474}
{'loss': 0.0506, 'grad_norm': 1.2940187454223633, 'learning_rate': 3.234741319616184e-07, 'epoch': 0.9892175289346127}
{'eval_loss': 0.22405464947223663, 'eval_runtime': 3805.0448, 'eval_samples_per_second': 178.712, 'eval_steps_per_second': 0.698, 'epoch': 1.0}
{'train_runtime': 9268.5301, 'train_samples_per_second': 34.901, 'train_steps_per_second': 2.181, 'train_loss': 0.09996388047912942, 'epoch': 1.0}
Post-processing 331289 example predictions split into 1566337 features.
{
    "157": {
        "QA": {
            "exact_match": 91.4551322190646,
            "f1": 96.60851006853338
        },
        "PR": {
            "p@1": 0.9995785366793507,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 91.41298588699966,
            "f1": 96.58468118078915
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2662991 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2662991 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
