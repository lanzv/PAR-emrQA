2024-05-09 15:16:06 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 89 ---------------
2024-05-09 15:16:07 INFO     Contexts were splited into 963 paragraphs, which are 5.262295081967213 paragraphs on average per one report. The overall paragraph average length (characters) is 1249.5067497403945
2024-05-09 15:16:07 INFO     Contexts were splited into 147 paragraphs, which are 5.653846153846154 paragraphs on average per one report. The overall paragraph average length (characters) is 1232.0680272108843
2024-05-09 15:16:07 INFO     Contexts were splited into 271 paragraphs, which are 5.113207547169812 paragraphs on average per one report. The overall paragraph average length (characters) is 1250.8560885608856
2024-05-09 15:16:14 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 15:17:54 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 15:49:42 INFO     the model is trained
2024-05-09 15:54:50 INFO     evaluation data are prepared
2024-05-09 16:57:15 INFO     QA scores: {'exact_match': 30.413212490872386, 'f1': 72.95328801604231}
2024-05-09 16:57:15 INFO     PR scores: {'p@1': 0.9047291782999012, 'p@2': 0.9859542115888493, 'p@3': 0.9971650702289421}
2024-05-09 16:57:18 INFO     PRQA scores: {'exact_match': 29.524075426313303, 'f1': 69.3757573913818}
{'loss': 1.5561, 'grad_norm': 7.939765453338623, 'learning_rate': 2.74674995779166e-05, 'epoch': 0.08441668073611346}
{'loss': 0.9703, 'grad_norm': 8.391008377075195, 'learning_rate': 2.4934999155833193e-05, 'epoch': 0.1688333614722269}
{'loss': 0.8696, 'grad_norm': 8.421887397766113, 'learning_rate': 2.240249873374979e-05, 'epoch': 0.25325004220834035}
{'loss': 0.7314, 'grad_norm': 9.181966781616211, 'learning_rate': 1.9869998311666385e-05, 'epoch': 0.3376667229444538}
{'loss': 0.6268, 'grad_norm': 13.68423843383789, 'learning_rate': 1.7337497889582983e-05, 'epoch': 0.4220834036805673}
{'loss': 0.5337, 'grad_norm': 15.777860641479492, 'learning_rate': 1.4804997467499577e-05, 'epoch': 0.5065000844166807}
{'loss': 0.4806, 'grad_norm': 15.225244522094727, 'learning_rate': 1.2272497045416175e-05, 'epoch': 0.5909167651527942}
{'loss': 0.4585, 'grad_norm': 14.359308242797852, 'learning_rate': 9.739996623332771e-06, 'epoch': 0.6753334458889076}
{'loss': 0.3866, 'grad_norm': 12.961953163146973, 'learning_rate': 7.207496201249367e-06, 'epoch': 0.7597501266250211}
{'loss': 0.3461, 'grad_norm': 14.016655921936035, 'learning_rate': 4.6749957791659636e-06, 'epoch': 0.8441668073611346}
{'loss': 0.3407, 'grad_norm': 20.892980575561523, 'learning_rate': 2.1424953570825597e-06, 'epoch': 0.928583488097248}
{'eval_loss': 1.6644806861877441, 'eval_runtime': 311.2662, 'eval_samples_per_second': 178.783, 'eval_steps_per_second': 0.7, 'epoch': 1.0}
{'train_runtime': 1907.1356, 'train_samples_per_second': 49.69, 'train_steps_per_second': 3.106, 'train_loss': 0.6394973283439558, 'epoch': 1.0}
Post-processing 266076 example predictions split into 359959 features.
{
    "89": {
        "QA": {
            "exact_match": 30.413212490872386,
            "f1": 72.95328801604231
        },
        "PR": {
            "p@1": 0.9047291782999012,
            "p@2": 0.9859542115888493,
            "p@3": 0.9971650702289421
        },
        "PRQA": {
            "exact_match": 29.524075426313303,
            "f1": 69.3757573913818
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 487633 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 487633 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
