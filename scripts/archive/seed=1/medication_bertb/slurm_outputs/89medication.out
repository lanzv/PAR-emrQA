2024-05-09 18:03:45 INFO     ------------- Experiment: model BERTbase, frequency threshold 89 ---------------
2024-05-09 18:03:45 INFO     Contexts were splited into 4977 sentence groups, which are 27.19672131147541 groups on average per one report
2024-05-09 18:03:46 INFO     Contexts were splited into 980 paragraphs, which are 5.355191256830601 paragraphs on average per one report. There are 6 unique topics with frequency threshold (greater or equal) 89. The overall paragraph average length (characters) is 1245.9469387755103
2024-05-09 18:03:46 INFO     Contexts were splited into 818 sentence groups, which are 31.46153846153846 groups on average per one report
2024-05-09 18:03:46 INFO     Contexts were splited into 110 paragraphs, which are 4.230769230769231 paragraphs on average per one report. There are 6 unique topics with frequency threshold (greater or equal) 89. The overall paragraph average length (characters) is 1665.9727272727273
2024-05-09 18:03:46 INFO     Contexts were splited into 1362 sentence groups, which are 25.69811320754717 groups on average per one report
2024-05-09 18:03:47 WARNING  The evidenc 'CEFPODOXIME PROXETIL 200 MG PO BID X 16 doses
Food/Drug Interaction Instruction Give with meals
' is in wrong format and it does not occure in the paragraph 'POTENTIALLY SERIOUS INTERACTION: WARFARIN &amp; SIMVASTATIN
Reason for override: already tolerated , home medication ,
aware
CEFPODOXIME PROXETIL 200 MG PO BID X 16 doses
Starting Today ( 6/25 ) HOLD IF: rash
Food/Drug Interaction Instruction Give with meals
Alert overridden: Override added on 11/4/05 by :
on order for CEFPODOXIME PROXETIL PO ( ref # 703442345 )
Pt. has a POSSIBLE allergy to Penicillins; reaction is
RASH. Reason for override: cannot tolerate floroquinolones
and needs gram neg coverage. has
tolerated cefalosporins well in the past.
'
2024-05-09 18:03:47 INFO     Contexts were splited into 274 paragraphs, which are 5.169811320754717 paragraphs on average per one report. There are 6 unique topics with frequency threshold (greater or equal) 89. The overall paragraph average length (characters) is 1254.7773722627737
2024-05-09 18:03:57 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/bert-base-cased and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 18:07:54 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 19:26:05 INFO     the model is trained
2024-05-09 19:32:20 INFO     evaluation data are prepared
2024-05-09 21:01:25 INFO     QA scores: {'exact_match': 29.551995189210086, 'f1': 69.69034502699435}
2024-05-09 21:01:25 INFO     PR scores: {'p@1': 0.9455564623512736, 'p@2': 0.9949529659378893, 'p@3': 0.9976590352648083}
2024-05-09 21:01:28 INFO     PRQA scores: {'exact_match': 28.317082599544694, 'f1': 67.63192431266978}
{'loss': 1.1987, 'grad_norm': 11.10340404510498, 'learning_rate': 2.8916576381365114e-05, 'epoch': 0.03611412062116288}
{'loss': 0.8097, 'grad_norm': 11.27602767944336, 'learning_rate': 2.783315276273023e-05, 'epoch': 0.07222824124232576}
{'loss': 0.704, 'grad_norm': 5.7502031326293945, 'learning_rate': 2.674972914409534e-05, 'epoch': 0.10834236186348863}
{'loss': 0.6513, 'grad_norm': 12.691963195800781, 'learning_rate': 2.5666305525460455e-05, 'epoch': 0.1444564824846515}
{'loss': 0.5874, 'grad_norm': 9.276849746704102, 'learning_rate': 2.4582881906825568e-05, 'epoch': 0.18057060310581438}
{'loss': 0.5613, 'grad_norm': 22.55744171142578, 'learning_rate': 2.3499458288190684e-05, 'epoch': 0.21668472372697725}
{'loss': 0.4904, 'grad_norm': 7.137096881866455, 'learning_rate': 2.2416034669555797e-05, 'epoch': 0.25279884434814015}
{'loss': 0.4558, 'grad_norm': 13.550664901733398, 'learning_rate': 2.133261105092091e-05, 'epoch': 0.288912964969303}
{'loss': 0.4499, 'grad_norm': 16.83051872253418, 'learning_rate': 2.0249187432286023e-05, 'epoch': 0.3250270855904659}
{'loss': 0.3926, 'grad_norm': 12.664731979370117, 'learning_rate': 1.916576381365114e-05, 'epoch': 0.36114120621162876}
{'loss': 0.3785, 'grad_norm': 8.358973503112793, 'learning_rate': 1.8082340195016252e-05, 'epoch': 0.39725532683279163}
{'loss': 0.3675, 'grad_norm': 16.3909854888916, 'learning_rate': 1.6998916576381368e-05, 'epoch': 0.4333694474539545}
{'loss': 0.3171, 'grad_norm': 22.55072784423828, 'learning_rate': 1.5915492957746478e-05, 'epoch': 0.4694835680751174}
{'loss': 0.3214, 'grad_norm': 9.228337287902832, 'learning_rate': 1.4832069339111594e-05, 'epoch': 0.5055976886962803}
{'loss': 0.3145, 'grad_norm': 7.790727138519287, 'learning_rate': 1.3748645720476707e-05, 'epoch': 0.5417118093174431}
{'loss': 0.2757, 'grad_norm': 9.94100284576416, 'learning_rate': 1.2665222101841821e-05, 'epoch': 0.577825929938606}
{'loss': 0.2707, 'grad_norm': 1.6934916973114014, 'learning_rate': 1.1581798483206934e-05, 'epoch': 0.6139400505597689}
{'loss': 0.2615, 'grad_norm': 8.050317764282227, 'learning_rate': 1.0498374864572048e-05, 'epoch': 0.6500541711809318}
{'loss': 0.2304, 'grad_norm': 2.1986138820648193, 'learning_rate': 9.414951245937163e-06, 'epoch': 0.6861682918020946}
{'loss': 0.2169, 'grad_norm': 12.246383666992188, 'learning_rate': 8.331527627302276e-06, 'epoch': 0.7222824124232575}
{'loss': 0.2322, 'grad_norm': 14.98646068572998, 'learning_rate': 7.248104008667389e-06, 'epoch': 0.7583965330444203}
{'loss': 0.2217, 'grad_norm': 1.6652984619140625, 'learning_rate': 6.164680390032503e-06, 'epoch': 0.7945106536655833}
{'loss': 0.2073, 'grad_norm': 0.36328476667404175, 'learning_rate': 5.081256771397617e-06, 'epoch': 0.8306247742867461}
{'loss': 0.1906, 'grad_norm': 5.021350860595703, 'learning_rate': 3.99783315276273e-06, 'epoch': 0.866738894907909}
{'loss': 0.2028, 'grad_norm': 7.232862949371338, 'learning_rate': 2.914409534127844e-06, 'epoch': 0.9028530155290718}
{'loss': 0.1802, 'grad_norm': 2.0005030632019043, 'learning_rate': 1.8309859154929577e-06, 'epoch': 0.9389671361502347}
{'loss': 0.1675, 'grad_norm': 23.351032257080078, 'learning_rate': 7.475622968580716e-07, 'epoch': 0.9750812567713976}
{'eval_loss': 0.9091967940330505, 'eval_runtime': 950.9026, 'eval_samples_per_second': 179.366, 'eval_steps_per_second': 0.701, 'epoch': 1.0}
{'train_runtime': 4690.8272, 'train_samples_per_second': 47.223, 'train_steps_per_second': 2.952, 'train_loss': 0.38937917745858164, 'epoch': 1.0}
Post-processing 251162 example predictions split into 536291 features.
{
    "89": {
        "QA": {
            "exact_match": 29.551995189210086,
            "f1": 69.69034502699435
        },
        "PR": {
            "p@1": 0.9455564623512736,
            "p@2": 0.9949529659378893,
            "p@3": 0.9976590352648083
        },
        "PRQA": {
            "exact_match": 28.317082599544694,
            "f1": 67.63192431266978
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 3659209 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 3659209 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
