2024-05-09 18:38:34 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 0 ---------------
2024-05-09 18:38:34 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-09 18:38:34 INFO     Contexts were splited into 6645 paragraphs, which are 22.298657718120804 paragraphs on average per one report. There are 953 unique topics with frequency threshold (greater or equal) 0. The overall paragraph average length (characters) is 254.01008276899924
2024-05-09 18:38:34 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-09 18:38:34 INFO     Contexts were splited into 938 paragraphs, which are 22.333333333333332 paragraphs on average per one report. There are 953 unique topics with frequency threshold (greater or equal) 0. The overall paragraph average length (characters) is 195.8081023454158
2024-05-09 18:38:35 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-09 18:38:35 INFO     Contexts were splited into 1899 paragraphs, which are 22.08139534883721 paragraphs on average per one report. There are 953 unique topics with frequency threshold (greater or equal) 0. The overall paragraph average length (characters) is 226.61348077935756
2024-05-09 18:39:19 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 18:42:05 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 19:28:33 INFO     the model is trained
2024-05-09 20:10:14 INFO     evaluation data are prepared
2024-05-10 08:57:26 INFO     QA scores: {'exact_match': 93.84844178989451, 'f1': 97.62100514049861}
2024-05-10 08:57:26 INFO     PR scores: {'p@1': 0.9814796975097538, 'p@2': 0.9975856172631377, 'p@3': 0.9996568084388998}
2024-05-10 08:57:36 INFO     PRQA scores: {'exact_match': 92.24688117142719, 'f1': 96.32121445814634}
{'loss': 0.6265, 'grad_norm': 10.376797676086426, 'learning_rate': 2.7367497367497367e-05, 'epoch': 0.08775008775008775}
{'loss': 0.209, 'grad_norm': 13.897310256958008, 'learning_rate': 2.4734994734994737e-05, 'epoch': 0.1755001755001755}
{'loss': 0.1611, 'grad_norm': 6.016261100769043, 'learning_rate': 2.2102492102492103e-05, 'epoch': 0.26325026325026324}
{'loss': 0.1364, 'grad_norm': 0.1646532267332077, 'learning_rate': 1.946998946998947e-05, 'epoch': 0.351000351000351}
{'loss': 0.1136, 'grad_norm': 0.05239497125148773, 'learning_rate': 1.683748683748684e-05, 'epoch': 0.43875043875043873}
{'loss': 0.0985, 'grad_norm': 0.9506116509437561, 'learning_rate': 1.4204984204984206e-05, 'epoch': 0.5265005265005265}
{'loss': 0.0969, 'grad_norm': 12.020471572875977, 'learning_rate': 1.1572481572481574e-05, 'epoch': 0.6142506142506142}
{'loss': 0.0709, 'grad_norm': 7.111248016357422, 'learning_rate': 8.939978939978939e-06, 'epoch': 0.702000702000702}
{'loss': 0.0774, 'grad_norm': 23.541982650756836, 'learning_rate': 6.307476307476308e-06, 'epoch': 0.7897507897507897}
{'loss': 0.0628, 'grad_norm': 0.06996525079011917, 'learning_rate': 3.674973674973675e-06, 'epoch': 0.8775008775008775}
{'loss': 0.0652, 'grad_norm': 0.09220309555530548, 'learning_rate': 1.0424710424710424e-06, 'epoch': 0.9652509652509652}
{'eval_loss': 0.237728551030159, 'eval_runtime': 1257.8465, 'eval_samples_per_second': 179.706, 'eval_steps_per_second': 0.702, 'epoch': 1.0}
{'train_runtime': 2787.5773, 'train_samples_per_second': 32.703, 'train_steps_per_second': 2.044, 'train_loss': 0.15312859316632052, 'epoch': 1.0}
Post-processing 4285518 example predictions split into 4632909 features.
{
    "0": {
        "QA": {
            "exact_match": 93.84844178989451,
            "f1": 97.62100514049861
        },
        "PR": {
            "p@1": 0.9814796975097538,
            "p@2": 0.9975856172631377,
            "p@3": 0.9996568084388998
        },
        "PRQA": {
            "exact_match": 92.24688117142719,
            "f1": 96.32121445814634
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2997899 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2997899 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
