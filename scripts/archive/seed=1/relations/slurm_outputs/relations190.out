2024-05-09 21:06:06 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 190 ---------------
2024-05-09 21:06:06 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-09 21:06:06 INFO     Contexts were splited into 495 paragraphs, which are 1.6610738255033557 paragraphs on average per one report. There are 1 unique topics with frequency threshold (greater or equal) 190. The overall paragraph average length (characters) is 3409.8929292929292
2024-05-09 21:06:07 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-09 21:06:07 INFO     Contexts were splited into 69 paragraphs, which are 1.6428571428571428 paragraphs on average per one report. There are 1 unique topics with frequency threshold (greater or equal) 190. The overall paragraph average length (characters) is 2661.855072463768
2024-05-09 21:06:07 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-09 21:06:07 INFO     Contexts were splited into 141 paragraphs, which are 1.6395348837209303 paragraphs on average per one report. There are 1 unique topics with frequency threshold (greater or equal) 190. The overall paragraph average length (characters) is 3052.049645390071
2024-05-09 21:06:45 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 21:16:40 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 23:49:07 INFO     the model is trained
2024-05-10 00:10:33 INFO     evaluation data are prepared
2024-05-10 04:25:14 INFO     QA scores: {'exact_match': 90.85665430374259, 'f1': 96.4688532724424}
2024-05-10 04:25:14 INFO     PR scores: {'p@1': 0.9999759163816772, 'p@2': 1.0, 'p@3': 1.0}
2024-05-10 04:25:24 INFO     PRQA scores: {'exact_match': 90.8542459419103, 'f1': 96.46644491061012}
{'loss': 0.5875, 'grad_norm': 5.224830627441406, 'learning_rate': 2.925794004155536e-05, 'epoch': 0.024735331948154745}
{'loss': 0.2086, 'grad_norm': 10.014392852783203, 'learning_rate': 2.8515880083110715e-05, 'epoch': 0.04947066389630949}
{'loss': 0.1761, 'grad_norm': 4.537394046783447, 'learning_rate': 2.7773820124666075e-05, 'epoch': 0.07420599584446423}
{'loss': 0.1611, 'grad_norm': 8.396380424499512, 'learning_rate': 2.7031760166221432e-05, 'epoch': 0.09894132779261898}
{'loss': 0.1385, 'grad_norm': 4.119938373565674, 'learning_rate': 2.628970020777679e-05, 'epoch': 0.12367665974077371}
{'loss': 0.1364, 'grad_norm': 1.4917570352554321, 'learning_rate': 2.5547640249332146e-05, 'epoch': 0.14841199168892846}
{'loss': 0.1288, 'grad_norm': 3.4074513912200928, 'learning_rate': 2.4805580290887506e-05, 'epoch': 0.1731473236370832}
{'loss': 0.1158, 'grad_norm': 3.0621070861816406, 'learning_rate': 2.406352033244286e-05, 'epoch': 0.19788265558523796}
{'loss': 0.1049, 'grad_norm': 1.6511884927749634, 'learning_rate': 2.332146037399822e-05, 'epoch': 0.2226179875333927}
{'loss': 0.1055, 'grad_norm': 2.5711517333984375, 'learning_rate': 2.2579400415553577e-05, 'epoch': 0.24735331948154743}
{'loss': 0.1053, 'grad_norm': 13.180203437805176, 'learning_rate': 2.1837340457108934e-05, 'epoch': 0.2720886514297022}
{'loss': 0.1061, 'grad_norm': 0.009803825058043003, 'learning_rate': 2.109528049866429e-05, 'epoch': 0.2968239833778569}
{'loss': 0.0971, 'grad_norm': 1.1088787317276, 'learning_rate': 2.035322054021965e-05, 'epoch': 0.3215593153260117}
{'loss': 0.0877, 'grad_norm': 0.2770198881626129, 'learning_rate': 1.961116058177501e-05, 'epoch': 0.3462946472741664}
{'loss': 0.086, 'grad_norm': 3.9013328552246094, 'learning_rate': 1.8869100623330365e-05, 'epoch': 0.37102997922232117}
{'loss': 0.0815, 'grad_norm': 0.8261740803718567, 'learning_rate': 1.8127040664885726e-05, 'epoch': 0.3957653111704759}
{'loss': 0.0847, 'grad_norm': 0.14077144861221313, 'learning_rate': 1.738498070644108e-05, 'epoch': 0.42050064311863067}
{'loss': 0.0877, 'grad_norm': 0.3998059034347534, 'learning_rate': 1.664292074799644e-05, 'epoch': 0.4452359750667854}
{'loss': 0.0785, 'grad_norm': 0.5844354033470154, 'learning_rate': 1.5900860789551797e-05, 'epoch': 0.46997130701494017}
{'loss': 0.0611, 'grad_norm': 0.08114229142665863, 'learning_rate': 1.5158800831107155e-05, 'epoch': 0.49470663896309486}
{'loss': 0.0727, 'grad_norm': 26.942031860351562, 'learning_rate': 1.4416740872662512e-05, 'epoch': 0.5194419709112497}
{'loss': 0.0707, 'grad_norm': 1.4542076587677002, 'learning_rate': 1.367468091421787e-05, 'epoch': 0.5441773028594044}
{'loss': 0.076, 'grad_norm': 38.81270217895508, 'learning_rate': 1.2932620955773228e-05, 'epoch': 0.5689126348075592}
{'loss': 0.0771, 'grad_norm': 11.414372444152832, 'learning_rate': 1.2190560997328585e-05, 'epoch': 0.5936479667557139}
{'loss': 0.0678, 'grad_norm': 0.03452490642666817, 'learning_rate': 1.1448501038883942e-05, 'epoch': 0.6183832987038687}
{'loss': 0.0629, 'grad_norm': 0.2608286440372467, 'learning_rate': 1.07064410804393e-05, 'epoch': 0.6431186306520233}
{'loss': 0.0675, 'grad_norm': 5.52078914642334, 'learning_rate': 9.964381121994658e-06, 'epoch': 0.667853962600178}
{'loss': 0.0545, 'grad_norm': 4.441704273223877, 'learning_rate': 9.222321163550014e-06, 'epoch': 0.6925892945483328}
{'loss': 0.0558, 'grad_norm': 0.04144741967320442, 'learning_rate': 8.480261205105373e-06, 'epoch': 0.7173246264964875}
{'loss': 0.0557, 'grad_norm': 0.0473022423684597, 'learning_rate': 7.73820124666073e-06, 'epoch': 0.7420599584446423}
{'loss': 0.045, 'grad_norm': 0.1188945546746254, 'learning_rate': 6.996141288216088e-06, 'epoch': 0.766795290392797}
{'loss': 0.0566, 'grad_norm': 11.234113693237305, 'learning_rate': 6.254081329771446e-06, 'epoch': 0.7915306223409518}
{'loss': 0.0601, 'grad_norm': 5.4565629959106445, 'learning_rate': 5.5120213713268036e-06, 'epoch': 0.8162659542891065}
{'loss': 0.0472, 'grad_norm': 0.0012870228383690119, 'learning_rate': 4.7699614128821605e-06, 'epoch': 0.8410012862372613}
{'loss': 0.0493, 'grad_norm': 0.003775139106437564, 'learning_rate': 4.027901454437518e-06, 'epoch': 0.865736618185416}
{'loss': 0.051, 'grad_norm': 0.07759524136781693, 'learning_rate': 3.285841495992876e-06, 'epoch': 0.8904719501335708}
{'loss': 0.0499, 'grad_norm': 0.038944900035858154, 'learning_rate': 2.543781537548234e-06, 'epoch': 0.9152072820817255}
{'loss': 0.0539, 'grad_norm': 0.4378674328327179, 'learning_rate': 1.8017215791035916e-06, 'epoch': 0.9399426140298803}
{'loss': 0.0436, 'grad_norm': 25.453277587890625, 'learning_rate': 1.0596616206589494e-06, 'epoch': 0.964677945978035}
{'loss': 0.0428, 'grad_norm': 0.10238710045814514, 'learning_rate': 3.1760166221430694e-07, 'epoch': 0.9894132779261897}
{'eval_loss': 0.23064495623111725, 'eval_runtime': 3748.2608, 'eval_samples_per_second': 181.165, 'eval_steps_per_second': 0.708, 'epoch': 1.0}
{'train_runtime': 9145.6056, 'train_samples_per_second': 35.362, 'train_steps_per_second': 2.21, 'train_loss': 0.0968582864400717, 'epoch': 1.0}
Post-processing 290387 example predictions split into 1526112 features.
{
    "190": {
        "QA": {
            "exact_match": 90.85665430374259,
            "f1": 96.4688532724424
        },
        "PR": {
            "p@1": 0.9999759163816772,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 90.8542459419103,
            "f1": 96.46644491061012
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 3174124 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 3174124 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
