2024-05-09 15:16:06 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 100 ---------------
2024-05-09 15:16:06 INFO     Contexts were splited into 787 paragraphs, which are 4.300546448087432 paragraphs on average per one report. The overall paragraph average length (characters) is 1528.9390088945363
2024-05-09 15:16:07 INFO     Contexts were splited into 119 paragraphs, which are 4.576923076923077 paragraphs on average per one report. The overall paragraph average length (characters) is 1521.9663865546217
2024-05-09 15:16:07 INFO     Contexts were splited into 218 paragraphs, which are 4.113207547169812 paragraphs on average per one report. The overall paragraph average length (characters) is 1554.9633027522937
2024-05-09 15:16:14 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 15:18:17 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 16:00:03 INFO     the model is trained
2024-05-09 16:05:21 INFO     evaluation data are prepared
2024-05-09 17:15:04 INFO     QA scores: {'exact_match': 31.124092607705855, 'f1': 73.04855461921093}
2024-05-09 17:15:04 INFO     PR scores: {'p@1': 0.9125681886516902, 'p@2': 0.9865340835874747, 'p@3': 0.9975301748206692}
2024-05-09 17:15:07 INFO     PRQA scores: {'exact_match': 30.071732313904043, 'f1': 69.68391182723776}
{'loss': 1.4245, 'grad_norm': 7.347877502441406, 'learning_rate': 2.805649131899456e-05, 'epoch': 0.0647836227001814}
{'loss': 0.9096, 'grad_norm': 6.400815963745117, 'learning_rate': 2.6112982637989115e-05, 'epoch': 0.1295672454003628}
{'loss': 0.787, 'grad_norm': 9.712450981140137, 'learning_rate': 2.4169473956983678e-05, 'epoch': 0.1943508681005442}
{'loss': 0.7102, 'grad_norm': 6.995563507080078, 'learning_rate': 2.2225965275978233e-05, 'epoch': 0.2591344908007256}
{'loss': 0.6145, 'grad_norm': 4.147596836090088, 'learning_rate': 2.0282456594972792e-05, 'epoch': 0.323918113500907}
{'loss': 0.5438, 'grad_norm': 10.706153869628906, 'learning_rate': 1.8338947913967348e-05, 'epoch': 0.3887017362010884}
{'loss': 0.4697, 'grad_norm': 13.130825996398926, 'learning_rate': 1.639543923296191e-05, 'epoch': 0.4534853589012698}
{'loss': 0.4552, 'grad_norm': 14.479825973510742, 'learning_rate': 1.4451930551956467e-05, 'epoch': 0.5182689816014512}
{'loss': 0.4065, 'grad_norm': 12.246349334716797, 'learning_rate': 1.2508421870951024e-05, 'epoch': 0.5830526043016325}
{'loss': 0.3586, 'grad_norm': 4.77273416519165, 'learning_rate': 1.0564913189945583e-05, 'epoch': 0.647836227001814}
{'loss': 0.321, 'grad_norm': 11.11634635925293, 'learning_rate': 8.62140450894014e-06, 'epoch': 0.7126198497019953}
{'loss': 0.3097, 'grad_norm': 10.344264030456543, 'learning_rate': 6.677895827934699e-06, 'epoch': 0.7774034724021768}
{'loss': 0.2751, 'grad_norm': 20.52707290649414, 'learning_rate': 4.734387146929257e-06, 'epoch': 0.8421870951023581}
{'loss': 0.2652, 'grad_norm': 11.302146911621094, 'learning_rate': 2.7908784659238147e-06, 'epoch': 0.9069707178025396}
{'loss': 0.2486, 'grad_norm': 13.548382759094238, 'learning_rate': 8.473697849183727e-07, 'epoch': 0.9717543405027209}
{'eval_loss': 1.4027481079101562, 'eval_runtime': 430.9262, 'eval_samples_per_second': 179.859, 'eval_steps_per_second': 0.703, 'epoch': 1.0}
{'train_runtime': 2506.0231, 'train_samples_per_second': 49.276, 'train_steps_per_second': 3.08, 'train_loss': 0.5317871833162686, 'epoch': 1.0}
Post-processing 213103 example predictions split into 407999 features.
{
    "100": {
        "QA": {
            "exact_match": 31.124092607705855,
            "f1": 73.04855461921093
        },
        "PR": {
            "p@1": 0.9125681886516902,
            "p@2": 0.9865340835874747,
            "p@3": 0.9975301748206692
        },
        "PRQA": {
            "exact_match": 30.071732313904043,
            "f1": 69.68391182723776
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 487632 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 487632 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
