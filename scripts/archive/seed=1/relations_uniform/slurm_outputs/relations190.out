2024-05-09 23:56:57 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 190 ---------------
2024-05-09 23:56:58 INFO     Contexts were splited into 525 paragraphs, which are 1.761744966442953 paragraphs on average per one report. The overall paragraph average length (characters) is 3151.7542857142857
2024-05-09 23:56:58 INFO     Contexts were splited into 63 paragraphs, which are 1.5 paragraphs on average per one report. The overall paragraph average length (characters) is 2857.095238095238
2024-05-09 23:56:59 INFO     Contexts were splited into 140 paragraphs, which are 1.627906976744186 paragraphs on average per one report. The overall paragraph average length (characters) is 3012.692857142857
2024-05-09 23:57:29 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-10 00:05:05 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-10 01:57:13 INFO     the model is trained
2024-05-10 02:17:47 INFO     evaluation data are prepared
2024-05-10 06:17:02 INFO     QA scores: {'exact_match': 91.80374259428737, 'f1': 97.26251410371059}
2024-05-10 06:17:02 INFO     PR scores: {'p@1': 0.9888432638119551, 'p@2': 0.9983382303357257, 'p@3': 0.9997952892442561}
2024-05-10 06:17:12 INFO     PRQA scores: {'exact_match': 91.02885217475074, 'f1': 96.58681665863466}
{'loss': 0.6318, 'grad_norm': 1.3360894918441772, 'learning_rate': 2.8956376539344608e-05, 'epoch': 0.03478744868851318}
{'loss': 0.2364, 'grad_norm': 8.428328514099121, 'learning_rate': 2.7912753078689208e-05, 'epoch': 0.06957489737702637}
{'loss': 0.2063, 'grad_norm': 0.4867042899131775, 'learning_rate': 2.6869129618033815e-05, 'epoch': 0.10436234606553955}
{'loss': 0.1541, 'grad_norm': 7.68894624710083, 'learning_rate': 2.582550615737842e-05, 'epoch': 0.13914979475405273}
{'loss': 0.1559, 'grad_norm': 9.874723434448242, 'learning_rate': 2.4781882696723025e-05, 'epoch': 0.17393724344256592}
{'loss': 0.1392, 'grad_norm': 9.104724884033203, 'learning_rate': 2.3738259236067626e-05, 'epoch': 0.2087246921310791}
{'loss': 0.1246, 'grad_norm': 15.390685081481934, 'learning_rate': 2.2694635775412233e-05, 'epoch': 0.2435121408195923}
{'loss': 0.1255, 'grad_norm': 0.8664836883544922, 'learning_rate': 2.1651012314756836e-05, 'epoch': 0.27829958950810546}
{'loss': 0.112, 'grad_norm': 0.6697472929954529, 'learning_rate': 2.060738885410144e-05, 'epoch': 0.31308703819661865}
{'loss': 0.1027, 'grad_norm': 0.1937377154827118, 'learning_rate': 1.9563765393446043e-05, 'epoch': 0.34787448688513184}
{'loss': 0.1046, 'grad_norm': 8.726386070251465, 'learning_rate': 1.852014193279065e-05, 'epoch': 0.38266193557364503}
{'loss': 0.0973, 'grad_norm': 0.5991214513778687, 'learning_rate': 1.7476518472135257e-05, 'epoch': 0.4174493842621582}
{'loss': 0.0966, 'grad_norm': 0.14595818519592285, 'learning_rate': 1.6432895011479857e-05, 'epoch': 0.4522368329506714}
{'loss': 0.089, 'grad_norm': 0.6568373441696167, 'learning_rate': 1.5389271550824464e-05, 'epoch': 0.4870242816391846}
{'loss': 0.0835, 'grad_norm': 9.206781387329102, 'learning_rate': 1.4345648090169066e-05, 'epoch': 0.5218117303276978}
{'loss': 0.0757, 'grad_norm': 5.466921329498291, 'learning_rate': 1.3302024629513671e-05, 'epoch': 0.5565991790162109}
{'loss': 0.08, 'grad_norm': 0.04110705479979515, 'learning_rate': 1.2258401168858277e-05, 'epoch': 0.5913866277047242}
{'loss': 0.0723, 'grad_norm': 2.551379680633545, 'learning_rate': 1.1214777708202882e-05, 'epoch': 0.6261740763932373}
{'loss': 0.0671, 'grad_norm': 1.349160075187683, 'learning_rate': 1.0171154247547486e-05, 'epoch': 0.6609615250817505}
{'loss': 0.0693, 'grad_norm': 0.05354677885770798, 'learning_rate': 9.127530786892089e-06, 'epoch': 0.6957489737702637}
{'loss': 0.064, 'grad_norm': 0.10563232004642487, 'learning_rate': 8.083907326236694e-06, 'epoch': 0.7305364224587769}
{'loss': 0.0543, 'grad_norm': 0.12260409444570541, 'learning_rate': 7.040283865581299e-06, 'epoch': 0.7653238711472901}
{'loss': 0.0537, 'grad_norm': 0.24885261058807373, 'learning_rate': 5.996660404925902e-06, 'epoch': 0.8001113198358032}
{'loss': 0.061, 'grad_norm': 18.695947647094727, 'learning_rate': 4.953036944270507e-06, 'epoch': 0.8348987685243164}
{'loss': 0.0505, 'grad_norm': 0.02072221226990223, 'learning_rate': 3.909413483615112e-06, 'epoch': 0.8696862172128296}
{'loss': 0.0491, 'grad_norm': 41.9491081237793, 'learning_rate': 2.865790022959716e-06, 'epoch': 0.9044736659013428}
{'loss': 0.0415, 'grad_norm': 0.023449663072824478, 'learning_rate': 1.8221665623043207e-06, 'epoch': 0.939261114589856}
{'loss': 0.043, 'grad_norm': 14.770185470581055, 'learning_rate': 7.785431016489251e-07, 'epoch': 0.9740485632783692}
{'eval_loss': 0.2507156729698181, 'eval_runtime': 2846.0561, 'eval_samples_per_second': 179.383, 'eval_steps_per_second': 0.701, 'epoch': 1.0}
{'train_runtime': 6727.1848, 'train_samples_per_second': 34.184, 'train_steps_per_second': 2.137, 'train_loss': 0.11384747237856616, 'epoch': 1.0}
Post-processing 373252 example predictions split into 1405156 features.
{
    "190": {
        "QA": {
            "exact_match": 91.80374259428737,
            "f1": 97.26251410371059
        },
        "PR": {
            "p@1": 0.9888432638119551,
            "p@2": 0.9983382303357257,
            "p@3": 0.9997952892442561
        },
        "PRQA": {
            "exact_match": 91.02885217475074,
            "f1": 96.58681665863466
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 704323 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 704323 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
