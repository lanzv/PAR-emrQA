2024-05-10 05:16:16 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 198 ---------------
2024-05-10 05:16:16 INFO     Contexts were splited into 360 paragraphs, which are 1.2080536912751678 paragraphs on average per one report. The overall paragraph average length (characters) is 4596.308333333333
2024-05-10 05:16:16 INFO     Contexts were splited into 47 paragraphs, which are 1.119047619047619 paragraphs on average per one report. The overall paragraph average length (characters) is 3829.723404255319
2024-05-10 05:16:17 INFO     Contexts were splited into 102 paragraphs, which are 1.186046511627907 paragraphs on average per one report. The overall paragraph average length (characters) is 4135.068627450981
2024-05-10 05:16:50 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-10 05:26:37 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-10 07:44:12 INFO     the model is trained
2024-05-10 08:05:06 INFO     evaluation data are prepared
2024-05-10 12:06:06 INFO     QA scores: {'exact_match': 91.57976494388517, 'f1': 97.1181985065678}
2024-05-10 12:06:06 INFO     PR scores: {'p@1': 0.9926063291748952, 'p@2': 0.9993858677327682, 'p@3': 1.0}
2024-05-10 12:06:16 INFO     PRQA scores: {'exact_match': 91.02102499879582, 'f1': 96.6442095945892}
{'loss': 0.6061, 'grad_norm': 12.444051742553711, 'learning_rate': 2.9159145692023095e-05, 'epoch': 0.028028476932563485}
{'loss': 0.2242, 'grad_norm': 6.711558818817139, 'learning_rate': 2.831829138404619e-05, 'epoch': 0.05605695386512697}
{'loss': 0.1858, 'grad_norm': 10.186929702758789, 'learning_rate': 2.7477437076069285e-05, 'epoch': 0.08408543079769046}
{'loss': 0.1607, 'grad_norm': 6.149132251739502, 'learning_rate': 2.6636582768092383e-05, 'epoch': 0.11211390773025394}
{'loss': 0.1522, 'grad_norm': 11.230113983154297, 'learning_rate': 2.5795728460115477e-05, 'epoch': 0.14014238466281742}
{'loss': 0.142, 'grad_norm': 1.0520075559616089, 'learning_rate': 2.4954874152138575e-05, 'epoch': 0.16817086159538092}
{'loss': 0.13, 'grad_norm': 10.999683380126953, 'learning_rate': 2.411401984416167e-05, 'epoch': 0.19619933852794438}
{'loss': 0.1188, 'grad_norm': 0.2349095344543457, 'learning_rate': 2.3273165536184765e-05, 'epoch': 0.22422781546050788}
{'loss': 0.1158, 'grad_norm': 0.09860264509916306, 'learning_rate': 2.243231122820786e-05, 'epoch': 0.25225629239307135}
{'loss': 0.1215, 'grad_norm': 7.1682610511779785, 'learning_rate': 2.1591456920230954e-05, 'epoch': 0.28028476932563484}
{'loss': 0.1106, 'grad_norm': 16.9136962890625, 'learning_rate': 2.0750602612254052e-05, 'epoch': 0.30831324625819834}
{'loss': 0.1009, 'grad_norm': 0.13279704749584198, 'learning_rate': 1.9909748304277147e-05, 'epoch': 0.33634172319076183}
{'loss': 0.1036, 'grad_norm': 1.7327194213867188, 'learning_rate': 1.906889399630024e-05, 'epoch': 0.36437020012332527}
{'loss': 0.089, 'grad_norm': 1.2417546510696411, 'learning_rate': 1.8228039688323336e-05, 'epoch': 0.39239867705588877}
{'loss': 0.0789, 'grad_norm': 0.05405709519982338, 'learning_rate': 1.738718538034643e-05, 'epoch': 0.42042715398845226}
{'loss': 0.0853, 'grad_norm': 0.6596724987030029, 'learning_rate': 1.654633107236953e-05, 'epoch': 0.44845563092101576}
{'loss': 0.0835, 'grad_norm': 0.40725257992744446, 'learning_rate': 1.5705476764392623e-05, 'epoch': 0.47648410785357925}
{'loss': 0.0823, 'grad_norm': 29.783512115478516, 'learning_rate': 1.4864622456415718e-05, 'epoch': 0.5045125847861427}
{'loss': 0.0826, 'grad_norm': 0.08235228806734085, 'learning_rate': 1.4023768148438814e-05, 'epoch': 0.5325410617187062}
{'loss': 0.0709, 'grad_norm': 0.8978137969970703, 'learning_rate': 1.318291384046191e-05, 'epoch': 0.5605695386512697}
{'loss': 0.0729, 'grad_norm': 1.5724736452102661, 'learning_rate': 1.2342059532485005e-05, 'epoch': 0.5885980155838332}
{'loss': 0.0712, 'grad_norm': 16.5870304107666, 'learning_rate': 1.15012052245081e-05, 'epoch': 0.6166264925163967}
{'loss': 0.0689, 'grad_norm': 0.04850015044212341, 'learning_rate': 1.0660350916531195e-05, 'epoch': 0.6446549694489602}
{'loss': 0.0652, 'grad_norm': 0.10455195605754852, 'learning_rate': 9.819496608554293e-06, 'epoch': 0.6726834463815237}
{'loss': 0.0657, 'grad_norm': 0.012025078758597374, 'learning_rate': 8.978642300577387e-06, 'epoch': 0.7007119233140872}
{'loss': 0.056, 'grad_norm': 2.8196449279785156, 'learning_rate': 8.137787992600482e-06, 'epoch': 0.7287404002466505}
{'loss': 0.0604, 'grad_norm': 0.08560369908809662, 'learning_rate': 7.296933684623577e-06, 'epoch': 0.756768877179214}
{'loss': 0.0523, 'grad_norm': 0.002117039170116186, 'learning_rate': 6.456079376646674e-06, 'epoch': 0.7847973541117775}
{'loss': 0.054, 'grad_norm': 0.16186819970607758, 'learning_rate': 5.615225068669768e-06, 'epoch': 0.812825831044341}
{'loss': 0.0439, 'grad_norm': 0.012418611906468868, 'learning_rate': 4.774370760692865e-06, 'epoch': 0.8408543079769045}
{'loss': 0.0512, 'grad_norm': 7.8295512199401855, 'learning_rate': 3.933516452715959e-06, 'epoch': 0.868882784909468}
{'loss': 0.058, 'grad_norm': 0.06414836645126343, 'learning_rate': 3.092662144739055e-06, 'epoch': 0.8969112618420315}
{'loss': 0.0464, 'grad_norm': 0.01288312766700983, 'learning_rate': 2.2518078367621507e-06, 'epoch': 0.924939738774595}
{'loss': 0.0379, 'grad_norm': 0.001130023505538702, 'learning_rate': 1.4109535287852458e-06, 'epoch': 0.9529682157071585}
{'loss': 0.0606, 'grad_norm': 0.059106141328811646, 'learning_rate': 5.700992208083413e-07, 'epoch': 0.980996692639722}
{'eval_loss': 0.22529593110084534, 'eval_runtime': 3469.1654, 'eval_samples_per_second': 179.762, 'eval_steps_per_second': 0.702, 'epoch': 1.0}
{'train_runtime': 8253.742, 'train_samples_per_second': 34.58, 'train_steps_per_second': 2.161, 'train_loss': 0.10507547692992213, 'epoch': 1.0}
Post-processing 238640 example predictions split into 1412461 features.
{
    "198": {
        "QA": {
            "exact_match": 91.57976494388517,
            "f1": 97.1181985065678
        },
        "PR": {
            "p@1": 0.9926063291748952,
            "p@2": 0.9993858677327682,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 91.02102499879582,
            "f1": 96.6442095945892
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 706298 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 706298 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
