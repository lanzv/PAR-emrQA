2024-05-10 04:48:00 INFO     ------------- Experiment: model BERTbase, frequency threshold 157 ---------------
2024-05-10 04:48:00 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-10 04:48:01 INFO     Contexts were splited into 555 paragraphs, which are 1.8624161073825503 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 3041.2558558558558
2024-05-10 04:48:01 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-10 04:48:01 INFO     Contexts were splited into 83 paragraphs, which are 1.9761904761904763 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2212.867469879518
2024-05-10 04:48:02 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-10 04:48:02 INFO     Contexts were splited into 163 paragraphs, which are 1.8953488372093024 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2640.116564417178
2024-05-10 04:48:40 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/bert-base-cased and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-10 04:58:31 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-10 07:42:16 INFO     the model is trained
2024-05-10 08:04:32 INFO     evaluation data are prepared
2024-05-10 12:43:58 INFO     QA scores: {'exact_match': 88.7475314291219, 'f1': 94.5619821105561}
2024-05-10 12:43:59 INFO     PR scores: {'p@1': 0.9957191368431193, 'p@2': 1.0, 'p@3': 1.0}
2024-05-10 12:44:09 INFO     PRQA scores: {'exact_match': 88.54884157795867, 'f1': 94.40312218758264}
{'loss': 0.5771, 'grad_norm': 15.362847328186035, 'learning_rate': 2.9300242582571374e-05, 'epoch': 0.023325247247620823}
{'loss': 0.2806, 'grad_norm': 15.9021635055542, 'learning_rate': 2.860048516514275e-05, 'epoch': 0.04665049449524165}
{'loss': 0.242, 'grad_norm': 3.3895106315612793, 'learning_rate': 2.7900727747714125e-05, 'epoch': 0.06997574174286247}
{'loss': 0.2255, 'grad_norm': 8.123088836669922, 'learning_rate': 2.72009703302855e-05, 'epoch': 0.0933009889904833}
{'loss': 0.2153, 'grad_norm': 4.195674896240234, 'learning_rate': 2.650121291285688e-05, 'epoch': 0.11662623623810413}
{'loss': 0.1862, 'grad_norm': 0.8737277984619141, 'learning_rate': 2.5801455495428253e-05, 'epoch': 0.13995148348572495}
{'loss': 0.1712, 'grad_norm': 3.6539196968078613, 'learning_rate': 2.5101698077999627e-05, 'epoch': 0.16327673073334578}
{'loss': 0.1771, 'grad_norm': 0.05324634537100792, 'learning_rate': 2.4401940660571004e-05, 'epoch': 0.1866019779809666}
{'loss': 0.157, 'grad_norm': 0.08597329258918762, 'learning_rate': 2.3702183243142378e-05, 'epoch': 0.20992722522858742}
{'loss': 0.1628, 'grad_norm': 12.0646333694458, 'learning_rate': 2.300242582571375e-05, 'epoch': 0.23325247247620826}
{'loss': 0.1658, 'grad_norm': 9.768305778503418, 'learning_rate': 2.230266840828513e-05, 'epoch': 0.2565777197238291}
{'loss': 0.151, 'grad_norm': 13.212875366210938, 'learning_rate': 2.1602910990856502e-05, 'epoch': 0.2799029669714499}
{'loss': 0.1436, 'grad_norm': 6.386470317840576, 'learning_rate': 2.0903153573427876e-05, 'epoch': 0.3032282142190707}
{'loss': 0.1545, 'grad_norm': 0.4520793855190277, 'learning_rate': 2.0203396155999257e-05, 'epoch': 0.32655346146669156}
{'loss': 0.1271, 'grad_norm': 0.7674934267997742, 'learning_rate': 1.950363873857063e-05, 'epoch': 0.34987870871431237}
{'loss': 0.1267, 'grad_norm': 0.010037827305495739, 'learning_rate': 1.8803881321142004e-05, 'epoch': 0.3732039559619332}
{'loss': 0.1245, 'grad_norm': 19.216005325317383, 'learning_rate': 1.810412390371338e-05, 'epoch': 0.39652920320955404}
{'loss': 0.1191, 'grad_norm': 0.08997808396816254, 'learning_rate': 1.7404366486284755e-05, 'epoch': 0.41985445045717484}
{'loss': 0.1068, 'grad_norm': 0.6196044683456421, 'learning_rate': 1.670460906885613e-05, 'epoch': 0.44317969770479565}
{'loss': 0.1029, 'grad_norm': 13.502138137817383, 'learning_rate': 1.6004851651427506e-05, 'epoch': 0.4665049449524165}
{'loss': 0.1106, 'grad_norm': 0.12550312280654907, 'learning_rate': 1.530509423399888e-05, 'epoch': 0.4898301922000373}
{'loss': 0.1043, 'grad_norm': 9.545865058898926, 'learning_rate': 1.4605336816570257e-05, 'epoch': 0.5131554394476582}
{'loss': 0.1036, 'grad_norm': 6.44402551651001, 'learning_rate': 1.390557939914163e-05, 'epoch': 0.5364806866952789}
{'loss': 0.0934, 'grad_norm': 0.29437950253486633, 'learning_rate': 1.3205821981713006e-05, 'epoch': 0.5598059339428998}
{'loss': 0.0939, 'grad_norm': 0.415474534034729, 'learning_rate': 1.2506064564284383e-05, 'epoch': 0.5831311811905207}
{'loss': 0.0827, 'grad_norm': 15.09119987487793, 'learning_rate': 1.1806307146855757e-05, 'epoch': 0.6064564284381414}
{'loss': 0.0967, 'grad_norm': 2.9732515811920166, 'learning_rate': 1.1106549729427132e-05, 'epoch': 0.6297816756857623}
{'loss': 0.0811, 'grad_norm': 8.085783004760742, 'learning_rate': 1.0406792311998508e-05, 'epoch': 0.6531069229333831}
{'loss': 0.0787, 'grad_norm': 2.0176291465759277, 'learning_rate': 9.707034894569883e-06, 'epoch': 0.6764321701810039}
{'loss': 0.0884, 'grad_norm': 0.10020739585161209, 'learning_rate': 9.007277477141258e-06, 'epoch': 0.6997574174286247}
{'loss': 0.0751, 'grad_norm': 13.40554428100586, 'learning_rate': 8.307520059712634e-06, 'epoch': 0.7230826646762456}
{'loss': 0.0745, 'grad_norm': 0.2261010706424713, 'learning_rate': 7.607762642284008e-06, 'epoch': 0.7464079119238664}
{'loss': 0.0709, 'grad_norm': 0.026673413813114166, 'learning_rate': 6.908005224855384e-06, 'epoch': 0.7697331591714872}
{'loss': 0.0849, 'grad_norm': 0.7870851755142212, 'learning_rate': 6.2082478074267585e-06, 'epoch': 0.7930584064191081}
{'loss': 0.0654, 'grad_norm': 34.552757263183594, 'learning_rate': 5.508490389998135e-06, 'epoch': 0.8163836536667288}
{'loss': 0.0618, 'grad_norm': 0.013724113814532757, 'learning_rate': 4.808732972569509e-06, 'epoch': 0.8397089009143497}
{'loss': 0.0655, 'grad_norm': 1.633109450340271, 'learning_rate': 4.108975555140885e-06, 'epoch': 0.8630341481619705}
{'loss': 0.0673, 'grad_norm': 0.00886991061270237, 'learning_rate': 3.4092181377122598e-06, 'epoch': 0.8863593954095913}
{'loss': 0.0665, 'grad_norm': 7.8530192375183105, 'learning_rate': 2.709460720283635e-06, 'epoch': 0.9096846426572122}
{'loss': 0.0615, 'grad_norm': 0.05056538060307503, 'learning_rate': 2.0097033028550102e-06, 'epoch': 0.933009889904833}
{'loss': 0.0636, 'grad_norm': 0.11374245584011078, 'learning_rate': 1.3099458854263856e-06, 'epoch': 0.9563351371524538}
{'loss': 0.0574, 'grad_norm': 0.10603850334882736, 'learning_rate': 6.101884679977608e-07, 'epoch': 0.9796603844000746}
{'eval_loss': 0.2370525747537613, 'eval_runtime': 4041.7332, 'eval_samples_per_second': 179.362, 'eval_steps_per_second': 0.701, 'epoch': 1.0}
{'train_runtime': 9823.5023, 'train_samples_per_second': 34.914, 'train_steps_per_second': 2.182, 'train_loss': 0.1286106249315789, 'epoch': 1.0}
Post-processing 331289 example predictions split into 1666112 features.
{
    "157": {
        "QA": {
            "exact_match": 88.7475314291219,
            "f1": 94.5619821105561
        },
        "PR": {
            "p@1": 0.9957191368431193,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 88.54884157795867,
            "f1": 94.40312218758264
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2664274 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2664274 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
