2024-05-09 19:00:03 INFO     ------------- Experiment: model BERTbase, frequency threshold 100 ---------------
2024-05-09 19:00:03 INFO     Contexts were splited into 787 paragraphs, which are 4.300546448087432 paragraphs on average per one report. The overall paragraph average length (characters) is 1528.9390088945363
2024-05-09 19:00:03 INFO     Contexts were splited into 119 paragraphs, which are 4.576923076923077 paragraphs on average per one report. The overall paragraph average length (characters) is 1521.9663865546217
2024-05-09 19:00:04 INFO     Contexts were splited into 218 paragraphs, which are 4.113207547169812 paragraphs on average per one report. The overall paragraph average length (characters) is 1554.9633027522937
2024-05-09 19:00:11 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/bert-base-cased and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 19:02:29 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 19:49:03 INFO     the model is trained
2024-05-09 19:54:39 INFO     evaluation data are prepared
2024-05-09 21:10:36 INFO     QA scores: {'exact_match': 29.517632404106354, 'f1': 71.49597688993292}
2024-05-09 21:10:36 INFO     PR scores: {'p@1': 0.8916713199604828, 'p@2': 0.978523259310167, 'p@3': 0.994093896310296}
2024-05-09 21:10:39 INFO     PRQA scores: {'exact_match': 28.267686095958076, 'f1': 67.44530162129762}
{'loss': 1.6202, 'grad_norm': 11.527095794677734, 'learning_rate': 2.8258850841555427e-05, 'epoch': 0.05803830528148578}
{'loss': 1.0619, 'grad_norm': 6.777756690979004, 'learning_rate': 2.6517701683110853e-05, 'epoch': 0.11607661056297155}
{'loss': 0.8753, 'grad_norm': 10.512062072753906, 'learning_rate': 2.477655252466628e-05, 'epoch': 0.17411491584445735}
{'loss': 0.8007, 'grad_norm': 13.99238395690918, 'learning_rate': 2.3035403366221706e-05, 'epoch': 0.2321532211259431}
{'loss': 0.7273, 'grad_norm': 11.062668800354004, 'learning_rate': 2.1294254207777132e-05, 'epoch': 0.2901915264074289}
{'loss': 0.6318, 'grad_norm': 7.728621006011963, 'learning_rate': 1.9553105049332562e-05, 'epoch': 0.3482298316889147}
{'loss': 0.5714, 'grad_norm': 13.283184051513672, 'learning_rate': 1.781195589088799e-05, 'epoch': 0.4062681369704005}
{'loss': 0.5148, 'grad_norm': 10.222244262695312, 'learning_rate': 1.6070806732443415e-05, 'epoch': 0.4643064422518862}
{'loss': 0.4727, 'grad_norm': 13.622314453125, 'learning_rate': 1.432965757399884e-05, 'epoch': 0.522344747533372}
{'loss': 0.4198, 'grad_norm': 5.660576343536377, 'learning_rate': 1.2588508415554266e-05, 'epoch': 0.5803830528148578}
{'loss': 0.3948, 'grad_norm': 10.83282470703125, 'learning_rate': 1.0847359257109692e-05, 'epoch': 0.6384213580963436}
{'loss': 0.3628, 'grad_norm': 9.006845474243164, 'learning_rate': 9.106210098665118e-06, 'epoch': 0.6964596633778294}
{'loss': 0.3343, 'grad_norm': 14.866000175476074, 'learning_rate': 7.3650609402205456e-06, 'epoch': 0.7544979686593152}
{'loss': 0.3068, 'grad_norm': 20.40607261657715, 'learning_rate': 5.623911781775972e-06, 'epoch': 0.812536273940801}
{'loss': 0.2857, 'grad_norm': 7.774288177490234, 'learning_rate': 3.882762623331399e-06, 'epoch': 0.8705745792222868}
{'loss': 0.276, 'grad_norm': 13.208868980407715, 'learning_rate': 2.1416134648868254e-06, 'epoch': 0.9286128845037724}
{'loss': 0.2714, 'grad_norm': 8.018365859985352, 'learning_rate': 4.0046430644225187e-07, 'epoch': 0.9866511897852582}
{'eval_loss': 1.4347310066223145, 'eval_runtime': 469.0914, 'eval_samples_per_second': 178.795, 'eval_steps_per_second': 0.699, 'epoch': 1.0}
{'train_runtime': 2792.7592, 'train_samples_per_second': 49.354, 'train_steps_per_second': 3.085, 'train_loss': 0.5797107503916452, 'epoch': 1.0}
Post-processing 213103 example predictions split into 439814 features.
{
    "100": {
        "QA": {
            "exact_match": 29.517632404106354,
            "f1": 71.49597688993292
        },
        "PR": {
            "p@1": 0.8916713199604828,
            "p@2": 0.978523259310167,
            "p@3": 0.994093896310296
        },
        "PRQA": {
            "exact_match": 28.267686095958076,
            "f1": 67.44530162129762
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 490463 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 490463 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
