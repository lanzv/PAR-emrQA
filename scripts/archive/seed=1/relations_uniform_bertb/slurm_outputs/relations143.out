2024-05-10 03:09:27 INFO     ------------- Experiment: model BERTbase, frequency threshold 143 ---------------
2024-05-10 03:09:27 INFO     Contexts were splited into 1148 paragraphs, which are 3.8523489932885906 paragraphs on average per one report. The overall paragraph average length (characters) is 1441.3510452961673
2024-05-10 03:09:28 INFO     Contexts were splited into 125 paragraphs, which are 2.9761904761904763 paragraphs on average per one report. The overall paragraph average length (characters) is 1439.976
2024-05-10 03:09:29 INFO     Contexts were splited into 295 paragraphs, which are 3.4302325581395348 paragraphs on average per one report. The overall paragraph average length (characters) is 1429.7525423728814
2024-05-10 03:09:56 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/bert-base-cased and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-10 03:14:05 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-10 04:16:26 INFO     the model is trained
2024-05-10 04:37:41 INFO     evaluation data are prepared
2024-05-10 09:02:07 INFO     QA scores: {'exact_match': 90.95178459611772, 'f1': 96.16190657458914}
2024-05-10 09:02:07 INFO     PR scores: {'p@1': 0.9701724387071914, 'p@2': 0.9932204614421271, 'p@3': 0.9971581330379076}
2024-05-10 09:02:17 INFO     PRQA scores: {'exact_match': 89.00823659746641, 'f1': 94.39881555971586}
{'loss': 0.7595, 'grad_norm': 29.130586624145508, 'learning_rate': 2.8081596112034786e-05, 'epoch': 0.0639467962655071}
{'loss': 0.3752, 'grad_norm': 2.014986753463745, 'learning_rate': 2.6163192224069575e-05, 'epoch': 0.1278935925310142}
{'loss': 0.3174, 'grad_norm': 0.8954361081123352, 'learning_rate': 2.424478833610436e-05, 'epoch': 0.1918403887965213}
{'loss': 0.2672, 'grad_norm': 14.87524700164795, 'learning_rate': 2.232638444813915e-05, 'epoch': 0.2557871850620284}
{'loss': 0.2216, 'grad_norm': 9.942025184631348, 'learning_rate': 2.0407980560173934e-05, 'epoch': 0.3197339813275355}
{'loss': 0.2182, 'grad_norm': 28.219924926757812, 'learning_rate': 1.8489576672208723e-05, 'epoch': 0.3836807775930426}
{'loss': 0.1962, 'grad_norm': 6.995354175567627, 'learning_rate': 1.657117278424351e-05, 'epoch': 0.4476275738585497}
{'loss': 0.172, 'grad_norm': 20.172697067260742, 'learning_rate': 1.4652768896278298e-05, 'epoch': 0.5115743701240568}
{'loss': 0.1662, 'grad_norm': 14.585355758666992, 'learning_rate': 1.2734365008313083e-05, 'epoch': 0.5755211663895639}
{'loss': 0.136, 'grad_norm': 11.442948341369629, 'learning_rate': 1.081596112034787e-05, 'epoch': 0.639467962655071}
{'loss': 0.1393, 'grad_norm': 0.3136195242404938, 'learning_rate': 8.897557232382657e-06, 'epoch': 0.703414758920578}
{'loss': 0.1261, 'grad_norm': 13.608662605285645, 'learning_rate': 6.979153344417445e-06, 'epoch': 0.7673615551860852}
{'loss': 0.1105, 'grad_norm': 0.24681584537029266, 'learning_rate': 5.060749456452232e-06, 'epoch': 0.8313083514515923}
{'loss': 0.1227, 'grad_norm': 6.502497673034668, 'learning_rate': 3.142345568487019e-06, 'epoch': 0.8952551477170994}
{'loss': 0.1088, 'grad_norm': 0.606181800365448, 'learning_rate': 1.223941680521806e-06, 'epoch': 0.9592019439826065}
{'eval_loss': 0.40084758400917053, 'eval_runtime': 1639.5978, 'eval_samples_per_second': 180.272, 'eval_steps_per_second': 0.704, 'epoch': 1.0}
{'train_runtime': 3740.801, 'train_samples_per_second': 33.44, 'train_steps_per_second': 2.09, 'train_loss': 0.22411439863674049, 'epoch': 1.0}
Post-processing 852476 example predictions split into 1521556 features.
{
    "143": {
        "QA": {
            "exact_match": 90.95178459611772,
            "f1": 96.16190657458914
        },
        "PR": {
            "p@1": 0.9701724387071914,
            "p@2": 0.9932204614421271,
            "p@3": 0.9971581330379076
        },
        "PRQA": {
            "exact_match": 89.00823659746641,
            "f1": 94.39881555971586
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 492167 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 492167 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
