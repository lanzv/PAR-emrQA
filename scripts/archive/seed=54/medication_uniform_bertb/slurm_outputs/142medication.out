2024-05-07 17:37:19 INFO     ------------- Experiment: model BERTbase, frequency threshold 142 ---------------
2024-05-07 17:37:19 INFO     Contexts were splited into 402 paragraphs, which are 2.19672131147541 paragraphs on average per one report. The overall paragraph average length (characters) is 2993.2213930348257
2024-05-07 17:37:19 INFO     Contexts were splited into 66 paragraphs, which are 2.5384615384615383 paragraphs on average per one report. The overall paragraph average length (characters) is 2744.151515151515
2024-05-07 17:37:19 INFO     Contexts were splited into 113 paragraphs, which are 2.1320754716981134 paragraphs on average per one report. The overall paragraph average length (characters) is 2999.8407079646017
2024-05-07 17:37:27 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/bert-base-cased and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-07 17:41:04 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-07 19:00:48 INFO     the model is trained
2024-05-07 19:06:22 INFO     evaluation data are prepared
2024-05-07 20:19:39 INFO     QA scores: {'exact_match': 29.990120699282677, 'f1': 70.6929134331987}
2024-05-07 20:19:39 INFO     PR scores: {'p@1': 0.9516129032258065, 'p@2': 0.9958979425282419, 'p@3': 0.9996563721489626}
2024-05-07 20:19:42 INFO     PRQA scores: {'exact_match': 29.468235900519737, 'f1': 69.04554295962953}
{'loss': 1.1622, 'grad_norm': 6.595837116241455, 'learning_rate': 2.8993153443415226e-05, 'epoch': 0.03356155188615922}
{'loss': 0.8101, 'grad_norm': 17.686016082763672, 'learning_rate': 2.7986306886830448e-05, 'epoch': 0.06712310377231843}
{'loss': 0.7225, 'grad_norm': 10.49280071258545, 'learning_rate': 2.6979460330245673e-05, 'epoch': 0.10068465565847765}
{'loss': 0.6382, 'grad_norm': 10.799575805664062, 'learning_rate': 2.5972613773660895e-05, 'epoch': 0.13424620754463687}
{'loss': 0.5944, 'grad_norm': 8.713260650634766, 'learning_rate': 2.496576721707612e-05, 'epoch': 0.16780775943079607}
{'loss': 0.5776, 'grad_norm': 6.226841449737549, 'learning_rate': 2.395892066049134e-05, 'epoch': 0.2013693113169553}
{'loss': 0.4809, 'grad_norm': 15.123695373535156, 'learning_rate': 2.2952074103906564e-05, 'epoch': 0.23493086320311451}
{'loss': 0.4969, 'grad_norm': 8.688844680786133, 'learning_rate': 2.194522754732179e-05, 'epoch': 0.26849241508927374}
{'loss': 0.4684, 'grad_norm': 3.9148807525634766, 'learning_rate': 2.093838099073701e-05, 'epoch': 0.30205396697543296}
{'loss': 0.4273, 'grad_norm': 13.921478271484375, 'learning_rate': 1.9931534434152236e-05, 'epoch': 0.33561551886159213}
{'loss': 0.3966, 'grad_norm': 24.32870864868164, 'learning_rate': 1.8924687877567458e-05, 'epoch': 0.36917707074775136}
{'loss': 0.356, 'grad_norm': 4.745545387268066, 'learning_rate': 1.7917841320982683e-05, 'epoch': 0.4027386226339106}
{'loss': 0.3592, 'grad_norm': 2.60446834564209, 'learning_rate': 1.6910994764397905e-05, 'epoch': 0.4363001745200698}
{'loss': 0.3242, 'grad_norm': 13.870332717895508, 'learning_rate': 1.590414820781313e-05, 'epoch': 0.46986172640622903}
{'loss': 0.3197, 'grad_norm': 10.704183578491211, 'learning_rate': 1.4897301651228352e-05, 'epoch': 0.5034232782923882}
{'loss': 0.2894, 'grad_norm': 7.6099019050598145, 'learning_rate': 1.3890455094643576e-05, 'epoch': 0.5369848301785475}
{'loss': 0.2897, 'grad_norm': 19.643293380737305, 'learning_rate': 1.2883608538058801e-05, 'epoch': 0.5705463820647066}
{'loss': 0.2632, 'grad_norm': 17.332286834716797, 'learning_rate': 1.1876761981474025e-05, 'epoch': 0.6041079339508659}
{'loss': 0.2681, 'grad_norm': 8.692656517028809, 'learning_rate': 1.0869915424889248e-05, 'epoch': 0.6376694858370251}
{'loss': 0.244, 'grad_norm': 13.965633392333984, 'learning_rate': 9.86306886830447e-06, 'epoch': 0.6712310377231843}
{'loss': 0.2324, 'grad_norm': 1.618316888809204, 'learning_rate': 8.856222311719694e-06, 'epoch': 0.7047925896093435}
{'loss': 0.21, 'grad_norm': 18.91298484802246, 'learning_rate': 7.849375755134917e-06, 'epoch': 0.7383541414955027}
{'loss': 0.2163, 'grad_norm': 12.9194974899292, 'learning_rate': 6.8425291985501415e-06, 'epoch': 0.771915693381662}
{'loss': 0.2315, 'grad_norm': 32.42679977416992, 'learning_rate': 5.835682641965364e-06, 'epoch': 0.8054772452678212}
{'loss': 0.2007, 'grad_norm': 10.000288009643555, 'learning_rate': 4.828836085380589e-06, 'epoch': 0.8390387971539804}
{'loss': 0.1948, 'grad_norm': 20.74333381652832, 'learning_rate': 3.821989528795812e-06, 'epoch': 0.8726003490401396}
{'loss': 0.1909, 'grad_norm': 5.107454299926758, 'learning_rate': 2.815142972211035e-06, 'epoch': 0.9061619009262988}
{'loss': 0.1834, 'grad_norm': 24.34492301940918, 'learning_rate': 1.8082964156262586e-06, 'epoch': 0.9397234528124581}
{'loss': 0.1808, 'grad_norm': 1.7976607084274292, 'learning_rate': 8.014498590414822e-07, 'epoch': 0.9732850046986172}
{'eval_loss': 1.0146315097808838, 'eval_runtime': 773.3349, 'eval_samples_per_second': 180.031, 'eval_steps_per_second': 0.703, 'epoch': 1.0}
{'train_runtime': 4783.3149, 'train_samples_per_second': 49.831, 'train_steps_per_second': 3.115, 'train_loss': 0.3848829332142488, 'epoch': 1.0}
Post-processing 110915 example predictions split into 434008 features.
{
    "142": {
        "QA": {
            "exact_match": 29.990120699282677,
            "f1": 70.6929134331987
        },
        "PR": {
            "p@1": 0.9516129032258065,
            "p@2": 0.9958979425282419,
            "p@3": 0.9996563721489626
        },
        "PRQA": {
            "exact_match": 29.468235900519737,
            "f1": 69.04554295962953
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 631867 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 631867 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
