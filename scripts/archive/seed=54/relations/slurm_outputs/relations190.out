2024-05-06 10:33:46 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 190 ---------------
2024-05-06 10:33:46 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-06 10:33:46 INFO     Contexts were splited into 495 paragraphs, which are 1.6610738255033557 paragraphs on average per one report. There are 1 unique topics with frequency threshold (greater or equal) 190. The overall paragraph average length (characters) is 3409.8929292929292
2024-05-06 10:33:46 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-06 10:33:46 INFO     Contexts were splited into 69 paragraphs, which are 1.6428571428571428 paragraphs on average per one report. There are 1 unique topics with frequency threshold (greater or equal) 190. The overall paragraph average length (characters) is 2661.855072463768
2024-05-06 10:33:47 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-06 10:33:47 INFO     Contexts were splited into 141 paragraphs, which are 1.6395348837209303 paragraphs on average per one report. There are 1 unique topics with frequency threshold (greater or equal) 190. The overall paragraph average length (characters) is 3052.049645390071
2024-05-06 10:34:25 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-06 10:44:38 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-06 13:18:46 INFO     the model is trained
2024-05-06 13:40:41 INFO     evaluation data are prepared
2024-05-06 17:56:56 INFO     QA scores: {'exact_match': 91.57193776793025, 'f1': 96.61645451842011}
2024-05-06 17:56:56 INFO     PR scores: {'p@1': 0.9999337700496123, 'p@2': 1.0, 'p@3': 1.0}
2024-05-06 17:57:06 INFO     PRQA scores: {'exact_match': 91.57193776793025, 'f1': 96.61372790877428}
{'loss': 0.5199, 'grad_norm': 1.0439038276672363, 'learning_rate': 2.9257756445148204e-05, 'epoch': 0.02474145182839329}
{'loss': 0.1943, 'grad_norm': 9.29648208618164, 'learning_rate': 2.8515512890296403e-05, 'epoch': 0.04948290365678658}
{'loss': 0.1616, 'grad_norm': 12.43774700164795, 'learning_rate': 2.7773269335444602e-05, 'epoch': 0.07422435548517987}
{'loss': 0.1507, 'grad_norm': 0.7635342478752136, 'learning_rate': 2.7031025780592805e-05, 'epoch': 0.09896580731357316}
{'loss': 0.1298, 'grad_norm': 4.8823323249816895, 'learning_rate': 2.6288782225741008e-05, 'epoch': 0.12370725914196645}
{'loss': 0.1235, 'grad_norm': 2.7894034385681152, 'learning_rate': 2.5546538670889208e-05, 'epoch': 0.14844871097035975}
{'loss': 0.1188, 'grad_norm': 14.619382858276367, 'learning_rate': 2.480429511603741e-05, 'epoch': 0.17319016279875304}
{'loss': 0.1188, 'grad_norm': 3.5345816612243652, 'learning_rate': 2.406205156118561e-05, 'epoch': 0.1979316146271463}
{'loss': 0.1139, 'grad_norm': 7.366410732269287, 'learning_rate': 2.3319808006333813e-05, 'epoch': 0.2226730664555396}
{'loss': 0.1133, 'grad_norm': 6.788910388946533, 'learning_rate': 2.2577564451482012e-05, 'epoch': 0.2474145182839329}
{'loss': 0.1056, 'grad_norm': 4.587954998016357, 'learning_rate': 2.1835320896630215e-05, 'epoch': 0.2721559701123262}
{'loss': 0.0976, 'grad_norm': 0.41170018911361694, 'learning_rate': 2.1093077341778418e-05, 'epoch': 0.2968974219407195}
{'loss': 0.1023, 'grad_norm': 12.252262115478516, 'learning_rate': 2.0350833786926617e-05, 'epoch': 0.32163887376911277}
{'loss': 0.0873, 'grad_norm': 0.19228233397006989, 'learning_rate': 1.9608590232074817e-05, 'epoch': 0.3463803255975061}
{'loss': 0.0946, 'grad_norm': 2.2972054481506348, 'learning_rate': 1.886634667722302e-05, 'epoch': 0.37112177742589936}
{'loss': 0.0835, 'grad_norm': 3.1075782775878906, 'learning_rate': 1.8124103122371222e-05, 'epoch': 0.3958632292542926}
{'loss': 0.086, 'grad_norm': 0.08222682029008865, 'learning_rate': 1.7381859567519425e-05, 'epoch': 0.42060468108268595}
{'loss': 0.085, 'grad_norm': 0.7496797442436218, 'learning_rate': 1.663961601266762e-05, 'epoch': 0.4453461329110792}
{'loss': 0.0747, 'grad_norm': 0.2648533880710602, 'learning_rate': 1.5897372457815824e-05, 'epoch': 0.4700875847394725}
{'loss': 0.0891, 'grad_norm': 10.100003242492676, 'learning_rate': 1.5155128902964027e-05, 'epoch': 0.4948290365678658}
{'loss': 0.0801, 'grad_norm': 0.0748232901096344, 'learning_rate': 1.4412885348112228e-05, 'epoch': 0.5195704883962591}
{'loss': 0.0648, 'grad_norm': 0.09583112597465515, 'learning_rate': 1.3670641793260429e-05, 'epoch': 0.5443119402246523}
{'loss': 0.0653, 'grad_norm': 0.5657912492752075, 'learning_rate': 1.292839823840863e-05, 'epoch': 0.5690533920530457}
{'loss': 0.0699, 'grad_norm': 3.685584545135498, 'learning_rate': 1.2186154683556831e-05, 'epoch': 0.593794843881439}
{'loss': 0.0615, 'grad_norm': 3.219193458557129, 'learning_rate': 1.1443911128705032e-05, 'epoch': 0.6185362957098323}
{'loss': 0.0618, 'grad_norm': 0.07821055501699448, 'learning_rate': 1.0701667573853234e-05, 'epoch': 0.6432777475382255}
{'loss': 0.0582, 'grad_norm': 0.14740881323814392, 'learning_rate': 9.959424019001435e-06, 'epoch': 0.6680191993666188}
{'loss': 0.0629, 'grad_norm': 0.11122091859579086, 'learning_rate': 9.217180464149636e-06, 'epoch': 0.6927606511950122}
{'loss': 0.0555, 'grad_norm': 0.19696234166622162, 'learning_rate': 8.474936909297839e-06, 'epoch': 0.7175021030234054}
{'loss': 0.0593, 'grad_norm': 9.458359718322754, 'learning_rate': 7.732693354446038e-06, 'epoch': 0.7422435548517987}
{'loss': 0.0592, 'grad_norm': 0.31614938378334045, 'learning_rate': 6.990449799594241e-06, 'epoch': 0.766985006680192}
{'loss': 0.054, 'grad_norm': 0.04593336954712868, 'learning_rate': 6.248206244742442e-06, 'epoch': 0.7917264585085853}
{'loss': 0.0483, 'grad_norm': 0.1758858561515808, 'learning_rate': 5.505962689890643e-06, 'epoch': 0.8164679103369785}
{'loss': 0.0449, 'grad_norm': 0.01751362532377243, 'learning_rate': 4.763719135038844e-06, 'epoch': 0.8412093621653719}
{'loss': 0.0473, 'grad_norm': 0.05782267823815346, 'learning_rate': 4.021475580187045e-06, 'epoch': 0.8659508139937652}
{'loss': 0.0459, 'grad_norm': 0.10835228860378265, 'learning_rate': 3.2792320253352466e-06, 'epoch': 0.8906922658221584}
{'loss': 0.0495, 'grad_norm': 0.012079527601599693, 'learning_rate': 2.536988470483448e-06, 'epoch': 0.9154337176505517}
{'loss': 0.0433, 'grad_norm': 0.02725851535797119, 'learning_rate': 1.7947449156316491e-06, 'epoch': 0.940175169478945}
{'loss': 0.0475, 'grad_norm': 0.045189548283815384, 'learning_rate': 1.0525013607798505e-06, 'epoch': 0.9649166213073384}
{'loss': 0.039, 'grad_norm': 0.0433625690639019, 'learning_rate': 3.1025780592805187e-07, 'epoch': 0.9896580731357316}
{'eval_loss': 0.2255149632692337, 'eval_runtime': 3787.346, 'eval_samples_per_second': 179.295, 'eval_steps_per_second': 0.7, 'epoch': 1.0}
{'train_runtime': 9248.0195, 'train_samples_per_second': 34.962, 'train_steps_per_second': 2.185, 'train_loss': 0.09373977880474602, 'epoch': 1.0}
Post-processing 290387 example predictions split into 1526112 features.
{
    "190": {
        "QA": {
            "exact_match": 91.57193776793025,
            "f1": 96.61645451842011
        },
        "PR": {
            "p@1": 0.9999337700496123,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 91.57193776793025,
            "f1": 96.61372790877428
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 3162291 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 3162291 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
