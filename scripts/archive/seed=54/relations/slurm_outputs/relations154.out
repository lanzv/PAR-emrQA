2024-05-06 10:33:42 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 154 ---------------
2024-05-06 10:33:42 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-06 10:33:42 INFO     Contexts were splited into 711 paragraphs, which are 2.3859060402684564 paragraphs on average per one report. There are 3 unique topics with frequency threshold (greater or equal) 154. The overall paragraph average length (characters) is 2373.9760900140645
2024-05-06 10:33:42 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-06 10:33:42 INFO     Contexts were splited into 110 paragraphs, which are 2.619047619047619 paragraphs on average per one report. There are 3 unique topics with frequency threshold (greater or equal) 154. The overall paragraph average length (characters) is 1669.709090909091
2024-05-06 10:33:43 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-06 10:33:43 INFO     Contexts were splited into 214 paragraphs, which are 2.488372093023256 paragraphs on average per one report. There are 3 unique topics with frequency threshold (greater or equal) 154. The overall paragraph average length (characters) is 2010.9299065420562
2024-05-06 10:34:22 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-06 10:44:37 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-06 13:22:10 INFO     the model is trained
2024-05-06 13:45:11 INFO     evaluation data are prepared
2024-05-06 18:21:44 INFO     QA scores: {'exact_match': 90.74105293579308, 'f1': 96.38247627168428}
2024-05-06 18:21:44 INFO     PR scores: {'p@1': 0.9994520976831559, 'p@2': 1.0, 'p@3': 1.0}
2024-05-06 18:21:54 INFO     PRQA scores: {'exact_match': 90.69288569914744, 'f1': 96.35801132940466}
{'loss': 0.5675, 'grad_norm': 2.9145772457122803, 'learning_rate': 2.9271844660194176e-05, 'epoch': 0.024271844660194174}
{'loss': 0.1979, 'grad_norm': 5.658117294311523, 'learning_rate': 2.854368932038835e-05, 'epoch': 0.04854368932038835}
{'loss': 0.1812, 'grad_norm': 2.3728110790252686, 'learning_rate': 2.7815533980582527e-05, 'epoch': 0.07281553398058252}
{'loss': 0.1551, 'grad_norm': 5.181682586669922, 'learning_rate': 2.7087378640776702e-05, 'epoch': 0.0970873786407767}
{'loss': 0.1601, 'grad_norm': 4.617647647857666, 'learning_rate': 2.6359223300970877e-05, 'epoch': 0.12135922330097088}
{'loss': 0.1315, 'grad_norm': 2.363051414489746, 'learning_rate': 2.563106796116505e-05, 'epoch': 0.14563106796116504}
{'loss': 0.1279, 'grad_norm': 2.3475186824798584, 'learning_rate': 2.4902912621359224e-05, 'epoch': 0.16990291262135923}
{'loss': 0.1271, 'grad_norm': 6.343267917633057, 'learning_rate': 2.41747572815534e-05, 'epoch': 0.1941747572815534}
{'loss': 0.1107, 'grad_norm': 8.23902416229248, 'learning_rate': 2.3446601941747575e-05, 'epoch': 0.21844660194174756}
{'loss': 0.1014, 'grad_norm': 4.384669303894043, 'learning_rate': 2.2718446601941746e-05, 'epoch': 0.24271844660194175}
{'loss': 0.1063, 'grad_norm': 8.492767333984375, 'learning_rate': 2.1990291262135922e-05, 'epoch': 0.2669902912621359}
{'loss': 0.0965, 'grad_norm': 0.7317360043525696, 'learning_rate': 2.1262135922330097e-05, 'epoch': 0.2912621359223301}
{'loss': 0.0958, 'grad_norm': 0.26190826296806335, 'learning_rate': 2.0533980582524272e-05, 'epoch': 0.3155339805825243}
{'loss': 0.0904, 'grad_norm': 13.59085464477539, 'learning_rate': 1.9805825242718447e-05, 'epoch': 0.33980582524271846}
{'loss': 0.1005, 'grad_norm': 0.10003645718097687, 'learning_rate': 1.9077669902912623e-05, 'epoch': 0.3640776699029126}
{'loss': 0.0983, 'grad_norm': 2.1947154998779297, 'learning_rate': 1.8349514563106795e-05, 'epoch': 0.3883495145631068}
{'loss': 0.0886, 'grad_norm': 0.44473716616630554, 'learning_rate': 1.762135922330097e-05, 'epoch': 0.41262135922330095}
{'loss': 0.0828, 'grad_norm': 1.5210506916046143, 'learning_rate': 1.6893203883495145e-05, 'epoch': 0.4368932038834951}
{'loss': 0.081, 'grad_norm': 22.48668098449707, 'learning_rate': 1.616504854368932e-05, 'epoch': 0.46116504854368934}
{'loss': 0.0756, 'grad_norm': 4.404299736022949, 'learning_rate': 1.5436893203883496e-05, 'epoch': 0.4854368932038835}
{'loss': 0.0771, 'grad_norm': 0.05767275020480156, 'learning_rate': 1.470873786407767e-05, 'epoch': 0.5097087378640777}
{'loss': 0.076, 'grad_norm': 8.300708770751953, 'learning_rate': 1.3980582524271846e-05, 'epoch': 0.5339805825242718}
{'loss': 0.0695, 'grad_norm': 0.04978038743138313, 'learning_rate': 1.3252427184466021e-05, 'epoch': 0.558252427184466}
{'loss': 0.0732, 'grad_norm': 0.024710306897759438, 'learning_rate': 1.2524271844660193e-05, 'epoch': 0.5825242718446602}
{'loss': 0.0776, 'grad_norm': 0.0953664630651474, 'learning_rate': 1.1796116504854368e-05, 'epoch': 0.6067961165048543}
{'loss': 0.0672, 'grad_norm': 0.014852769672870636, 'learning_rate': 1.1067961165048544e-05, 'epoch': 0.6310679611650486}
{'loss': 0.0567, 'grad_norm': 0.19932663440704346, 'learning_rate': 1.0339805825242719e-05, 'epoch': 0.6553398058252428}
{'loss': 0.0534, 'grad_norm': 0.16976763308048248, 'learning_rate': 9.611650485436894e-06, 'epoch': 0.6796116504854369}
{'loss': 0.0587, 'grad_norm': 10.552562713623047, 'learning_rate': 8.883495145631068e-06, 'epoch': 0.7038834951456311}
{'loss': 0.056, 'grad_norm': 1.3506361246109009, 'learning_rate': 8.155339805825243e-06, 'epoch': 0.7281553398058253}
{'loss': 0.0619, 'grad_norm': 2.8928070068359375, 'learning_rate': 7.427184466019417e-06, 'epoch': 0.7524271844660194}
{'loss': 0.0499, 'grad_norm': 2.9941611289978027, 'learning_rate': 6.699029126213593e-06, 'epoch': 0.7766990291262136}
{'loss': 0.0465, 'grad_norm': 0.02099599316716194, 'learning_rate': 5.970873786407767e-06, 'epoch': 0.8009708737864077}
{'loss': 0.0487, 'grad_norm': 0.19312870502471924, 'learning_rate': 5.242718446601942e-06, 'epoch': 0.8252427184466019}
{'loss': 0.0555, 'grad_norm': 0.1364993304014206, 'learning_rate': 4.514563106796117e-06, 'epoch': 0.8495145631067961}
{'loss': 0.0522, 'grad_norm': 0.009536021389067173, 'learning_rate': 3.7864077669902915e-06, 'epoch': 0.8737864077669902}
{'loss': 0.0563, 'grad_norm': 34.472713470458984, 'learning_rate': 3.058252427184466e-06, 'epoch': 0.8980582524271845}
{'loss': 0.0441, 'grad_norm': 11.86329460144043, 'learning_rate': 2.3300970873786407e-06, 'epoch': 0.9223300970873787}
{'loss': 0.046, 'grad_norm': 0.007023423444479704, 'learning_rate': 1.6019417475728156e-06, 'epoch': 0.9466019417475728}
{'loss': 0.0499, 'grad_norm': 0.03554419055581093, 'learning_rate': 8.737864077669904e-07, 'epoch': 0.970873786407767}
{'loss': 0.0418, 'grad_norm': 0.026105454191565514, 'learning_rate': 1.4563106796116505e-07, 'epoch': 0.9951456310679612}
{'eval_loss': 0.21798597276210785, 'eval_runtime': 3887.5449, 'eval_samples_per_second': 178.424, 'eval_steps_per_second': 0.697, 'epoch': 1.0}
{'train_runtime': 9452.6084, 'train_samples_per_second': 34.867, 'train_steps_per_second': 2.179, 'train_loss': 0.09717238095200177, 'epoch': 1.0}
Post-processing 411873 example predictions split into 1640743 features.
{
    "154": {
        "QA": {
            "exact_match": 90.74105293579308,
            "f1": 96.38247627168428
        },
        "PR": {
            "p@1": 0.9994520976831559,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 90.69288569914744,
            "f1": 96.35801132940466
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2651202 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2651202 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
