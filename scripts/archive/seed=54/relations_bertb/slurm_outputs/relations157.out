2024-05-07 15:55:22 INFO     ------------- Experiment: model BERTbase, frequency threshold 157 ---------------
2024-05-07 15:55:22 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-07 15:55:22 INFO     Contexts were splited into 555 paragraphs, which are 1.8624161073825503 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 3041.2558558558558
2024-05-07 15:55:23 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-07 15:55:23 INFO     Contexts were splited into 83 paragraphs, which are 1.9761904761904763 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2212.867469879518
2024-05-07 15:55:23 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-07 15:55:23 INFO     Contexts were splited into 163 paragraphs, which are 1.8953488372093024 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2640.116564417178
2024-05-07 15:56:01 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/bert-base-cased and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-07 16:05:38 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-07 18:49:52 INFO     the model is trained
2024-05-07 19:11:44 INFO     evaluation data are prepared
2024-05-07 23:52:18 INFO     QA scores: {'exact_match': 88.902268676846, 'f1': 94.65511695387339}
2024-05-07 23:52:18 INFO     PR scores: {'p@1': 0.9959659939309282, 'p@2': 1.0, 'p@3': 1.0}
2024-05-07 23:52:28 INFO     PRQA scores: {'exact_match': 88.774023409277, 'f1': 94.5342396938528}
{'loss': 0.591, 'grad_norm': 17.4178409576416, 'learning_rate': 2.93003405009562e-05, 'epoch': 0.023321983301459955}
{'loss': 0.2735, 'grad_norm': 13.097207069396973, 'learning_rate': 2.8600681001912404e-05, 'epoch': 0.04664396660291991}
{'loss': 0.2465, 'grad_norm': 6.010432243347168, 'learning_rate': 2.7901021502868604e-05, 'epoch': 0.06996594990437986}
{'loss': 0.2321, 'grad_norm': 8.389740943908691, 'learning_rate': 2.7201362003824807e-05, 'epoch': 0.09328793320583982}
{'loss': 0.2186, 'grad_norm': 52.219417572021484, 'learning_rate': 2.6501702504781007e-05, 'epoch': 0.11660991650729978}
{'loss': 0.2041, 'grad_norm': 1.8892998695373535, 'learning_rate': 2.5802043005737207e-05, 'epoch': 0.13993189980875972}
{'loss': 0.179, 'grad_norm': 67.34967803955078, 'learning_rate': 2.510238350669341e-05, 'epoch': 0.16325388311021968}
{'loss': 0.1741, 'grad_norm': 3.3656229972839355, 'learning_rate': 2.440272400764961e-05, 'epoch': 0.18657586641167964}
{'loss': 0.1704, 'grad_norm': 6.430224895477295, 'learning_rate': 2.370306450860581e-05, 'epoch': 0.2098978497131396}
{'loss': 0.1564, 'grad_norm': 25.67249298095703, 'learning_rate': 2.3003405009562014e-05, 'epoch': 0.23321983301459956}
{'loss': 0.1531, 'grad_norm': 1.421123743057251, 'learning_rate': 2.2303745510518214e-05, 'epoch': 0.2565418163160595}
{'loss': 0.1578, 'grad_norm': 0.07653751224279404, 'learning_rate': 2.1604086011474417e-05, 'epoch': 0.27986379961751945}
{'loss': 0.1472, 'grad_norm': 0.5702105760574341, 'learning_rate': 2.0904426512430617e-05, 'epoch': 0.3031857829189794}
{'loss': 0.145, 'grad_norm': 2.3154776096343994, 'learning_rate': 2.0204767013386817e-05, 'epoch': 0.32650776622043937}
{'loss': 0.1304, 'grad_norm': 11.386382102966309, 'learning_rate': 1.950510751434302e-05, 'epoch': 0.3498297495218993}
{'loss': 0.1539, 'grad_norm': 0.3014492094516754, 'learning_rate': 1.880544801529922e-05, 'epoch': 0.3731517328233593}
{'loss': 0.1334, 'grad_norm': 13.067944526672363, 'learning_rate': 1.810578851625542e-05, 'epoch': 0.39647371612481924}
{'loss': 0.1261, 'grad_norm': 6.374145030975342, 'learning_rate': 1.7406129017211623e-05, 'epoch': 0.4197956994262792}
{'loss': 0.1278, 'grad_norm': 0.5815372467041016, 'learning_rate': 1.6706469518167823e-05, 'epoch': 0.44311768272773916}
{'loss': 0.116, 'grad_norm': 5.548543930053711, 'learning_rate': 1.6006810019124027e-05, 'epoch': 0.4664396660291991}
{'loss': 0.111, 'grad_norm': 18.903465270996094, 'learning_rate': 1.5307150520080227e-05, 'epoch': 0.4897616493306591}
{'loss': 0.1029, 'grad_norm': 0.07329650223255157, 'learning_rate': 1.460749102103643e-05, 'epoch': 0.513083632632119}
{'loss': 0.097, 'grad_norm': 0.17068146169185638, 'learning_rate': 1.390783152199263e-05, 'epoch': 0.5364056159335789}
{'loss': 0.1029, 'grad_norm': 0.06610412150621414, 'learning_rate': 1.3208172022948831e-05, 'epoch': 0.5597275992350389}
{'loss': 0.0979, 'grad_norm': 0.5728427767753601, 'learning_rate': 1.2508512523905033e-05, 'epoch': 0.5830495825364989}
{'loss': 0.0949, 'grad_norm': 0.8953559994697571, 'learning_rate': 1.1808853024861235e-05, 'epoch': 0.6063715658379588}
{'loss': 0.0929, 'grad_norm': 62.83134078979492, 'learning_rate': 1.1109193525817435e-05, 'epoch': 0.6296935491394188}
{'loss': 0.0862, 'grad_norm': 0.049079954624176025, 'learning_rate': 1.0409534026773636e-05, 'epoch': 0.6530155324408787}
{'loss': 0.0893, 'grad_norm': 0.41834497451782227, 'learning_rate': 9.709874527729838e-06, 'epoch': 0.6763375157423387}
{'loss': 0.0813, 'grad_norm': 0.2029847651720047, 'learning_rate': 9.01021502868604e-06, 'epoch': 0.6996594990437986}
{'loss': 0.0848, 'grad_norm': 0.5532248616218567, 'learning_rate': 8.31055552964224e-06, 'epoch': 0.7229814823452586}
{'loss': 0.0816, 'grad_norm': 9.38570499420166, 'learning_rate': 7.610896030598441e-06, 'epoch': 0.7463034656467186}
{'loss': 0.0829, 'grad_norm': 0.0069858720526099205, 'learning_rate': 6.911236531554644e-06, 'epoch': 0.7696254489481785}
{'loss': 0.0675, 'grad_norm': 0.20375998318195343, 'learning_rate': 6.211577032510845e-06, 'epoch': 0.7929474322496385}
{'loss': 0.0781, 'grad_norm': 0.10947977751493454, 'learning_rate': 5.511917533467046e-06, 'epoch': 0.8162694155510984}
{'loss': 0.0651, 'grad_norm': 0.049587685614824295, 'learning_rate': 4.812258034423248e-06, 'epoch': 0.8395913988525584}
{'loss': 0.0672, 'grad_norm': 0.07812482118606567, 'learning_rate': 4.112598535379448e-06, 'epoch': 0.8629133821540184}
{'loss': 0.0585, 'grad_norm': 0.040367428213357925, 'learning_rate': 3.41293903633565e-06, 'epoch': 0.8862353654554783}
{'loss': 0.0661, 'grad_norm': 0.022195829078555107, 'learning_rate': 2.7132795372918513e-06, 'epoch': 0.9095573487569383}
{'loss': 0.0596, 'grad_norm': 6.9136247634887695, 'learning_rate': 2.0136200382480525e-06, 'epoch': 0.9328793320583982}
{'loss': 0.0769, 'grad_norm': 0.01928361877799034, 'learning_rate': 1.3139605392042539e-06, 'epoch': 0.9562013153598582}
{'loss': 0.0575, 'grad_norm': 0.16345442831516266, 'learning_rate': 6.143010401604553e-07, 'epoch': 0.9795232986613182}
{'eval_loss': 0.2608394920825958, 'eval_runtime': 4051.88, 'eval_samples_per_second': 178.913, 'eval_steps_per_second': 0.699, 'epoch': 1.0}
{'train_runtime': 9852.5858, 'train_samples_per_second': 34.815, 'train_steps_per_second': 2.176, 'train_loss': 0.1328601099627527, 'epoch': 1.0}
Post-processing 331289 example predictions split into 1666112 features.
{
    "157": {
        "QA": {
            "exact_match": 88.902268676846,
            "f1": 94.65511695387339
        },
        "PR": {
            "p@1": 0.9959659939309282,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 88.774023409277,
            "f1": 94.5342396938528
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2655459 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2655459 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
