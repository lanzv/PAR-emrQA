2024-05-07 05:57:26 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 198 ---------------
2024-05-07 05:57:26 INFO     Contexts were splited into 360 paragraphs, which are 1.2080536912751678 paragraphs on average per one report. The overall paragraph average length (characters) is 4596.308333333333
2024-05-07 05:57:26 INFO     Contexts were splited into 47 paragraphs, which are 1.119047619047619 paragraphs on average per one report. The overall paragraph average length (characters) is 3829.723404255319
2024-05-07 05:57:27 INFO     Contexts were splited into 102 paragraphs, which are 1.186046511627907 paragraphs on average per one report. The overall paragraph average length (characters) is 4135.068627450981
2024-05-07 05:58:00 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-07 06:07:36 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-07 08:24:53 INFO     the model is trained
2024-05-07 08:45:48 INFO     evaluation data are prepared
2024-05-07 12:44:49 INFO     QA scores: {'exact_match': 91.7176436587833, 'f1': 96.86609980640443}
2024-05-07 12:44:50 INFO     PR scores: {'p@1': 0.991817590674823, 'p@2': 0.9991871778816049, 'p@3': 1.0}
2024-05-07 12:45:00 INFO     PRQA scores: {'exact_match': 91.16612879919079, 'f1': 96.36329173968909}
{'loss': 0.6069, 'grad_norm': 6.544845104217529, 'learning_rate': 2.9158343620244642e-05, 'epoch': 0.028055212658511953}
{'loss': 0.2169, 'grad_norm': 0.3000844419002533, 'learning_rate': 2.8316687240489283e-05, 'epoch': 0.056110425317023906}
{'loss': 0.1941, 'grad_norm': 0.07502483576536179, 'learning_rate': 2.7475030860733924e-05, 'epoch': 0.08416563797553585}
{'loss': 0.152, 'grad_norm': 2.717724561691284, 'learning_rate': 2.6633374480978566e-05, 'epoch': 0.11222085063404781}
{'loss': 0.138, 'grad_norm': 0.10848089307546616, 'learning_rate': 2.579171810122321e-05, 'epoch': 0.14027606329255976}
{'loss': 0.1438, 'grad_norm': 1.3586755990982056, 'learning_rate': 2.495006172146785e-05, 'epoch': 0.1683312759510717}
{'loss': 0.1222, 'grad_norm': 0.18659183382987976, 'learning_rate': 2.4108405341712493e-05, 'epoch': 0.19638648860958366}
{'loss': 0.1082, 'grad_norm': 0.03610658273100853, 'learning_rate': 2.3266748961957134e-05, 'epoch': 0.22444170126809562}
{'loss': 0.1176, 'grad_norm': 1.1474459171295166, 'learning_rate': 2.2425092582201775e-05, 'epoch': 0.25249691392660756}
{'loss': 0.1121, 'grad_norm': 0.6616689562797546, 'learning_rate': 2.1583436202446417e-05, 'epoch': 0.2805521265851195}
{'loss': 0.1038, 'grad_norm': 0.06490585952997208, 'learning_rate': 2.0741779822691054e-05, 'epoch': 0.3086073392436315}
{'loss': 0.0929, 'grad_norm': 1.322567343711853, 'learning_rate': 1.9900123442935696e-05, 'epoch': 0.3366625519021434}
{'loss': 0.0782, 'grad_norm': 18.87419891357422, 'learning_rate': 1.9058467063180337e-05, 'epoch': 0.36471776456065536}
{'loss': 0.0923, 'grad_norm': 0.9861798882484436, 'learning_rate': 1.8216810683424978e-05, 'epoch': 0.3927729772191673}
{'loss': 0.097, 'grad_norm': 16.875722885131836, 'learning_rate': 1.7375154303669623e-05, 'epoch': 0.4208281898776793}
{'loss': 0.0874, 'grad_norm': 0.008990113623440266, 'learning_rate': 1.6533497923914264e-05, 'epoch': 0.44888340253619124}
{'loss': 0.0838, 'grad_norm': 16.73417854309082, 'learning_rate': 1.5691841544158905e-05, 'epoch': 0.47693861519470315}
{'loss': 0.0804, 'grad_norm': 0.8794381022453308, 'learning_rate': 1.4850185164403547e-05, 'epoch': 0.5049938278532151}
{'loss': 0.0807, 'grad_norm': 4.192617893218994, 'learning_rate': 1.4008528784648188e-05, 'epoch': 0.5330490405117271}
{'loss': 0.0685, 'grad_norm': 0.801010012626648, 'learning_rate': 1.3166872404892829e-05, 'epoch': 0.561104253170239}
{'loss': 0.0712, 'grad_norm': 19.104276657104492, 'learning_rate': 1.232521602513747e-05, 'epoch': 0.589159465828751}
{'loss': 0.0722, 'grad_norm': 1.9105098247528076, 'learning_rate': 1.1483559645382113e-05, 'epoch': 0.617214678487263}
{'loss': 0.0647, 'grad_norm': 0.0911179780960083, 'learning_rate': 1.0641903265626754e-05, 'epoch': 0.6452698911457749}
{'loss': 0.0575, 'grad_norm': 0.4291815757751465, 'learning_rate': 9.800246885871396e-06, 'epoch': 0.6733251038042868}
{'loss': 0.0617, 'grad_norm': 0.01824238896369934, 'learning_rate': 8.958590506116037e-06, 'epoch': 0.7013803164627987}
{'loss': 0.0577, 'grad_norm': 6.793167591094971, 'learning_rate': 8.116934126360676e-06, 'epoch': 0.7294355291213107}
{'loss': 0.0668, 'grad_norm': 2.267914056777954, 'learning_rate': 7.275277746605319e-06, 'epoch': 0.7574907417798227}
{'loss': 0.0538, 'grad_norm': 0.011329649947583675, 'learning_rate': 6.4336213668499615e-06, 'epoch': 0.7855459544383346}
{'loss': 0.0527, 'grad_norm': 0.28923389315605164, 'learning_rate': 5.591964987094602e-06, 'epoch': 0.8136011670968466}
{'loss': 0.0516, 'grad_norm': 0.03988569602370262, 'learning_rate': 4.750308607339244e-06, 'epoch': 0.8416563797553586}
{'loss': 0.0498, 'grad_norm': 0.05627196654677391, 'learning_rate': 3.908652227583885e-06, 'epoch': 0.8697115924138705}
{'loss': 0.046, 'grad_norm': 0.02149202488362789, 'learning_rate': 3.0669958478285264e-06, 'epoch': 0.8977668050723825}
{'loss': 0.046, 'grad_norm': 1.223004937171936, 'learning_rate': 2.225339468073168e-06, 'epoch': 0.9258220177308945}
{'loss': 0.05, 'grad_norm': 11.908832550048828, 'learning_rate': 1.3836830883178093e-06, 'epoch': 0.9538772303894063}
{'loss': 0.0434, 'grad_norm': 0.057914357632398605, 'learning_rate': 5.420267085624509e-07, 'epoch': 0.9819324430479183}
{'eval_loss': 0.22182248532772064, 'eval_runtime': 3458.1261, 'eval_samples_per_second': 180.336, 'eval_steps_per_second': 0.705, 'epoch': 1.0}
{'train_runtime': 8235.5604, 'train_samples_per_second': 34.623, 'train_steps_per_second': 2.164, 'train_loss': 0.102562503131896, 'epoch': 1.0}
Post-processing 238640 example predictions split into 1412461 features.
{
    "198": {
        "QA": {
            "exact_match": 91.7176436587833,
            "f1": 96.86609980640443
        },
        "PR": {
            "p@1": 0.991817590674823,
            "p@2": 0.9991871778816049,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 91.16612879919079,
            "f1": 96.36329173968909
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 629706 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 629706 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
