2024-05-07 18:26:24 INFO     ------------- Experiment: model BERTbase, frequency threshold 143 ---------------
2024-05-07 18:26:24 INFO     Contexts were splited into 1148 paragraphs, which are 3.8523489932885906 paragraphs on average per one report. The overall paragraph average length (characters) is 1441.3510452961673
2024-05-07 18:26:25 INFO     Contexts were splited into 125 paragraphs, which are 2.9761904761904763 paragraphs on average per one report. The overall paragraph average length (characters) is 1439.976
2024-05-07 18:26:26 INFO     Contexts were splited into 295 paragraphs, which are 3.4302325581395348 paragraphs on average per one report. The overall paragraph average length (characters) is 1429.7525423728814
2024-05-07 18:26:52 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/bert-base-cased and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-07 18:30:58 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-07 19:33:35 INFO     the model is trained
2024-05-07 19:54:37 INFO     evaluation data are prepared
2024-05-08 00:17:38 INFO     QA scores: {'exact_match': 90.93974278695632, 'f1': 96.43210085512858}
2024-05-08 00:17:38 INFO     PR scores: {'p@1': 0.9714609122874621, 'p@2': 0.9933770049612254, 'p@3': 0.9974049901257165}
2024-05-08 00:17:48 INFO     PRQA scores: {'exact_match': 89.1467174028226, 'f1': 94.77969699978692}
{'loss': 0.7367, 'grad_norm': 23.92967414855957, 'learning_rate': 2.8089171974522295e-05, 'epoch': 0.06369426751592357}
{'loss': 0.3749, 'grad_norm': 15.826539039611816, 'learning_rate': 2.617834394904459e-05, 'epoch': 0.12738853503184713}
{'loss': 0.3206, 'grad_norm': 10.670967102050781, 'learning_rate': 2.4267515923566882e-05, 'epoch': 0.1910828025477707}
{'loss': 0.2606, 'grad_norm': 8.714951515197754, 'learning_rate': 2.235668789808917e-05, 'epoch': 0.25477707006369427}
{'loss': 0.2331, 'grad_norm': 1.160217523574829, 'learning_rate': 2.0445859872611463e-05, 'epoch': 0.3184713375796178}
{'loss': 0.209, 'grad_norm': 25.26263427734375, 'learning_rate': 1.8535031847133757e-05, 'epoch': 0.3821656050955414}
{'loss': 0.19, 'grad_norm': 5.007111549377441, 'learning_rate': 1.662420382165605e-05, 'epoch': 0.445859872611465}
{'loss': 0.1795, 'grad_norm': 11.139918327331543, 'learning_rate': 1.4713375796178345e-05, 'epoch': 0.5095541401273885}
{'loss': 0.1516, 'grad_norm': 0.0840783566236496, 'learning_rate': 1.2802547770700637e-05, 'epoch': 0.5732484076433121}
{'loss': 0.144, 'grad_norm': 13.615056991577148, 'learning_rate': 1.0891719745222929e-05, 'epoch': 0.6369426751592356}
{'loss': 0.1245, 'grad_norm': 41.82497024536133, 'learning_rate': 8.980891719745223e-06, 'epoch': 0.7006369426751592}
{'loss': 0.1087, 'grad_norm': 32.68949508666992, 'learning_rate': 7.070063694267516e-06, 'epoch': 0.7643312101910829}
{'loss': 0.1083, 'grad_norm': 0.062202922999858856, 'learning_rate': 5.159235668789809e-06, 'epoch': 0.8280254777070064}
{'loss': 0.0914, 'grad_norm': 14.277548789978027, 'learning_rate': 3.248407643312102e-06, 'epoch': 0.89171974522293}
{'loss': 0.1231, 'grad_norm': 3.099975347518921, 'learning_rate': 1.3375796178343948e-06, 'epoch': 0.9554140127388535}
{'eval_loss': 0.43299004435539246, 'eval_runtime': 1634.065, 'eval_samples_per_second': 180.883, 'eval_steps_per_second': 0.707, 'epoch': 1.0}
{'train_runtime': 3756.0068, 'train_samples_per_second': 33.439, 'train_steps_per_second': 2.09, 'train_loss': 0.21767122523799823, 'epoch': 1.0}
Post-processing 852476 example predictions split into 1521556 features.
{
    "143": {
        "QA": {
            "exact_match": 90.93974278695632,
            "f1": 96.43210085512858
        },
        "PR": {
            "p@1": 0.9714609122874621,
            "p@2": 0.9933770049612254,
            "p@3": 0.9974049901257165
        },
        "PRQA": {
            "exact_match": 89.1467174028226,
            "f1": 94.77969699978692
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 480707 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 480707 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
