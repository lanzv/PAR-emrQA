2024-05-11 17:43:52 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 68 ---------------
2024-05-11 17:43:52 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-11 17:43:52 INFO     Contexts were splited into 2531 paragraphs, which are 8.493288590604028 paragraphs on average per one report. There are 20 unique topics with frequency threshold (greater or equal) 68. The overall paragraph average length (characters) is 666.8893717898064
2024-05-11 17:43:52 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-11 17:43:52 INFO     Contexts were splited into 285 paragraphs, which are 6.785714285714286 paragraphs on average per one report. There are 20 unique topics with frequency threshold (greater or equal) 68. The overall paragraph average length (characters) is 644.4491228070175
2024-05-11 17:43:53 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-11 17:43:53 INFO     Contexts were splited into 644 paragraphs, which are 7.488372093023256 paragraphs on average per one report. There are 20 unique topics with frequency threshold (greater or equal) 68. The overall paragraph average length (characters) is 668.2282608695652
2024-05-11 17:44:30 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 17:51:37 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 19:41:38 INFO     the model is trained
2024-05-11 20:09:43 INFO     evaluation data are prepared
2024-05-12 02:34:55 INFO     QA scores: {'exact_match': 91.90730215307548, 'f1': 96.94823373082116}
2024-05-12 02:34:56 INFO     PR scores: {'p@1': 0.991835653388565, 'p@2': 0.9995363903472858, 'p@3': 0.9998615191946438}
2024-05-12 02:35:06 INFO     PRQA scores: {'exact_match': 91.19141659842975, 'f1': 96.3917948764834}
{'loss': 0.5764, 'grad_norm': 12.858893394470215, 'learning_rate': 2.8944256756756755e-05, 'epoch': 0.03519144144144144}
{'loss': 0.2092, 'grad_norm': 13.303282737731934, 'learning_rate': 2.7888513513513516e-05, 'epoch': 0.07038288288288289}
{'loss': 0.1715, 'grad_norm': 15.086212158203125, 'learning_rate': 2.683277027027027e-05, 'epoch': 0.10557432432432433}
{'loss': 0.1488, 'grad_norm': 1.8839226961135864, 'learning_rate': 2.577702702702703e-05, 'epoch': 0.14076576576576577}
{'loss': 0.1342, 'grad_norm': 21.466920852661133, 'learning_rate': 2.4721283783783784e-05, 'epoch': 0.1759572072072072}
{'loss': 0.1293, 'grad_norm': 2.9744510650634766, 'learning_rate': 2.366554054054054e-05, 'epoch': 0.21114864864864866}
{'loss': 0.1315, 'grad_norm': 0.3487585484981537, 'learning_rate': 2.26097972972973e-05, 'epoch': 0.24634009009009009}
{'loss': 0.117, 'grad_norm': 32.630062103271484, 'learning_rate': 2.1554054054054053e-05, 'epoch': 0.28153153153153154}
{'loss': 0.1155, 'grad_norm': 1.2932407855987549, 'learning_rate': 2.049831081081081e-05, 'epoch': 0.31672297297297297}
{'loss': 0.0926, 'grad_norm': 0.24123354256153107, 'learning_rate': 1.9442567567567568e-05, 'epoch': 0.3519144144144144}
{'loss': 0.0981, 'grad_norm': 16.188634872436523, 'learning_rate': 1.8386824324324325e-05, 'epoch': 0.38710585585585583}
{'loss': 0.0872, 'grad_norm': 0.18083859980106354, 'learning_rate': 1.7331081081081082e-05, 'epoch': 0.4222972972972973}
{'loss': 0.0951, 'grad_norm': 2.2551941871643066, 'learning_rate': 1.6275337837837836e-05, 'epoch': 0.45748873873873874}
{'loss': 0.0894, 'grad_norm': 0.8147689700126648, 'learning_rate': 1.5219594594594594e-05, 'epoch': 0.49268018018018017}
{'loss': 0.078, 'grad_norm': 18.93250274658203, 'learning_rate': 1.4163851351351353e-05, 'epoch': 0.5278716216216216}
{'loss': 0.0767, 'grad_norm': 11.522448539733887, 'learning_rate': 1.3108108108108109e-05, 'epoch': 0.5630630630630631}
{'loss': 0.0599, 'grad_norm': 0.5910348296165466, 'learning_rate': 1.2052364864864864e-05, 'epoch': 0.5982545045045045}
{'loss': 0.0749, 'grad_norm': 1.7141987085342407, 'learning_rate': 1.0996621621621622e-05, 'epoch': 0.6334459459459459}
{'loss': 0.0628, 'grad_norm': 66.34780883789062, 'learning_rate': 9.940878378378379e-06, 'epoch': 0.6686373873873874}
{'loss': 0.0545, 'grad_norm': 0.03194775804877281, 'learning_rate': 8.885135135135135e-06, 'epoch': 0.7038288288288288}
{'loss': 0.0554, 'grad_norm': 0.4296666979789734, 'learning_rate': 7.829391891891892e-06, 'epoch': 0.7390202702702703}
{'loss': 0.0547, 'grad_norm': 5.554046630859375, 'learning_rate': 6.773648648648649e-06, 'epoch': 0.7742117117117117}
{'loss': 0.0582, 'grad_norm': 0.01612025871872902, 'learning_rate': 5.717905405405406e-06, 'epoch': 0.8094031531531531}
{'loss': 0.0479, 'grad_norm': 0.01048189029097557, 'learning_rate': 4.6621621621621625e-06, 'epoch': 0.8445945945945946}
{'loss': 0.0503, 'grad_norm': 0.028278330340981483, 'learning_rate': 3.6064189189189186e-06, 'epoch': 0.879786036036036}
{'loss': 0.056, 'grad_norm': 0.340150386095047, 'learning_rate': 2.550675675675676e-06, 'epoch': 0.9149774774774775}
{'loss': 0.0505, 'grad_norm': 0.10940050333738327, 'learning_rate': 1.4949324324324323e-06, 'epoch': 0.950168918918919}
{'loss': 0.0397, 'grad_norm': 5.897029876708984, 'learning_rate': 4.391891891891892e-07, 'epoch': 0.9853603603603603}
{'eval_loss': 0.25150325894355774, 'eval_runtime': 2830.6846, 'eval_samples_per_second': 183.4, 'eval_steps_per_second': 0.716, 'epoch': 1.0}
{'train_runtime': 6600.6008, 'train_samples_per_second': 34.438, 'train_steps_per_second': 2.153, 'train_loss': 0.10669462161289679, 'epoch': 1.0}
Post-processing 1406408 example predictions split into 2337225 features.
{
    "68": {
        "QA": {
            "exact_match": 91.90730215307548,
            "f1": 96.94823373082116
        },
        "PR": {
            "p@1": 0.991835653388565,
            "p@2": 0.9995363903472858,
            "p@3": 0.9998615191946438
        },
        "PRQA": {
            "exact_match": 91.19141659842975,
            "f1": 96.3917948764834
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2750738 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2750738 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
