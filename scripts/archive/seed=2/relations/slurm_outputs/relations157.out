2024-05-11 18:10:09 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 157 ---------------
2024-05-11 18:10:09 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-11 18:10:09 INFO     Contexts were splited into 555 paragraphs, which are 1.8624161073825503 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 3041.2558558558558
2024-05-11 18:10:09 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-11 18:10:09 INFO     Contexts were splited into 83 paragraphs, which are 1.9761904761904763 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2212.867469879518
2024-05-11 18:10:10 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-11 18:10:10 INFO     Contexts were splited into 163 paragraphs, which are 1.8953488372093024 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2640.116564417178
2024-05-11 18:10:47 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 18:20:44 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 20:55:38 INFO     the model is trained
2024-05-11 21:17:24 INFO     evaluation data are prepared
2024-05-12 01:41:45 INFO     QA scores: {'exact_match': 90.56825297432687, 'f1': 96.1595221396936}
2024-05-12 01:41:45 INFO     PR scores: {'p@1': 0.9993557632098646, 'p@2': 1.0, 'p@3': 1.0}
2024-05-12 01:41:55 INFO     PRQA scores: {'exact_match': 90.53634218004913, 'f1': 96.13954993907014}
{'loss': 0.6055, 'grad_norm': 38.616493225097656, 'learning_rate': 2.9257976749938168e-05, 'epoch': 0.02473410833539451}
{'loss': 0.2107, 'grad_norm': 3.4525840282440186, 'learning_rate': 2.851595349987633e-05, 'epoch': 0.04946821667078902}
{'loss': 0.1817, 'grad_norm': 3.226658582687378, 'learning_rate': 2.7773930249814496e-05, 'epoch': 0.07420232500618353}
{'loss': 0.1644, 'grad_norm': 11.868163108825684, 'learning_rate': 2.7031906999752657e-05, 'epoch': 0.09893643334157803}
{'loss': 0.1534, 'grad_norm': 7.537547588348389, 'learning_rate': 2.6289883749690824e-05, 'epoch': 0.12367054167697254}
{'loss': 0.1504, 'grad_norm': 7.9378204345703125, 'learning_rate': 2.554786049962899e-05, 'epoch': 0.14840465001236705}
{'loss': 0.1325, 'grad_norm': 0.05716251581907272, 'learning_rate': 2.4805837249567152e-05, 'epoch': 0.17313875834776157}
{'loss': 0.1252, 'grad_norm': 0.03472472354769707, 'learning_rate': 2.406381399950532e-05, 'epoch': 0.19787286668315607}
{'loss': 0.1176, 'grad_norm': 5.480046272277832, 'learning_rate': 2.3321790749443483e-05, 'epoch': 0.2226069750185506}
{'loss': 0.1182, 'grad_norm': 17.36701774597168, 'learning_rate': 2.2579767499381647e-05, 'epoch': 0.24734108335394508}
{'loss': 0.1121, 'grad_norm': 0.14262554049491882, 'learning_rate': 2.1837744249319814e-05, 'epoch': 0.2720751916893396}
{'loss': 0.1063, 'grad_norm': 3.9449284076690674, 'learning_rate': 2.1095720999257975e-05, 'epoch': 0.2968093000247341}
{'loss': 0.0989, 'grad_norm': 0.1869007647037506, 'learning_rate': 2.0353697749196142e-05, 'epoch': 0.3215434083601286}
{'loss': 0.1009, 'grad_norm': 0.035728566348552704, 'learning_rate': 1.9611674499134306e-05, 'epoch': 0.34627751669552315}
{'loss': 0.0924, 'grad_norm': 0.0014203357277438045, 'learning_rate': 1.886965124907247e-05, 'epoch': 0.3710116250309176}
{'loss': 0.0909, 'grad_norm': 0.034639932215213776, 'learning_rate': 1.8127627999010637e-05, 'epoch': 0.39574573336631214}
{'loss': 0.0978, 'grad_norm': 0.9815608263015747, 'learning_rate': 1.73856047489488e-05, 'epoch': 0.42047984170170666}
{'loss': 0.0828, 'grad_norm': 5.639869213104248, 'learning_rate': 1.6643581498886965e-05, 'epoch': 0.4452139500371012}
{'loss': 0.0727, 'grad_norm': 5.812357425689697, 'learning_rate': 1.5901558248825133e-05, 'epoch': 0.46994805837249565}
{'loss': 0.0798, 'grad_norm': 1.3344860076904297, 'learning_rate': 1.5159534998763293e-05, 'epoch': 0.49468216670789017}
{'loss': 0.0814, 'grad_norm': 0.8431777954101562, 'learning_rate': 1.4417511748701459e-05, 'epoch': 0.5194162750432847}
{'loss': 0.0671, 'grad_norm': 1.4443179368972778, 'learning_rate': 1.3675488498639624e-05, 'epoch': 0.5441503833786792}
{'loss': 0.0735, 'grad_norm': 28.375185012817383, 'learning_rate': 1.293346524857779e-05, 'epoch': 0.5688844917140737}
{'loss': 0.0688, 'grad_norm': 0.08609410375356674, 'learning_rate': 1.2191441998515954e-05, 'epoch': 0.5936186000494682}
{'loss': 0.0666, 'grad_norm': 0.042361851781606674, 'learning_rate': 1.1449418748454118e-05, 'epoch': 0.6183527083848627}
{'loss': 0.0685, 'grad_norm': 22.79182243347168, 'learning_rate': 1.0707395498392284e-05, 'epoch': 0.6430868167202572}
{'loss': 0.0639, 'grad_norm': 8.404457092285156, 'learning_rate': 9.965372248330447e-06, 'epoch': 0.6678209250556517}
{'loss': 0.0633, 'grad_norm': 0.009205160662531853, 'learning_rate': 9.223348998268613e-06, 'epoch': 0.6925550333910463}
{'loss': 0.0584, 'grad_norm': 23.43940544128418, 'learning_rate': 8.481325748206777e-06, 'epoch': 0.7172891417264408}
{'loss': 0.0562, 'grad_norm': 0.45537811517715454, 'learning_rate': 7.739302498144941e-06, 'epoch': 0.7420232500618352}
{'loss': 0.0501, 'grad_norm': 0.0969509482383728, 'learning_rate': 6.997279248083107e-06, 'epoch': 0.7667573583972298}
{'loss': 0.0565, 'grad_norm': 0.013686570338904858, 'learning_rate': 6.2552559980212714e-06, 'epoch': 0.7914914667326243}
{'loss': 0.0654, 'grad_norm': 0.0141028743237257, 'learning_rate': 5.513232747959436e-06, 'epoch': 0.8162255750680188}
{'loss': 0.0479, 'grad_norm': 0.22173631191253662, 'learning_rate': 4.771209497897601e-06, 'epoch': 0.8409596834034133}
{'loss': 0.0492, 'grad_norm': 2.0987865924835205, 'learning_rate': 4.029186247835766e-06, 'epoch': 0.8656937917388078}
{'loss': 0.0462, 'grad_norm': 0.32503774762153625, 'learning_rate': 3.2871629977739306e-06, 'epoch': 0.8904279000742024}
{'loss': 0.0494, 'grad_norm': 0.005597601179033518, 'learning_rate': 2.5451397477120954e-06, 'epoch': 0.9151620084095968}
{'loss': 0.051, 'grad_norm': 0.0032918285578489304, 'learning_rate': 1.8031164976502597e-06, 'epoch': 0.9398961167449913}
{'loss': 0.0498, 'grad_norm': 0.012340445071458817, 'learning_rate': 1.0610932475884245e-06, 'epoch': 0.9646302250803859}
{'loss': 0.0492, 'grad_norm': 0.5525123476982117, 'learning_rate': 3.1906999752658916e-07, 'epoch': 0.9893643334157803}
{'eval_loss': 0.22735780477523804, 'eval_runtime': 3809.7817, 'eval_samples_per_second': 178.49, 'eval_steps_per_second': 0.697, 'epoch': 1.0}
{'train_runtime': 9292.8055, 'train_samples_per_second': 34.805, 'train_steps_per_second': 2.175, 'train_loss': 0.10128814500067572, 'epoch': 1.0}
Post-processing 331289 example predictions split into 1566337 features.
{
    "157": {
        "QA": {
            "exact_match": 90.56825297432687,
            "f1": 96.1595221396936
        },
        "PR": {
            "p@1": 0.9993557632098646,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 90.53634218004913,
            "f1": 96.13954993907014
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2670826 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2670826 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
