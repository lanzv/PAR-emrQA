2024-05-11 18:12:36 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 190 ---------------
2024-05-11 18:12:36 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-11 18:12:36 INFO     Contexts were splited into 495 paragraphs, which are 1.6610738255033557 paragraphs on average per one report. There are 1 unique topics with frequency threshold (greater or equal) 190. The overall paragraph average length (characters) is 3409.8929292929292
2024-05-11 18:12:36 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-11 18:12:36 INFO     Contexts were splited into 69 paragraphs, which are 1.6428571428571428 paragraphs on average per one report. There are 1 unique topics with frequency threshold (greater or equal) 190. The overall paragraph average length (characters) is 2661.855072463768
2024-05-11 18:12:37 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-11 18:12:37 INFO     Contexts were splited into 141 paragraphs, which are 1.6395348837209303 paragraphs on average per one report. There are 1 unique topics with frequency threshold (greater or equal) 190. The overall paragraph average length (characters) is 3052.049645390071
2024-05-11 18:13:16 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 18:23:12 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 20:55:36 INFO     the model is trained
2024-05-11 21:17:14 INFO     evaluation data are prepared
2024-05-12 01:33:05 INFO     QA scores: {'exact_match': 90.7139588651799, 'f1': 96.17885213872336}
2024-05-12 01:33:06 INFO     PR scores: {'p@1': 0.9999939790954193, 'p@2': 1.0, 'p@3': 1.0}
2024-05-12 01:33:15 INFO     PRQA scores: {'exact_match': 90.71335677472183, 'f1': 96.17825004826528}
{'loss': 0.5749, 'grad_norm': 5.154345512390137, 'learning_rate': 2.925771971496437e-05, 'epoch': 0.024742676167854315}
{'loss': 0.2125, 'grad_norm': 27.427223205566406, 'learning_rate': 2.851543942992874e-05, 'epoch': 0.04948535233570863}
{'loss': 0.1814, 'grad_norm': 2.022223711013794, 'learning_rate': 2.7773159144893112e-05, 'epoch': 0.07422802850356294}
{'loss': 0.1563, 'grad_norm': 0.9961909055709839, 'learning_rate': 2.7030878859857486e-05, 'epoch': 0.09897070467141726}
{'loss': 0.1429, 'grad_norm': 7.016764163970947, 'learning_rate': 2.6288598574821856e-05, 'epoch': 0.12371338083927158}
{'loss': 0.1464, 'grad_norm': 14.377158164978027, 'learning_rate': 2.5546318289786223e-05, 'epoch': 0.14845605700712589}
{'loss': 0.1316, 'grad_norm': 2.7192413806915283, 'learning_rate': 2.4804038004750593e-05, 'epoch': 0.17319873317498022}
{'loss': 0.1204, 'grad_norm': 0.6638652682304382, 'learning_rate': 2.4061757719714964e-05, 'epoch': 0.19794140934283452}
{'loss': 0.1206, 'grad_norm': 9.22978687286377, 'learning_rate': 2.3319477434679334e-05, 'epoch': 0.22268408551068883}
{'loss': 0.1161, 'grad_norm': 3.752584218978882, 'learning_rate': 2.2577197149643705e-05, 'epoch': 0.24742676167854316}
{'loss': 0.1071, 'grad_norm': 14.355792045593262, 'learning_rate': 2.1834916864608075e-05, 'epoch': 0.27216943784639747}
{'loss': 0.0985, 'grad_norm': 68.97038269042969, 'learning_rate': 2.109263657957245e-05, 'epoch': 0.29691211401425177}
{'loss': 0.1089, 'grad_norm': 1.0458662509918213, 'learning_rate': 2.035035629453682e-05, 'epoch': 0.3216547901821061}
{'loss': 0.1022, 'grad_norm': 0.2708818018436432, 'learning_rate': 1.960807600950119e-05, 'epoch': 0.34639746634996044}
{'loss': 0.0893, 'grad_norm': 0.11578751355409622, 'learning_rate': 1.886579572446556e-05, 'epoch': 0.37114014251781474}
{'loss': 0.0922, 'grad_norm': 0.4104306697845459, 'learning_rate': 1.812351543942993e-05, 'epoch': 0.39588281868566905}
{'loss': 0.0916, 'grad_norm': 7.3215789794921875, 'learning_rate': 1.7381235154394297e-05, 'epoch': 0.42062549485352335}
{'loss': 0.0839, 'grad_norm': 12.824233055114746, 'learning_rate': 1.6638954869358668e-05, 'epoch': 0.44536817102137766}
{'loss': 0.0806, 'grad_norm': 0.4652242958545685, 'learning_rate': 1.589667458432304e-05, 'epoch': 0.47011084718923196}
{'loss': 0.0748, 'grad_norm': 7.384507179260254, 'learning_rate': 1.515439429928741e-05, 'epoch': 0.4948535233570863}
{'loss': 0.0869, 'grad_norm': 1.445586085319519, 'learning_rate': 1.4412114014251782e-05, 'epoch': 0.5195961995249406}
{'loss': 0.0688, 'grad_norm': 10.668899536132812, 'learning_rate': 1.3669833729216152e-05, 'epoch': 0.5443388756927949}
{'loss': 0.0734, 'grad_norm': 0.5266777873039246, 'learning_rate': 1.2927553444180523e-05, 'epoch': 0.5690815518606492}
{'loss': 0.0671, 'grad_norm': 0.16571177542209625, 'learning_rate': 1.2185273159144893e-05, 'epoch': 0.5938242280285035}
{'loss': 0.061, 'grad_norm': 0.17508672177791595, 'learning_rate': 1.1442992874109264e-05, 'epoch': 0.6185669041963578}
{'loss': 0.0596, 'grad_norm': 0.2423277050256729, 'learning_rate': 1.0700712589073634e-05, 'epoch': 0.6433095803642122}
{'loss': 0.0617, 'grad_norm': 0.14362363517284393, 'learning_rate': 9.958432304038004e-06, 'epoch': 0.6680522565320665}
{'loss': 0.0567, 'grad_norm': 2.528561592102051, 'learning_rate': 9.216152019002376e-06, 'epoch': 0.6927949326999209}
{'loss': 0.0587, 'grad_norm': 0.03782033920288086, 'learning_rate': 8.473871733966747e-06, 'epoch': 0.7175376088677752}
{'loss': 0.0558, 'grad_norm': 0.8705199360847473, 'learning_rate': 7.731591448931117e-06, 'epoch': 0.7422802850356295}
{'loss': 0.0549, 'grad_norm': 0.0986534059047699, 'learning_rate': 6.9893111638954876e-06, 'epoch': 0.7670229612034838}
{'loss': 0.0563, 'grad_norm': 9.296087265014648, 'learning_rate': 6.247030878859857e-06, 'epoch': 0.7917656373713381}
{'loss': 0.0528, 'grad_norm': 0.1534067541360855, 'learning_rate': 5.504750593824228e-06, 'epoch': 0.8165083135391924}
{'loss': 0.0576, 'grad_norm': 10.531737327575684, 'learning_rate': 4.762470308788599e-06, 'epoch': 0.8412509897070467}
{'loss': 0.0452, 'grad_norm': 4.2216057777404785, 'learning_rate': 4.020190023752969e-06, 'epoch': 0.865993665874901}
{'loss': 0.0475, 'grad_norm': 18.843250274658203, 'learning_rate': 3.27790973871734e-06, 'epoch': 0.8907363420427553}
{'loss': 0.052, 'grad_norm': 4.060340881347656, 'learning_rate': 2.5356294536817103e-06, 'epoch': 0.9154790182106096}
{'loss': 0.0467, 'grad_norm': 3.49592661857605, 'learning_rate': 1.7933491686460808e-06, 'epoch': 0.9402216943784639}
{'loss': 0.0482, 'grad_norm': 0.5139545798301697, 'learning_rate': 1.0510688836104512e-06, 'epoch': 0.9649643705463183}
{'loss': 0.0418, 'grad_norm': 0.2646811306476593, 'learning_rate': 3.0878859857482186e-07, 'epoch': 0.9897070467141726}
{'eval_loss': 0.21689337491989136, 'eval_runtime': 3741.5695, 'eval_samples_per_second': 181.489, 'eval_steps_per_second': 0.709, 'epoch': 1.0}
{'train_runtime': 9143.929, 'train_samples_per_second': 35.359, 'train_steps_per_second': 2.21, 'train_loss': 0.09911437711353256, 'epoch': 1.0}
Post-processing 290387 example predictions split into 1526112 features.
{
    "190": {
        "QA": {
            "exact_match": 90.7139588651799,
            "f1": 96.17885213872336
        },
        "PR": {
            "p@1": 0.9999939790954193,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 90.71335677472183,
            "f1": 96.17825004826528
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 3212152 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 3212152 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
