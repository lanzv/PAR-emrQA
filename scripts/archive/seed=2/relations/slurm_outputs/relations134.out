2024-05-11 17:50:01 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 134 ---------------
2024-05-11 17:50:01 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-11 17:50:02 INFO     Contexts were splited into 1585 paragraphs, which are 5.318791946308725 paragraphs on average per one report. There are 9 unique topics with frequency threshold (greater or equal) 134. The overall paragraph average length (characters) is 1064.9192429022082
2024-05-11 17:50:02 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-11 17:50:02 INFO     Contexts were splited into 204 paragraphs, which are 4.857142857142857 paragraphs on average per one report. There are 9 unique topics with frequency threshold (greater or equal) 134. The overall paragraph average length (characters) is 900.3333333333334
2024-05-11 17:50:03 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-11 17:50:03 INFO     Contexts were splited into 428 paragraphs, which are 4.976744186046512 paragraphs on average per one report. There are 9 unique topics with frequency threshold (greater or equal) 134. The overall paragraph average length (characters) is 1005.4649532710281
2024-05-11 17:50:41 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 17:58:57 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 20:04:48 INFO     the model is trained
2024-05-11 20:30:50 INFO     evaluation data are prepared
2024-05-12 01:59:57 INFO     QA scores: {'exact_match': 91.11615529117094, 'f1': 96.69978523317351}
2024-05-12 01:59:57 INFO     PR scores: {'p@1': 0.994057367178845, 'p@2': 0.9998133519579981, 'p@3': 0.9998675400992245}
2024-05-12 02:00:07 INFO     PRQA scores: {'exact_match': 90.59233659264967, 'f1': 96.2631359208646}
{'loss': 0.5783, 'grad_norm': 5.75731086730957, 'learning_rate': 2.9075899457861015e-05, 'epoch': 0.030803351404632823}
{'loss': 0.219, 'grad_norm': 2.1520156860351562, 'learning_rate': 2.8151798915722032e-05, 'epoch': 0.06160670280926565}
{'loss': 0.1716, 'grad_norm': 13.643427848815918, 'learning_rate': 2.7227698373583046e-05, 'epoch': 0.09241005421389847}
{'loss': 0.1537, 'grad_norm': 1.4045970439910889, 'learning_rate': 2.630359783144406e-05, 'epoch': 0.1232134056185313}
{'loss': 0.1541, 'grad_norm': 12.260334014892578, 'learning_rate': 2.5379497289305077e-05, 'epoch': 0.1540167570231641}
{'loss': 0.1408, 'grad_norm': 3.80191707611084, 'learning_rate': 2.445539674716609e-05, 'epoch': 0.18482010842779695}
{'loss': 0.1253, 'grad_norm': 7.151381969451904, 'learning_rate': 2.3531296205027105e-05, 'epoch': 0.21562345983242978}
{'loss': 0.1257, 'grad_norm': 0.8217319846153259, 'learning_rate': 2.2607195662888122e-05, 'epoch': 0.2464268112370626}
{'loss': 0.1001, 'grad_norm': 14.430807113647461, 'learning_rate': 2.1683095120749136e-05, 'epoch': 0.2772301626416954}
{'loss': 0.1001, 'grad_norm': 4.944939613342285, 'learning_rate': 2.0758994578610154e-05, 'epoch': 0.3080335140463282}
{'loss': 0.1043, 'grad_norm': 3.7978627681732178, 'learning_rate': 1.983489403647117e-05, 'epoch': 0.3388368654509611}
{'loss': 0.0909, 'grad_norm': 0.568427324295044, 'learning_rate': 1.8910793494332185e-05, 'epoch': 0.3696402168555939}
{'loss': 0.0938, 'grad_norm': 2.7642860412597656, 'learning_rate': 1.79866929521932e-05, 'epoch': 0.4004435682602267}
{'loss': 0.0684, 'grad_norm': 3.885629177093506, 'learning_rate': 1.7062592410054216e-05, 'epoch': 0.43124691966485956}
{'loss': 0.0858, 'grad_norm': 6.693974494934082, 'learning_rate': 1.613849186791523e-05, 'epoch': 0.46205027106949237}
{'loss': 0.0783, 'grad_norm': 3.73836088180542, 'learning_rate': 1.5214391325776244e-05, 'epoch': 0.4928536224741252}
{'loss': 0.084, 'grad_norm': 20.282108306884766, 'learning_rate': 1.429029078363726e-05, 'epoch': 0.523656973878758}
{'loss': 0.069, 'grad_norm': 0.0084043825045228, 'learning_rate': 1.3366190241498275e-05, 'epoch': 0.5544603252833908}
{'loss': 0.0639, 'grad_norm': 0.01647285930812359, 'learning_rate': 1.2442089699359291e-05, 'epoch': 0.5852636766880237}
{'loss': 0.0709, 'grad_norm': 1.1046662330627441, 'learning_rate': 1.1517989157220307e-05, 'epoch': 0.6160670280926565}
{'loss': 0.0613, 'grad_norm': 0.02174556255340576, 'learning_rate': 1.059388861508132e-05, 'epoch': 0.6468703794972893}
{'loss': 0.0636, 'grad_norm': 0.010239968076348305, 'learning_rate': 9.669788072942336e-06, 'epoch': 0.6776737309019222}
{'loss': 0.0553, 'grad_norm': 0.04166746512055397, 'learning_rate': 8.745687530803352e-06, 'epoch': 0.7084770823065549}
{'loss': 0.0702, 'grad_norm': 0.005979264620691538, 'learning_rate': 7.821586988664366e-06, 'epoch': 0.7392804337111878}
{'loss': 0.0565, 'grad_norm': 0.38516703248023987, 'learning_rate': 6.897486446525382e-06, 'epoch': 0.7700837851158207}
{'loss': 0.0464, 'grad_norm': 0.9645974040031433, 'learning_rate': 5.973385904386397e-06, 'epoch': 0.8008871365204534}
{'loss': 0.0461, 'grad_norm': 0.10538363456726074, 'learning_rate': 5.049285362247413e-06, 'epoch': 0.8316904879250863}
{'loss': 0.039, 'grad_norm': 0.250394731760025, 'learning_rate': 4.125184820108428e-06, 'epoch': 0.8624938393297191}
{'loss': 0.0409, 'grad_norm': 0.27837735414505005, 'learning_rate': 3.201084277969443e-06, 'epoch': 0.8932971907343519}
{'loss': 0.055, 'grad_norm': 1.215970754623413, 'learning_rate': 2.276983735830458e-06, 'epoch': 0.9241005421389847}
{'loss': 0.0476, 'grad_norm': 0.008577145636081696, 'learning_rate': 1.3528831936914738e-06, 'epoch': 0.9549038935436176}
{'loss': 0.0508, 'grad_norm': 0.5753083825111389, 'learning_rate': 4.2878265155248887e-07, 'epoch': 0.9857072449482503}
{'eval_loss': 0.24343520402908325, 'eval_runtime': 3184.763, 'eval_samples_per_second': 179.343, 'eval_steps_per_second': 0.701, 'epoch': 1.0}
{'train_runtime': 7550.3696, 'train_samples_per_second': 34.396, 'train_steps_per_second': 2.15, 'train_loss': 0.10264229533588903, 'epoch': 1.0}
Post-processing 897369 example predictions split into 1972030 features.
{
    "134": {
        "QA": {
            "exact_match": 91.11615529117094,
            "f1": 96.69978523317351
        },
        "PR": {
            "p@1": 0.994057367178845,
            "p@2": 0.9998133519579981,
            "p@3": 0.9998675400992245
        },
        "PRQA": {
            "exact_match": 90.59233659264967,
            "f1": 96.2631359208646
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2750800 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2750800 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
