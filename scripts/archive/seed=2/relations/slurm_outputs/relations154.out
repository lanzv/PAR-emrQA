2024-05-11 18:06:08 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 154 ---------------
2024-05-11 18:06:08 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-11 18:06:09 INFO     Contexts were splited into 711 paragraphs, which are 2.3859060402684564 paragraphs on average per one report. There are 3 unique topics with frequency threshold (greater or equal) 154. The overall paragraph average length (characters) is 2373.9760900140645
2024-05-11 18:06:09 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-11 18:06:09 INFO     Contexts were splited into 110 paragraphs, which are 2.619047619047619 paragraphs on average per one report. There are 3 unique topics with frequency threshold (greater or equal) 154. The overall paragraph average length (characters) is 1669.709090909091
2024-05-11 18:06:09 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-11 18:06:09 INFO     Contexts were splited into 214 paragraphs, which are 2.488372093023256 paragraphs on average per one report. There are 3 unique topics with frequency threshold (greater or equal) 154. The overall paragraph average length (characters) is 2010.9299065420562
2024-05-11 18:06:48 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 18:17:07 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 20:54:13 INFO     the model is trained
2024-05-11 21:17:17 INFO     evaluation data are prepared
2024-05-12 01:54:07 INFO     QA scores: {'exact_match': 91.04691488849285, 'f1': 96.35233979754656}
2024-05-12 01:54:08 INFO     PR scores: {'p@1': 0.9994641394923173, 'p@2': 1.0, 'p@3': 1.0}
2024-05-12 01:54:18 INFO     PRQA scores: {'exact_match': 91.00416646596985, 'f1': 96.32973948050636}
{'loss': 0.5929, 'grad_norm': 11.555922508239746, 'learning_rate': 2.9271738602709133e-05, 'epoch': 0.024275379909695586}
{'loss': 0.209, 'grad_norm': 6.806641578674316, 'learning_rate': 2.8543477205418265e-05, 'epoch': 0.04855075981939117}
{'loss': 0.1763, 'grad_norm': 0.7439373731613159, 'learning_rate': 2.7815215808127398e-05, 'epoch': 0.07282613972908676}
{'loss': 0.1499, 'grad_norm': 8.036803245544434, 'learning_rate': 2.708695441083653e-05, 'epoch': 0.09710151963878234}
{'loss': 0.1537, 'grad_norm': 1.110216498374939, 'learning_rate': 2.6358693013545663e-05, 'epoch': 0.12137689954847794}
{'loss': 0.1428, 'grad_norm': 11.433863639831543, 'learning_rate': 2.5630431616254795e-05, 'epoch': 0.14565227945817352}
{'loss': 0.1207, 'grad_norm': 14.925586700439453, 'learning_rate': 2.4902170218963927e-05, 'epoch': 0.1699276593678691}
{'loss': 0.122, 'grad_norm': 3.5269038677215576, 'learning_rate': 2.417390882167306e-05, 'epoch': 0.1942030392775647}
{'loss': 0.1077, 'grad_norm': 0.14265546202659607, 'learning_rate': 2.3445647424382192e-05, 'epoch': 0.21847841918726027}
{'loss': 0.1032, 'grad_norm': 0.35667717456817627, 'learning_rate': 2.2717386027091324e-05, 'epoch': 0.24275379909695588}
{'loss': 0.112, 'grad_norm': 1.9045145511627197, 'learning_rate': 2.1989124629800457e-05, 'epoch': 0.26702917900665146}
{'loss': 0.0993, 'grad_norm': 8.63609504699707, 'learning_rate': 2.1260863232509592e-05, 'epoch': 0.29130455891634705}
{'loss': 0.0896, 'grad_norm': 0.021136220544576645, 'learning_rate': 2.053260183521872e-05, 'epoch': 0.3155799388260426}
{'loss': 0.1021, 'grad_norm': 0.10162940621376038, 'learning_rate': 1.9804340437927854e-05, 'epoch': 0.3398553187357382}
{'loss': 0.0949, 'grad_norm': 1.2659189701080322, 'learning_rate': 1.9076079040636986e-05, 'epoch': 0.3641306986454338}
{'loss': 0.0921, 'grad_norm': 2.3154513835906982, 'learning_rate': 1.834781764334612e-05, 'epoch': 0.3884060785551294}
{'loss': 0.0852, 'grad_norm': 11.391530990600586, 'learning_rate': 1.761955624605525e-05, 'epoch': 0.41268145846482496}
{'loss': 0.0721, 'grad_norm': 3.617136240005493, 'learning_rate': 1.6891294848764383e-05, 'epoch': 0.43695683837452054}
{'loss': 0.08, 'grad_norm': 0.2007809281349182, 'learning_rate': 1.6163033451473516e-05, 'epoch': 0.4612322182842161}
{'loss': 0.0788, 'grad_norm': 2.6793057918548584, 'learning_rate': 1.5434772054182648e-05, 'epoch': 0.48550759819391176}
{'loss': 0.0719, 'grad_norm': 0.013054516166448593, 'learning_rate': 1.470651065689178e-05, 'epoch': 0.5097829781036073}
{'loss': 0.0783, 'grad_norm': 1.2879235744476318, 'learning_rate': 1.3978249259600913e-05, 'epoch': 0.5340583580133029}
{'loss': 0.0664, 'grad_norm': 0.010763853788375854, 'learning_rate': 1.3249987862310045e-05, 'epoch': 0.5583337379229985}
{'loss': 0.0658, 'grad_norm': 0.09695594757795334, 'learning_rate': 1.2521726465019177e-05, 'epoch': 0.5826091178326941}
{'loss': 0.0619, 'grad_norm': 16.977235794067383, 'learning_rate': 1.179346506772831e-05, 'epoch': 0.6068844977423896}
{'loss': 0.0534, 'grad_norm': 0.08005253225564957, 'learning_rate': 1.1065203670437442e-05, 'epoch': 0.6311598776520853}
{'loss': 0.0564, 'grad_norm': 0.024448666721582413, 'learning_rate': 1.0336942273146574e-05, 'epoch': 0.6554352575617809}
{'loss': 0.0605, 'grad_norm': 0.16955125331878662, 'learning_rate': 9.608680875855708e-06, 'epoch': 0.6797106374714764}
{'loss': 0.0626, 'grad_norm': 0.009495810605585575, 'learning_rate': 8.88041947856484e-06, 'epoch': 0.7039860173811721}
{'loss': 0.0581, 'grad_norm': 0.021710606291890144, 'learning_rate': 8.152158081273973e-06, 'epoch': 0.7282613972908676}
{'loss': 0.0621, 'grad_norm': 8.700282096862793, 'learning_rate': 7.423896683983105e-06, 'epoch': 0.7525367772005632}
{'loss': 0.0555, 'grad_norm': 0.7173750400543213, 'learning_rate': 6.695635286692237e-06, 'epoch': 0.7768121571102587}
{'loss': 0.0493, 'grad_norm': 0.021287500858306885, 'learning_rate': 5.967373889401369e-06, 'epoch': 0.8010875370199544}
{'loss': 0.0531, 'grad_norm': 0.1612989455461502, 'learning_rate': 5.239112492110502e-06, 'epoch': 0.8253629169296499}
{'loss': 0.0535, 'grad_norm': 2.8339412212371826, 'learning_rate': 4.510851094819634e-06, 'epoch': 0.8496382968393456}
{'loss': 0.052, 'grad_norm': 0.4807390868663788, 'learning_rate': 3.782589697528766e-06, 'epoch': 0.8739136767490411}
{'loss': 0.0526, 'grad_norm': 0.10102842003107071, 'learning_rate': 3.054328300237899e-06, 'epoch': 0.8981890566587367}
{'loss': 0.0429, 'grad_norm': 5.152619361877441, 'learning_rate': 2.326066902947031e-06, 'epoch': 0.9224644365684322}
{'loss': 0.0451, 'grad_norm': 0.003951658494770527, 'learning_rate': 1.5978055056561635e-06, 'epoch': 0.9467398164781279}
{'loss': 0.0415, 'grad_norm': 0.00813940167427063, 'learning_rate': 8.69544108365296e-07, 'epoch': 0.9710151963878235}
{'loss': 0.0433, 'grad_norm': 0.009494143538177013, 'learning_rate': 1.4128271107442833e-07, 'epoch': 0.995290576297519}
{'eval_loss': 0.2147589474916458, 'eval_runtime': 3860.7935, 'eval_samples_per_second': 179.66, 'eval_steps_per_second': 0.702, 'epoch': 1.0}
{'train_runtime': 9424.2104, 'train_samples_per_second': 34.968, 'train_steps_per_second': 2.186, 'train_loss': 0.09663796152843748, 'epoch': 1.0}
Post-processing 411873 example predictions split into 1640743 features.
{
    "154": {
        "QA": {
            "exact_match": 91.04691488849285,
            "f1": 96.35233979754656
        },
        "PR": {
            "p@1": 0.9994641394923173,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 91.00416646596985,
            "f1": 96.32973948050636
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2670767 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2670767 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
