2024-05-11 18:11:38 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 149 ---------------
2024-05-11 18:11:38 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-11 18:11:39 INFO     Contexts were splited into 864 paragraphs, which are 2.8993288590604025 paragraphs on average per one report. There are 4 unique topics with frequency threshold (greater or equal) 149. The overall paragraph average length (characters) is 1953.5844907407406
2024-05-11 18:11:39 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-11 18:11:39 INFO     Contexts were splited into 127 paragraphs, which are 3.0238095238095237 paragraphs on average per one report. There are 4 unique topics with frequency threshold (greater or equal) 149. The overall paragraph average length (characters) is 1446.2047244094488
2024-05-11 18:11:40 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-11 18:11:40 INFO     Contexts were splited into 252 paragraphs, which are 2.9302325581395348 paragraphs on average per one report. There are 4 unique topics with frequency threshold (greater or equal) 149. The overall paragraph average length (characters) is 1707.6944444444443
2024-05-11 18:12:18 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 18:22:26 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 20:58:48 INFO     the model is trained
2024-05-11 21:22:31 INFO     evaluation data are prepared
2024-05-12 02:07:38 INFO     QA scores: {'exact_match': 90.60136794952074, 'f1': 96.28757352947429}
2024-05-12 02:07:38 INFO     PR scores: {'p@1': 0.9977903280188816, 'p@2': 0.9999217282404509, 'p@3': 1.0}
2024-05-12 02:07:48 INFO     PRQA scores: {'exact_match': 90.4147199075189, 'f1': 96.13997315141366}
{'loss': 0.6349, 'grad_norm': 3.7045376300811768, 'learning_rate': 2.926133845472005e-05, 'epoch': 0.024622051509331756}
{'loss': 0.2143, 'grad_norm': 5.17973518371582, 'learning_rate': 2.8522676909440093e-05, 'epoch': 0.04924410301866351}
{'loss': 0.1682, 'grad_norm': 11.479318618774414, 'learning_rate': 2.7784015364160143e-05, 'epoch': 0.07386615452799528}
{'loss': 0.1712, 'grad_norm': 0.2050224393606186, 'learning_rate': 2.704535381888019e-05, 'epoch': 0.09848820603732703}
{'loss': 0.1415, 'grad_norm': 0.04178773611783981, 'learning_rate': 2.6306692273600236e-05, 'epoch': 0.12311025754665879}
{'loss': 0.1304, 'grad_norm': 7.905363082885742, 'learning_rate': 2.5568030728320286e-05, 'epoch': 0.14773230905599055}
{'loss': 0.1191, 'grad_norm': 11.225419044494629, 'learning_rate': 2.4829369183040332e-05, 'epoch': 0.1723543605653223}
{'loss': 0.1294, 'grad_norm': 2.075756788253784, 'learning_rate': 2.4090707637760378e-05, 'epoch': 0.19697641207465405}
{'loss': 0.1152, 'grad_norm': 8.913015365600586, 'learning_rate': 2.3352046092480424e-05, 'epoch': 0.22159846358398583}
{'loss': 0.1153, 'grad_norm': 4.302719593048096, 'learning_rate': 2.2613384547200474e-05, 'epoch': 0.24622051509331758}
{'loss': 0.0979, 'grad_norm': 25.32758140563965, 'learning_rate': 2.187472300192052e-05, 'epoch': 0.2708425666026493}
{'loss': 0.0971, 'grad_norm': 12.38744831085205, 'learning_rate': 2.1136061456640567e-05, 'epoch': 0.2954646181119811}
{'loss': 0.1011, 'grad_norm': 2.3721532821655273, 'learning_rate': 2.0397399911360617e-05, 'epoch': 0.3200866696213128}
{'loss': 0.0977, 'grad_norm': 0.40388867259025574, 'learning_rate': 1.965873836608066e-05, 'epoch': 0.3447087211306446}
{'loss': 0.097, 'grad_norm': 0.13824544847011566, 'learning_rate': 1.892007682080071e-05, 'epoch': 0.3693307726399764}
{'loss': 0.0761, 'grad_norm': 0.19312359392642975, 'learning_rate': 1.818141527552076e-05, 'epoch': 0.3939528241493081}
{'loss': 0.0898, 'grad_norm': 0.03303205966949463, 'learning_rate': 1.7442753730240802e-05, 'epoch': 0.4185748756586399}
{'loss': 0.0773, 'grad_norm': 0.03362463414669037, 'learning_rate': 1.670409218496085e-05, 'epoch': 0.44319692716797165}
{'loss': 0.073, 'grad_norm': 0.006168154999613762, 'learning_rate': 1.5965430639680898e-05, 'epoch': 0.4678189786773034}
{'loss': 0.0801, 'grad_norm': 0.07591873407363892, 'learning_rate': 1.5226769094400948e-05, 'epoch': 0.49244103018663515}
{'loss': 0.0796, 'grad_norm': 8.075935363769531, 'learning_rate': 1.4488107549120992e-05, 'epoch': 0.5170630816959669}
{'loss': 0.0729, 'grad_norm': 5.181416034698486, 'learning_rate': 1.374944600384104e-05, 'epoch': 0.5416851332052987}
{'loss': 0.0747, 'grad_norm': 11.529160499572754, 'learning_rate': 1.3010784458561087e-05, 'epoch': 0.5663071847146304}
{'loss': 0.0687, 'grad_norm': 6.329803943634033, 'learning_rate': 1.2272122913281135e-05, 'epoch': 0.5909292362239622}
{'loss': 0.0668, 'grad_norm': 0.11634254455566406, 'learning_rate': 1.1533461368001183e-05, 'epoch': 0.6155512877332939}
{'loss': 0.0614, 'grad_norm': 5.87436580657959, 'learning_rate': 1.0794799822721229e-05, 'epoch': 0.6401733392426256}
{'loss': 0.0588, 'grad_norm': 0.12040302902460098, 'learning_rate': 1.0056138277441277e-05, 'epoch': 0.6647953907519575}
{'loss': 0.0601, 'grad_norm': 0.08271428942680359, 'learning_rate': 9.317476732161323e-06, 'epoch': 0.6894174422612892}
{'loss': 0.0543, 'grad_norm': 1.0887913703918457, 'learning_rate': 8.578815186881371e-06, 'epoch': 0.7140394937706209}
{'loss': 0.0502, 'grad_norm': 2.2609260082244873, 'learning_rate': 7.84015364160142e-06, 'epoch': 0.7386615452799528}
{'loss': 0.0661, 'grad_norm': 4.873466491699219, 'learning_rate': 7.101492096321466e-06, 'epoch': 0.7632835967892845}
{'loss': 0.061, 'grad_norm': 0.016927579417824745, 'learning_rate': 6.362830551041513e-06, 'epoch': 0.7879056482986162}
{'loss': 0.0533, 'grad_norm': 0.03761826455593109, 'learning_rate': 5.62416900576156e-06, 'epoch': 0.812527699807948}
{'loss': 0.0438, 'grad_norm': 8.609020233154297, 'learning_rate': 4.885507460481607e-06, 'epoch': 0.8371497513172798}
{'loss': 0.0398, 'grad_norm': 9.400383949279785, 'learning_rate': 4.146845915201655e-06, 'epoch': 0.8617718028266115}
{'loss': 0.0504, 'grad_norm': 0.6026231646537781, 'learning_rate': 3.408184369921702e-06, 'epoch': 0.8863938543359433}
{'loss': 0.0433, 'grad_norm': 0.06741680949926376, 'learning_rate': 2.6695228246417492e-06, 'epoch': 0.911015905845275}
{'loss': 0.0432, 'grad_norm': 0.12219643592834473, 'learning_rate': 1.930861279361797e-06, 'epoch': 0.9356379573546068}
{'loss': 0.0502, 'grad_norm': 0.001459672348573804, 'learning_rate': 1.1921997340818438e-06, 'epoch': 0.9602600088639386}
{'loss': 0.0394, 'grad_norm': 12.443000793457031, 'learning_rate': 4.5353818880189103e-07, 'epoch': 0.9848820603732703}
{'eval_loss': 0.20851996541023254, 'eval_runtime': 3861.6569, 'eval_samples_per_second': 178.327, 'eval_steps_per_second': 0.697, 'epoch': 1.0}
{'train_runtime': 9381.6516, 'train_samples_per_second': 34.632, 'train_steps_per_second': 2.165, 'train_loss': 0.09821319866551426, 'epoch': 1.0}
Post-processing 492433 example predictions split into 1697764 features.
{
    "149": {
        "QA": {
            "exact_match": 90.60136794952074,
            "f1": 96.28757352947429
        },
        "PR": {
            "p@1": 0.9977903280188816,
            "p@2": 0.9999217282404509,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 90.4147199075189,
            "f1": 96.13997315141366
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 3669044 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 3669044 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
