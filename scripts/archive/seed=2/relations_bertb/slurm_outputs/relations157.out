2024-05-12 01:54:33 INFO     ------------- Experiment: model BERTbase, frequency threshold 157 ---------------
2024-05-12 01:54:33 INFO     Contexts were splited into 19795 sentence groups, which are 66.4261744966443 groups on average per one report
2024-05-12 01:54:33 INFO     Contexts were splited into 555 paragraphs, which are 1.8624161073825503 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 3041.2558558558558
2024-05-12 01:54:33 INFO     Contexts were splited into 2264 sentence groups, which are 53.904761904761905 groups on average per one report
2024-05-12 01:54:33 INFO     Contexts were splited into 83 paragraphs, which are 1.9761904761904763 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2212.867469879518
2024-05-12 01:54:34 INFO     Contexts were splited into 4992 sentence groups, which are 58.04651162790697 groups on average per one report
2024-05-12 01:54:34 INFO     Contexts were splited into 163 paragraphs, which are 1.8953488372093024 paragraphs on average per one report. There are 2 unique topics with frequency threshold (greater or equal) 157. The overall paragraph average length (characters) is 2640.116564417178
2024-05-12 01:55:12 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/bert-base-cased and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-12 02:05:03 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-12 04:48:43 INFO     the model is trained
2024-05-12 05:11:01 INFO     evaluation data are prepared
2024-05-12 09:50:48 INFO     QA scores: {'exact_match': 89.04014739174414, 'f1': 94.92784601667408}
2024-05-12 09:50:48 INFO     PR scores: {'p@1': 0.9971220076104234, 'p@2': 1.0, 'p@3': 1.0}
2024-05-12 09:50:58 INFO     PRQA scores: {'exact_match': 88.8089446558451, 'f1': 94.70339525039905}
{'loss': 0.552, 'grad_norm': 27.449480056762695, 'learning_rate': 2.9300471016182438e-05, 'epoch': 0.023317632793918762}
{'loss': 0.2699, 'grad_norm': 10.321043968200684, 'learning_rate': 2.8600942032364876e-05, 'epoch': 0.046635265587837524}
{'loss': 0.2234, 'grad_norm': 0.6793268918991089, 'learning_rate': 2.790141304854731e-05, 'epoch': 0.06995289838175628}
{'loss': 0.2151, 'grad_norm': 4.366722106933594, 'learning_rate': 2.7201884064729747e-05, 'epoch': 0.09327053117567505}
{'loss': 0.2097, 'grad_norm': 0.10812927037477493, 'learning_rate': 2.6502355080912188e-05, 'epoch': 0.1165881639695938}
{'loss': 0.1928, 'grad_norm': 3.9446206092834473, 'learning_rate': 2.5802826097094625e-05, 'epoch': 0.13990579676351256}
{'loss': 0.1824, 'grad_norm': 13.669547080993652, 'learning_rate': 2.5103297113277063e-05, 'epoch': 0.16322342955743133}
{'loss': 0.1789, 'grad_norm': 4.197017669677734, 'learning_rate': 2.44037681294595e-05, 'epoch': 0.1865410623513501}
{'loss': 0.1561, 'grad_norm': 1.848639965057373, 'learning_rate': 2.3704239145641934e-05, 'epoch': 0.20985869514526886}
{'loss': 0.1474, 'grad_norm': 0.24907797574996948, 'learning_rate': 2.300471016182437e-05, 'epoch': 0.2331763279391876}
{'loss': 0.1547, 'grad_norm': 0.4375646114349365, 'learning_rate': 2.230518117800681e-05, 'epoch': 0.2564939607331064}
{'loss': 0.142, 'grad_norm': 0.4434676468372345, 'learning_rate': 2.1605652194189246e-05, 'epoch': 0.2798115935270251}
{'loss': 0.1464, 'grad_norm': 1.750143051147461, 'learning_rate': 2.0906123210371684e-05, 'epoch': 0.3031292263209439}
{'loss': 0.1269, 'grad_norm': 0.15449248254299164, 'learning_rate': 2.0206594226554118e-05, 'epoch': 0.32644685911486265}
{'loss': 0.1293, 'grad_norm': 7.436733722686768, 'learning_rate': 1.950706524273656e-05, 'epoch': 0.3497644919087814}
{'loss': 0.1222, 'grad_norm': 2.189906597137451, 'learning_rate': 1.8807536258918996e-05, 'epoch': 0.3730821247027002}
{'loss': 0.1257, 'grad_norm': 5.394893169403076, 'learning_rate': 1.8108007275101433e-05, 'epoch': 0.39639975749661893}
{'loss': 0.1123, 'grad_norm': 27.46895408630371, 'learning_rate': 1.740847829128387e-05, 'epoch': 0.41971739029053773}
{'loss': 0.1083, 'grad_norm': 0.5905452370643616, 'learning_rate': 1.6708949307466308e-05, 'epoch': 0.44303502308445647}
{'loss': 0.1191, 'grad_norm': 0.18989011645317078, 'learning_rate': 1.6009420323648742e-05, 'epoch': 0.4663526558783752}
{'loss': 0.1016, 'grad_norm': 13.966999053955078, 'learning_rate': 1.530989133983118e-05, 'epoch': 0.489670288672294}
{'loss': 0.1108, 'grad_norm': 27.371252059936523, 'learning_rate': 1.4610362356013619e-05, 'epoch': 0.5129879214662127}
{'loss': 0.1057, 'grad_norm': 0.08885929733514786, 'learning_rate': 1.3910833372196056e-05, 'epoch': 0.5363055542601315}
{'loss': 0.1086, 'grad_norm': 0.527288556098938, 'learning_rate': 1.3211304388378492e-05, 'epoch': 0.5596231870540502}
{'loss': 0.0945, 'grad_norm': 3.985002040863037, 'learning_rate': 1.251177540456093e-05, 'epoch': 0.5829408198479691}
{'loss': 0.0977, 'grad_norm': 0.16620367765426636, 'learning_rate': 1.1812246420743367e-05, 'epoch': 0.6062584526418878}
{'loss': 0.0977, 'grad_norm': 20.869535446166992, 'learning_rate': 1.1112717436925804e-05, 'epoch': 0.6295760854358066}
{'loss': 0.0903, 'grad_norm': 0.37025347352027893, 'learning_rate': 1.0413188453108242e-05, 'epoch': 0.6528937182297253}
{'loss': 0.0835, 'grad_norm': 0.38350147008895874, 'learning_rate': 9.713659469290677e-06, 'epoch': 0.676211351023644}
{'loss': 0.0852, 'grad_norm': 0.0073177325539290905, 'learning_rate': 9.014130485473115e-06, 'epoch': 0.6995289838175628}
{'loss': 0.0786, 'grad_norm': 10.983654022216797, 'learning_rate': 8.314601501655552e-06, 'epoch': 0.7228466166114816}
{'loss': 0.0761, 'grad_norm': 0.11044564843177795, 'learning_rate': 7.615072517837989e-06, 'epoch': 0.7461642494054004}
{'loss': 0.0718, 'grad_norm': 0.060947246849536896, 'learning_rate': 6.915543534020427e-06, 'epoch': 0.7694818821993191}
{'loss': 0.0814, 'grad_norm': 0.07197830826044083, 'learning_rate': 6.2160145502028635e-06, 'epoch': 0.7927995149932379}
{'loss': 0.0756, 'grad_norm': 0.40519028902053833, 'learning_rate': 5.5164855663853e-06, 'epoch': 0.8161171477871566}
{'loss': 0.0708, 'grad_norm': 1.9413243532180786, 'learning_rate': 4.816956582567738e-06, 'epoch': 0.8394347805810755}
{'loss': 0.0605, 'grad_norm': 0.011760369874536991, 'learning_rate': 4.117427598750175e-06, 'epoch': 0.8627524133749942}
{'loss': 0.0655, 'grad_norm': 0.04331772401928902, 'learning_rate': 3.4178986149326123e-06, 'epoch': 0.8860700461689129}
{'loss': 0.0694, 'grad_norm': 0.022236036136746407, 'learning_rate': 2.7183696311150492e-06, 'epoch': 0.9093876789628317}
{'loss': 0.0682, 'grad_norm': 0.061644770205020905, 'learning_rate': 2.0188406472974867e-06, 'epoch': 0.9327053117567504}
{'loss': 0.0549, 'grad_norm': 3.5652925968170166, 'learning_rate': 1.3193116634799234e-06, 'epoch': 0.9560229445506692}
{'loss': 0.056, 'grad_norm': 1.4908037185668945, 'learning_rate': 6.197826796623607e-07, 'epoch': 0.979340577344588}
{'eval_loss': 0.25808635354042053, 'eval_runtime': 4034.9525, 'eval_samples_per_second': 179.664, 'eval_steps_per_second': 0.702, 'epoch': 1.0}
{'train_runtime': 9819.8137, 'train_samples_per_second': 34.937, 'train_steps_per_second': 2.184, 'train_loss': 0.12751917871739313, 'epoch': 1.0}
Post-processing 331289 example predictions split into 1666112 features.
{
    "157": {
        "QA": {
            "exact_match": 89.04014739174414,
            "f1": 94.92784601667408
        },
        "PR": {
            "p@1": 0.9971220076104234,
            "p@2": 1.0,
            "p@3": 1.0
        },
        "PRQA": {
            "exact_match": 88.8089446558451,
            "f1": 94.70339525039905
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 2672385 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 2672385 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
