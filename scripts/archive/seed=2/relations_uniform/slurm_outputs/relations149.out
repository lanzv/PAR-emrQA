2024-05-11 18:31:10 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 149 ---------------
2024-05-11 18:31:10 INFO     Contexts were splited into 868 paragraphs, which are 2.912751677852349 paragraphs on average per one report. The overall paragraph average length (characters) is 1906.302995391705
2024-05-11 18:31:10 INFO     Contexts were splited into 100 paragraphs, which are 2.380952380952381 paragraphs on average per one report. The overall paragraph average length (characters) is 1799.97
2024-05-11 18:31:11 INFO     Contexts were splited into 226 paragraphs, which are 2.627906976744186 paragraphs on average per one report. The overall paragraph average length (characters) is 1866.2699115044247
2024-05-11 18:31:39 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 18:36:40 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 19:48:36 INFO     the model is trained
2024-05-11 20:10:02 INFO     evaluation data are prepared
2024-05-12 00:13:05 INFO     QA scores: {'exact_match': 92.34502191609268, 'f1': 97.36000959379108}
2024-05-12 00:13:06 INFO     PR scores: {'p@1': 0.9877835846057512, 'p@2': 0.9973989692211358, 'p@3': 0.999837435576321}
2024-05-12 00:13:16 INFO     PRQA scores: {'exact_match': 91.37505418814122, 'f1': 96.57542196744623}
{'loss': 0.6764, 'grad_norm': 8.281506538391113, 'learning_rate': 2.836137207778021e-05, 'epoch': 0.05462093074065982}
{'loss': 0.262, 'grad_norm': 3.7186033725738525, 'learning_rate': 2.672274415556041e-05, 'epoch': 0.10924186148131965}
{'loss': 0.2016, 'grad_norm': 3.698751211166382, 'learning_rate': 2.508411623334062e-05, 'epoch': 0.16386279222197947}
{'loss': 0.1669, 'grad_norm': 2.097256660461426, 'learning_rate': 2.344548831112082e-05, 'epoch': 0.2184837229626393}
{'loss': 0.1484, 'grad_norm': 9.130768775939941, 'learning_rate': 2.180686038890103e-05, 'epoch': 0.2731046537032991}
{'loss': 0.1533, 'grad_norm': 7.735579490661621, 'learning_rate': 2.0168232466681234e-05, 'epoch': 0.32772558444395894}
{'loss': 0.1362, 'grad_norm': 0.7502732276916504, 'learning_rate': 1.852960454446144e-05, 'epoch': 0.38234651518461876}
{'loss': 0.1146, 'grad_norm': 1.7118513584136963, 'learning_rate': 1.6890976622241644e-05, 'epoch': 0.4369674459252786}
{'loss': 0.1132, 'grad_norm': 0.13150615990161896, 'learning_rate': 1.525234870002185e-05, 'epoch': 0.4915883766659384}
{'loss': 0.1007, 'grad_norm': 10.93945026397705, 'learning_rate': 1.3613720777802054e-05, 'epoch': 0.5462093074065982}
{'loss': 0.0991, 'grad_norm': 0.290693461894989, 'learning_rate': 1.1975092855582259e-05, 'epoch': 0.600830238147258}
{'loss': 0.1017, 'grad_norm': 0.03238893672823906, 'learning_rate': 1.0336464933362466e-05, 'epoch': 0.6554511688879179}
{'loss': 0.0828, 'grad_norm': 0.09843963384628296, 'learning_rate': 8.69783701114267e-06, 'epoch': 0.7100720996285776}
{'loss': 0.086, 'grad_norm': 72.13123321533203, 'learning_rate': 7.0592090889228755e-06, 'epoch': 0.7646930303692375}
{'loss': 0.0855, 'grad_norm': 0.0691731870174408, 'learning_rate': 5.4205811667030804e-06, 'epoch': 0.8193139611098973}
{'loss': 0.0659, 'grad_norm': 8.462724685668945, 'learning_rate': 3.781953244483286e-06, 'epoch': 0.8739348918505572}
{'loss': 0.0624, 'grad_norm': 0.09584902226924896, 'learning_rate': 2.1433253222634917e-06, 'epoch': 0.9285558225912169}
{'loss': 0.0736, 'grad_norm': 4.554315567016602, 'learning_rate': 5.046974000436967e-07, 'epoch': 0.9831767533318768}
{'eval_loss': 0.33053192496299744, 'eval_runtime': 1850.5382, 'eval_samples_per_second': 179.075, 'eval_steps_per_second': 0.7, 'epoch': 1.0}
{'train_runtime': 4314.5478, 'train_samples_per_second': 33.944, 'train_steps_per_second': 2.122, 'train_loss': 0.15032650858183366, 'epoch': 1.0}
Post-processing 647268 example predictions split into 1406330 features.
{
    "149": {
        "QA": {
            "exact_match": 92.34502191609268,
            "f1": 97.36000959379108
        },
        "PR": {
            "p@1": 0.9877835846057512,
            "p@2": 0.9973989692211358,
            "p@3": 0.999837435576321
        },
        "PRQA": {
            "exact_match": 91.37505418814122,
            "f1": 96.57542196744623
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 506031 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 506031 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
