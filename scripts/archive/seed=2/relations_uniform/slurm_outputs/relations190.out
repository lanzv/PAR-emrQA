2024-05-11 20:38:08 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 190 ---------------
2024-05-11 20:38:08 INFO     Contexts were splited into 525 paragraphs, which are 1.761744966442953 paragraphs on average per one report. The overall paragraph average length (characters) is 3151.7542857142857
2024-05-11 20:38:08 INFO     Contexts were splited into 63 paragraphs, which are 1.5 paragraphs on average per one report. The overall paragraph average length (characters) is 2857.095238095238
2024-05-11 20:38:09 INFO     Contexts were splited into 140 paragraphs, which are 1.627906976744186 paragraphs on average per one report. The overall paragraph average length (characters) is 3012.692857142857
2024-05-11 20:38:38 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 20:46:31 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 22:38:03 INFO     the model is trained
2024-05-11 22:59:12 INFO     evaluation data are prepared
2024-05-12 02:57:41 INFO     QA scores: {'exact_match': 91.88743316795916, 'f1': 97.35164009654999}
2024-05-12 02:57:41 INFO     PR scores: {'p@1': 0.9894694378883483, 'p@2': 0.99871754732431, 'p@3': 0.9998675400992245}
2024-05-12 02:57:51 INFO     PRQA scores: {'exact_match': 91.15047444728096, 'f1': 96.69613421108441}
{'loss': 0.6719, 'grad_norm': 10.703398704528809, 'learning_rate': 2.8957681884511154e-05, 'epoch': 0.03474393718296157}
{'loss': 0.2291, 'grad_norm': 6.777907371520996, 'learning_rate': 2.7915363769022306e-05, 'epoch': 0.06948787436592314}
{'loss': 0.1956, 'grad_norm': 4.3541412353515625, 'learning_rate': 2.687304565353346e-05, 'epoch': 0.10423181154888472}
{'loss': 0.1622, 'grad_norm': 3.5462372303009033, 'learning_rate': 2.5830727538044612e-05, 'epoch': 0.1389757487318463}
{'loss': 0.1639, 'grad_norm': 7.921927452087402, 'learning_rate': 2.4788409422555765e-05, 'epoch': 0.17371968591480785}
{'loss': 0.1442, 'grad_norm': 20.198305130004883, 'learning_rate': 2.3746091307066918e-05, 'epoch': 0.20846362309776945}
{'loss': 0.1283, 'grad_norm': 0.0509466826915741, 'learning_rate': 2.270377319157807e-05, 'epoch': 0.243207560280731}
{'loss': 0.1181, 'grad_norm': 0.28919968008995056, 'learning_rate': 2.1661455076089223e-05, 'epoch': 0.2779514974636926}
{'loss': 0.117, 'grad_norm': 40.71277618408203, 'learning_rate': 2.0619136960600376e-05, 'epoch': 0.31269543464665417}
{'loss': 0.115, 'grad_norm': 7.793306827545166, 'learning_rate': 1.957681884511153e-05, 'epoch': 0.3474393718296157}
{'loss': 0.1136, 'grad_norm': 0.4797542989253998, 'learning_rate': 1.8534500729622678e-05, 'epoch': 0.3821833090125773}
{'loss': 0.0951, 'grad_norm': 7.722814083099365, 'learning_rate': 1.7492182614133834e-05, 'epoch': 0.4169272461955389}
{'loss': 0.0944, 'grad_norm': 0.6592810153961182, 'learning_rate': 1.6449864498644987e-05, 'epoch': 0.45167118337850043}
{'loss': 0.0899, 'grad_norm': 0.03338592126965523, 'learning_rate': 1.5407546383156137e-05, 'epoch': 0.486415120561462}
{'loss': 0.0767, 'grad_norm': 3.626115560531616, 'learning_rate': 1.4365228267667291e-05, 'epoch': 0.5211590577444236}
{'loss': 0.082, 'grad_norm': 0.657591700553894, 'learning_rate': 1.3322910152178446e-05, 'epoch': 0.5559029949273852}
{'loss': 0.0688, 'grad_norm': 0.747933030128479, 'learning_rate': 1.2280592036689598e-05, 'epoch': 0.5906469321103467}
{'loss': 0.0682, 'grad_norm': 2.845789670944214, 'learning_rate': 1.123827392120075e-05, 'epoch': 0.6253908692933083}
{'loss': 0.0771, 'grad_norm': 22.789669036865234, 'learning_rate': 1.0195955805711904e-05, 'epoch': 0.6601348064762699}
{'loss': 0.0689, 'grad_norm': 9.642043113708496, 'learning_rate': 9.153637690223057e-06, 'epoch': 0.6948787436592314}
{'loss': 0.0582, 'grad_norm': 25.773944854736328, 'learning_rate': 8.111319574734208e-06, 'epoch': 0.7296226808421931}
{'loss': 0.0638, 'grad_norm': 0.04119855910539627, 'learning_rate': 7.0690014592453625e-06, 'epoch': 0.7643666180251546}
{'loss': 0.0606, 'grad_norm': 0.04458508640527725, 'learning_rate': 6.026683343756514e-06, 'epoch': 0.7991105552081161}
{'loss': 0.053, 'grad_norm': 9.725372314453125, 'learning_rate': 4.984365228267667e-06, 'epoch': 0.8338544923910778}
{'loss': 0.052, 'grad_norm': 0.07866818457841873, 'learning_rate': 3.942047112778821e-06, 'epoch': 0.8685984295740393}
{'loss': 0.0583, 'grad_norm': 0.06459319591522217, 'learning_rate': 2.8997289972899733e-06, 'epoch': 0.9033423667570009}
{'loss': 0.0396, 'grad_norm': 1.2088054418563843, 'learning_rate': 1.8574108818011256e-06, 'epoch': 0.9380863039399625}
{'loss': 0.0482, 'grad_norm': 0.008078587241470814, 'learning_rate': 8.150927663122784e-07, 'epoch': 0.972830241122924}
{'eval_loss': 0.24275940656661987, 'eval_runtime': 2835.0962, 'eval_samples_per_second': 180.076, 'eval_steps_per_second': 0.704, 'epoch': 1.0}
{'train_runtime': 6691.0134, 'train_samples_per_second': 34.411, 'train_steps_per_second': 2.151, 'train_loss': 0.11684152675912558, 'epoch': 1.0}
Post-processing 373252 example predictions split into 1405156 features.
{
    "190": {
        "QA": {
            "exact_match": 91.88743316795916,
            "f1": 97.35164009654999
        },
        "PR": {
            "p@1": 0.9894694378883483,
            "p@2": 0.99871754732431,
            "p@3": 0.9998675400992245
        },
        "PRQA": {
            "exact_match": 91.15047444728096,
            "f1": 96.69613421108441
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 714861 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 714861 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
