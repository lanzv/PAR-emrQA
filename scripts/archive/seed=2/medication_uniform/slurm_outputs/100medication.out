2024-05-11 12:22:44 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 100 ---------------
2024-05-11 12:22:44 INFO     Contexts were splited into 787 paragraphs, which are 4.300546448087432 paragraphs on average per one report. The overall paragraph average length (characters) is 1528.9390088945363
2024-05-11 12:22:44 INFO     Contexts were splited into 119 paragraphs, which are 4.576923076923077 paragraphs on average per one report. The overall paragraph average length (characters) is 1521.9663865546217
2024-05-11 12:22:44 INFO     Contexts were splited into 218 paragraphs, which are 4.113207547169812 paragraphs on average per one report. The overall paragraph average length (characters) is 1554.9633027522937
2024-05-11 12:22:52 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 12:24:54 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 13:06:43 INFO     the model is trained
2024-05-11 13:12:03 INFO     evaluation data are prepared
2024-05-11 14:21:52 INFO     QA scores: {'exact_match': 30.79335080108243, 'f1': 73.60432170092872}
2024-05-11 14:21:52 INFO     PR scores: {'p@1': 0.9196555130793351, 'p@2': 0.9880804089171428, 'p@3': 0.9976160817834285}
2024-05-11 14:21:55 INFO     PRQA scores: {'exact_match': 29.818306773764014, 'f1': 70.38846704302125}
{'loss': 1.3617, 'grad_norm': 11.233417510986328, 'learning_rate': 2.8059006211180123e-05, 'epoch': 0.06469979296066253}
{'loss': 0.9226, 'grad_norm': 17.83357048034668, 'learning_rate': 2.611801242236025e-05, 'epoch': 0.12939958592132506}
{'loss': 0.7677, 'grad_norm': 10.388871192932129, 'learning_rate': 2.417701863354037e-05, 'epoch': 0.19409937888198758}
{'loss': 0.6905, 'grad_norm': 6.956501007080078, 'learning_rate': 2.2236024844720497e-05, 'epoch': 0.2587991718426501}
{'loss': 0.5896, 'grad_norm': 8.901213645935059, 'learning_rate': 2.029503105590062e-05, 'epoch': 0.32349896480331264}
{'loss': 0.5376, 'grad_norm': 8.733587265014648, 'learning_rate': 1.8354037267080746e-05, 'epoch': 0.38819875776397517}
{'loss': 0.488, 'grad_norm': 11.428791999816895, 'learning_rate': 1.6413043478260868e-05, 'epoch': 0.4528985507246377}
{'loss': 0.4303, 'grad_norm': 14.906158447265625, 'learning_rate': 1.4472049689440994e-05, 'epoch': 0.5175983436853002}
{'loss': 0.3785, 'grad_norm': 26.66560173034668, 'learning_rate': 1.2531055900621118e-05, 'epoch': 0.5822981366459627}
{'loss': 0.3639, 'grad_norm': 6.818245887756348, 'learning_rate': 1.0590062111801242e-05, 'epoch': 0.6469979296066253}
{'loss': 0.3308, 'grad_norm': 19.634113311767578, 'learning_rate': 8.649068322981366e-06, 'epoch': 0.7116977225672878}
{'loss': 0.302, 'grad_norm': 10.365504264831543, 'learning_rate': 6.7080745341614914e-06, 'epoch': 0.7763975155279503}
{'loss': 0.272, 'grad_norm': 13.180495262145996, 'learning_rate': 4.767080745341615e-06, 'epoch': 0.8410973084886129}
{'loss': 0.2573, 'grad_norm': 13.944013595581055, 'learning_rate': 2.8260869565217393e-06, 'epoch': 0.9057971014492754}
{'loss': 0.2504, 'grad_norm': 0.8011581897735596, 'learning_rate': 8.850931677018634e-07, 'epoch': 0.9704968944099379}
{'eval_loss': 1.4331914186477661, 'eval_runtime': 430.8733, 'eval_samples_per_second': 179.881, 'eval_steps_per_second': 0.703, 'epoch': 1.0}
{'train_runtime': 2508.4802, 'train_samples_per_second': 49.288, 'train_steps_per_second': 3.081, 'train_loss': 0.5218017668951125, 'epoch': 1.0}
Post-processing 213103 example predictions split into 407999 features.
{
    "100": {
        "QA": {
            "exact_match": 30.79335080108243,
            "f1": 73.60432170092872
        },
        "PR": {
            "p@1": 0.9196555130793351,
            "p@2": 0.9880804089171428,
            "p@3": 0.9976160817834285
        },
        "PRQA": {
            "exact_match": 29.818306773764014,
            "f1": 70.38846704302125
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 505007 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 505007 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
