2024-05-11 14:04:23 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 119 ---------------
2024-05-11 14:04:23 INFO     Contexts were splited into 663 paragraphs, which are 3.622950819672131 paragraphs on average per one report. The overall paragraph average length (characters) is 1814.894419306184
2024-05-11 14:04:23 INFO     Contexts were splited into 101 paragraphs, which are 3.8846153846153846 paragraphs on average per one report. The overall paragraph average length (characters) is 1793.2079207920792
2024-05-11 14:04:23 INFO     Contexts were splited into 185 paragraphs, which are 3.490566037735849 paragraphs on average per one report. The overall paragraph average length (characters) is 1832.335135135135
2024-05-11 14:04:31 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 14:06:58 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 14:54:13 INFO     the model is trained
2024-05-11 14:59:43 INFO     evaluation data are prepared
2024-05-11 16:06:20 INFO     QA scores: {'exact_match': 31.510673940122846, 'f1': 73.49006890577472}
2024-05-11 16:06:20 INFO     PR scores: {'p@1': 0.9283321163180276, 'p@2': 0.9902925132081956, 'p@3': 0.9992053605944762}
2024-05-11 16:06:23 INFO     PRQA scores: {'exact_match': 30.36596366135475, 'f1': 70.68909301678826}
{'loss': 1.369, 'grad_norm': 7.699534893035889, 'learning_rate': 2.8273679364714006e-05, 'epoch': 0.05754402117619979}
{'loss': 0.8852, 'grad_norm': 7.3030314445495605, 'learning_rate': 2.6547358729428014e-05, 'epoch': 0.11508804235239958}
{'loss': 0.7298, 'grad_norm': 6.390175819396973, 'learning_rate': 2.482103809414202e-05, 'epoch': 0.1726320635285994}
{'loss': 0.6545, 'grad_norm': 8.255500793457031, 'learning_rate': 2.3094717458856024e-05, 'epoch': 0.23017608470479917}
{'loss': 0.5801, 'grad_norm': 12.565725326538086, 'learning_rate': 2.1368396823570032e-05, 'epoch': 0.28772010588099894}
{'loss': 0.5285, 'grad_norm': 9.912711143493652, 'learning_rate': 1.9642076188284037e-05, 'epoch': 0.3452641270571988}
{'loss': 0.462, 'grad_norm': 14.997115135192871, 'learning_rate': 1.7915755552998046e-05, 'epoch': 0.40280814823339856}
{'loss': 0.4481, 'grad_norm': 13.085226058959961, 'learning_rate': 1.618943491771205e-05, 'epoch': 0.46035216940959833}
{'loss': 0.3788, 'grad_norm': 8.070592880249023, 'learning_rate': 1.4463114282426057e-05, 'epoch': 0.5178961905857982}
{'loss': 0.3568, 'grad_norm': 8.329879760742188, 'learning_rate': 1.2736793647140062e-05, 'epoch': 0.5754402117619979}
{'loss': 0.3162, 'grad_norm': 9.199562072753906, 'learning_rate': 1.1010473011854069e-05, 'epoch': 0.6329842329381977}
{'loss': 0.28, 'grad_norm': 16.86698341369629, 'learning_rate': 9.284152376568075e-06, 'epoch': 0.6905282541143976}
{'loss': 0.2548, 'grad_norm': 4.782689571380615, 'learning_rate': 7.55783174128208e-06, 'epoch': 0.7480722752905973}
{'loss': 0.2668, 'grad_norm': 12.262801170349121, 'learning_rate': 5.831511105996087e-06, 'epoch': 0.8056162964667971}
{'loss': 0.2245, 'grad_norm': 8.664155960083008, 'learning_rate': 4.105190470710094e-06, 'epoch': 0.8631603176429969}
{'loss': 0.2279, 'grad_norm': 2.5071756839752197, 'learning_rate': 2.3788698354241e-06, 'epoch': 0.9207043388191967}
{'loss': 0.225, 'grad_norm': 14.613774299621582, 'learning_rate': 6.525492001381056e-07, 'epoch': 0.9782483599953965}
{'eval_loss': 1.3698948621749878, 'eval_runtime': 490.8021, 'eval_samples_per_second': 178.797, 'eval_steps_per_second': 0.699, 'epoch': 1.0}
{'train_runtime': 2834.5754, 'train_samples_per_second': 49.044, 'train_steps_per_second': 3.065, 'train_loss': 0.47601715809649436, 'epoch': 1.0}
Post-processing 180439 example predictions split into 386266 features.
{
    "119": {
        "QA": {
            "exact_match": 31.510673940122846,
            "f1": 73.49006890577472
        },
        "PR": {
            "p@1": 0.9283321163180276,
            "p@2": 0.9902925132081956,
            "p@3": 0.9992053605944762
        },
        "PRQA": {
            "exact_match": 30.36596366135475,
            "f1": 70.68909301678826
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 505285 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 505285 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
