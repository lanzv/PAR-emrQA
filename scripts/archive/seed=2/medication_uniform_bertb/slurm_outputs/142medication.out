2024-05-11 17:15:32 INFO     ------------- Experiment: model BERTbase, frequency threshold 142 ---------------
2024-05-11 17:15:32 INFO     Contexts were splited into 402 paragraphs, which are 2.19672131147541 paragraphs on average per one report. The overall paragraph average length (characters) is 2993.2213930348257
2024-05-11 17:15:32 INFO     Contexts were splited into 66 paragraphs, which are 2.5384615384615383 paragraphs on average per one report. The overall paragraph average length (characters) is 2744.151515151515
2024-05-11 17:15:32 INFO     Contexts were splited into 113 paragraphs, which are 2.1320754716981134 paragraphs on average per one report. The overall paragraph average length (characters) is 2999.8407079646017
2024-05-11 17:15:39 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/bert-base-cased and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-11 17:19:16 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-11 18:38:52 INFO     the model is trained
2024-05-11 18:44:25 INFO     evaluation data are prepared
2024-05-11 19:57:50 INFO     QA scores: {'exact_match': 29.511189381899403, 'f1': 70.35109069221355}
2024-05-11 19:57:50 INFO     PR scores: {'p@1': 0.947682659679567, 'p@2': 0.9952536403075469, 'p@3': 0.9996563721489626}
2024-05-11 19:57:52 INFO     PRQA scores: {'exact_match': 28.90339762037713, 'f1': 68.44833372746164}
{'loss': 1.193, 'grad_norm': 4.95155668258667, 'learning_rate': 2.8992070958204545e-05, 'epoch': 0.03359763472651525}
{'loss': 0.828, 'grad_norm': 5.421536445617676, 'learning_rate': 2.7984141916409083e-05, 'epoch': 0.0671952694530305}
{'loss': 0.7079, 'grad_norm': 6.745223522186279, 'learning_rate': 2.6976212874613628e-05, 'epoch': 0.10079290417954576}
{'loss': 0.6605, 'grad_norm': 15.347025871276855, 'learning_rate': 2.596828383281817e-05, 'epoch': 0.134390538906061}
{'loss': 0.586, 'grad_norm': 18.937467575073242, 'learning_rate': 2.4960354791022714e-05, 'epoch': 0.16798817363257626}
{'loss': 0.544, 'grad_norm': 12.429104804992676, 'learning_rate': 2.3952425749227255e-05, 'epoch': 0.2015858083590915}
{'loss': 0.5206, 'grad_norm': 11.215423583984375, 'learning_rate': 2.2944496707431797e-05, 'epoch': 0.23518344308560676}
{'loss': 0.4678, 'grad_norm': 18.83696174621582, 'learning_rate': 2.193656766563634e-05, 'epoch': 0.268781077812122}
{'loss': 0.4415, 'grad_norm': 9.45660400390625, 'learning_rate': 2.0928638623840882e-05, 'epoch': 0.3023787125386373}
{'loss': 0.4147, 'grad_norm': 22.843887329101562, 'learning_rate': 1.9920709582045424e-05, 'epoch': 0.3359763472651525}
{'loss': 0.408, 'grad_norm': 16.651248931884766, 'learning_rate': 1.8912780540249965e-05, 'epoch': 0.3695739819916678}
{'loss': 0.3762, 'grad_norm': 21.107940673828125, 'learning_rate': 1.790485149845451e-05, 'epoch': 0.403171616718183}
{'loss': 0.3371, 'grad_norm': 30.70808982849121, 'learning_rate': 1.6896922456659054e-05, 'epoch': 0.4367692514446983}
{'loss': 0.3384, 'grad_norm': 15.940869331359863, 'learning_rate': 1.5888993414863592e-05, 'epoch': 0.4703668861712135}
{'loss': 0.3049, 'grad_norm': 11.560140609741211, 'learning_rate': 1.4881064373068137e-05, 'epoch': 0.5039645208977288}
{'loss': 0.2722, 'grad_norm': 9.061554908752441, 'learning_rate': 1.387313533127268e-05, 'epoch': 0.537562155624244}
{'loss': 0.2783, 'grad_norm': 10.970359802246094, 'learning_rate': 1.2865206289477221e-05, 'epoch': 0.5711597903507593}
{'loss': 0.2685, 'grad_norm': 7.006013870239258, 'learning_rate': 1.1857277247681764e-05, 'epoch': 0.6047574250772746}
{'loss': 0.2331, 'grad_norm': 1.618876338005066, 'learning_rate': 1.0849348205886306e-05, 'epoch': 0.6383550598037898}
{'loss': 0.2464, 'grad_norm': 15.43945026397705, 'learning_rate': 9.841419164090848e-06, 'epoch': 0.671952694530305}
{'loss': 0.2424, 'grad_norm': 7.931027889251709, 'learning_rate': 8.833490122295391e-06, 'epoch': 0.7055503292568204}
{'loss': 0.2258, 'grad_norm': 19.309524536132812, 'learning_rate': 7.825561080499933e-06, 'epoch': 0.7391479639833356}
{'loss': 0.194, 'grad_norm': 15.540885925292969, 'learning_rate': 6.817632038704476e-06, 'epoch': 0.7727455987098508}
{'loss': 0.2035, 'grad_norm': 11.87735652923584, 'learning_rate': 5.809702996909018e-06, 'epoch': 0.806343233436366}
{'loss': 0.201, 'grad_norm': 7.037246227264404, 'learning_rate': 4.80177395511356e-06, 'epoch': 0.8399408681628814}
{'loss': 0.1728, 'grad_norm': 11.637777328491211, 'learning_rate': 3.7938449133181026e-06, 'epoch': 0.8735385028893966}
{'loss': 0.1661, 'grad_norm': 11.851786613464355, 'learning_rate': 2.7859158715226447e-06, 'epoch': 0.9071361376159118}
{'loss': 0.1863, 'grad_norm': 19.250934600830078, 'learning_rate': 1.7779868297271872e-06, 'epoch': 0.940733772342427}
{'loss': 0.1748, 'grad_norm': 23.309480667114258, 'learning_rate': 7.700577879317297e-07, 'epoch': 0.9743314070689424}
{'eval_loss': 1.0504157543182373, 'eval_runtime': 772.7911, 'eval_samples_per_second': 180.157, 'eval_steps_per_second': 0.704, 'epoch': 1.0}
{'train_runtime': 4775.6069, 'train_samples_per_second': 49.858, 'train_steps_per_second': 3.116, 'train_loss': 0.3803132237517822, 'epoch': 1.0}
Post-processing 110915 example predictions split into 434008 features.
{
    "142": {
        "QA": {
            "exact_match": 29.511189381899403,
            "f1": 70.35109069221355
        },
        "PR": {
            "p@1": 0.947682659679567,
            "p@2": 0.9952536403075469,
            "p@3": 0.9996563721489626
        },
        "PRQA": {
            "exact_match": 28.90339762037713,
            "f1": 68.44833372746164
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 713994 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 713994 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
