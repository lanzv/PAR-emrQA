2024-05-09 21:11:08 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 143 ---------------
2024-05-09 21:11:09 INFO     Contexts were splited into 1148 paragraphs, which are 3.8523489932885906 paragraphs on average per one report. The overall paragraph average length (characters) is 1441.3510452961673
2024-05-09 21:11:09 INFO     Contexts were splited into 125 paragraphs, which are 2.9761904761904763 paragraphs on average per one report. The overall paragraph average length (characters) is 1439.976
2024-05-09 21:11:10 INFO     Contexts were splited into 295 paragraphs, which are 3.4302325581395348 paragraphs on average per one report. The overall paragraph average length (characters) is 1429.7525423728814
2024-05-09 21:11:37 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 21:15:45 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 22:13:13 INFO     the model is trained
2024-05-09 22:34:52 INFO     evaluation data are prepared
2024-05-10 02:39:13 INFO     QA scores: {'exact_match': 92.81043784018111, 'f1': 97.63228797397096}
2024-05-10 02:39:13 INFO     PR scores: {'p@1': 0.9832919897885458, 'p@2': 0.9966343143393863, 'p@3': 0.9994520976831559}
2024-05-10 02:39:23 INFO     PRQA scores: {'exact_match': 91.5303935263234, 'f1': 96.52564717027622}
{'loss': 0.6826, 'grad_norm': 0.5423576235771179, 'learning_rate': 2.790707408957723e-05, 'epoch': 0.06976419701409237}
{'loss': 0.2524, 'grad_norm': 6.25693941116333, 'learning_rate': 2.581414817915446e-05, 'epoch': 0.13952839402818473}
{'loss': 0.2077, 'grad_norm': 19.079729080200195, 'learning_rate': 2.3721222268731685e-05, 'epoch': 0.2092925910422771}
{'loss': 0.182, 'grad_norm': 0.9077273607254028, 'learning_rate': 2.1628296358308916e-05, 'epoch': 0.27905678805636946}
{'loss': 0.1373, 'grad_norm': 19.46353530883789, 'learning_rate': 1.9535370447886144e-05, 'epoch': 0.34882098507046183}
{'loss': 0.1313, 'grad_norm': 13.108792304992676, 'learning_rate': 1.7442444537463375e-05, 'epoch': 0.4185851820845542}
{'loss': 0.1219, 'grad_norm': 15.272882461547852, 'learning_rate': 1.5349518627040603e-05, 'epoch': 0.48834937909864656}
{'loss': 0.1169, 'grad_norm': 5.155271530151367, 'learning_rate': 1.3256592716617833e-05, 'epoch': 0.5581135761127389}
{'loss': 0.0932, 'grad_norm': 1.626599669456482, 'learning_rate': 1.1163666806195061e-05, 'epoch': 0.6278777731268314}
{'loss': 0.0888, 'grad_norm': 0.4338350296020508, 'learning_rate': 9.07074089577229e-06, 'epoch': 0.6976419701409237}
{'loss': 0.0872, 'grad_norm': 20.62967300415039, 'learning_rate': 6.977814985349519e-06, 'epoch': 0.7674061671550161}
{'loss': 0.0784, 'grad_norm': 7.849993705749512, 'learning_rate': 4.884889074926748e-06, 'epoch': 0.8371703641691084}
{'loss': 0.0815, 'grad_norm': 14.736262321472168, 'learning_rate': 2.7919631645039765e-06, 'epoch': 0.9069345611832008}
{'loss': 0.0812, 'grad_norm': 0.16964945197105408, 'learning_rate': 6.990372540812055e-07, 'epoch': 0.9766987581972931}
{'eval_loss': 0.28655755519866943, 'eval_runtime': 1513.9795, 'eval_samples_per_second': 178.647, 'eval_steps_per_second': 0.698, 'epoch': 1.0}
{'train_runtime': 3446.3971, 'train_samples_per_second': 33.272, 'train_steps_per_second': 2.08, 'train_loss': 0.16528614904319325, 'epoch': 1.0}
Post-processing 852476 example predictions split into 1399197 features.
{
    "143": {
        "QA": {
            "exact_match": 92.81043784018111,
            "f1": 97.63228797397096
        },
        "PR": {
            "p@1": 0.9832919897885458,
            "p@2": 0.9966343143393863,
            "p@3": 0.9994520976831559
        },
        "PRQA": {
            "exact_match": 91.5303935263234,
            "f1": 96.52564717027622
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 490821 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 490821 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
