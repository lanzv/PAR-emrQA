2024-05-09 21:24:52 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 149 ---------------
2024-05-09 21:24:52 INFO     Contexts were splited into 868 paragraphs, which are 2.912751677852349 paragraphs on average per one report. The overall paragraph average length (characters) is 1906.302995391705
2024-05-09 21:24:52 INFO     Contexts were splited into 100 paragraphs, which are 2.380952380952381 paragraphs on average per one report. The overall paragraph average length (characters) is 1799.97
2024-05-09 21:24:53 INFO     Contexts were splited into 226 paragraphs, which are 2.627906976744186 paragraphs on average per one report. The overall paragraph average length (characters) is 1866.2699115044247
2024-05-09 21:25:21 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-09 21:30:23 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-09 22:42:16 INFO     the model is trained
2024-05-09 23:03:57 INFO     evaluation data are prepared
2024-05-10 03:08:28 INFO     QA scores: {'exact_match': 92.19811184432349, 'f1': 97.47476119893413}
2024-05-10 03:08:29 INFO     PR scores: {'p@1': 0.988783054766148, 'p@2': 0.9981636241028852, 'p@3': 0.9998253937671596}
2024-05-10 03:08:38 INFO     PRQA scores: {'exact_match': 91.29437406675979, 'f1': 96.6936690149475}
{'loss': 0.6669, 'grad_norm': 15.263334274291992, 'learning_rate': 2.8359580052493438e-05, 'epoch': 0.05468066491688539}
{'loss': 0.251, 'grad_norm': 6.605991840362549, 'learning_rate': 2.6719160104986878e-05, 'epoch': 0.10936132983377078}
{'loss': 0.188, 'grad_norm': 6.296626091003418, 'learning_rate': 2.5078740157480315e-05, 'epoch': 0.16404199475065617}
{'loss': 0.1751, 'grad_norm': 7.767584323883057, 'learning_rate': 2.3438320209973752e-05, 'epoch': 0.21872265966754156}
{'loss': 0.1452, 'grad_norm': 0.20585107803344727, 'learning_rate': 2.1797900262467192e-05, 'epoch': 0.27340332458442695}
{'loss': 0.1463, 'grad_norm': 0.23319508135318756, 'learning_rate': 2.015748031496063e-05, 'epoch': 0.32808398950131235}
{'loss': 0.1279, 'grad_norm': 0.2241247445344925, 'learning_rate': 1.851706036745407e-05, 'epoch': 0.38276465441819774}
{'loss': 0.1246, 'grad_norm': 5.309952259063721, 'learning_rate': 1.6876640419947507e-05, 'epoch': 0.4374453193350831}
{'loss': 0.1048, 'grad_norm': 8.740974426269531, 'learning_rate': 1.5236220472440946e-05, 'epoch': 0.4921259842519685}
{'loss': 0.1013, 'grad_norm': 0.09656348079442978, 'learning_rate': 1.3595800524934382e-05, 'epoch': 0.5468066491688539}
{'loss': 0.0957, 'grad_norm': 8.021153450012207, 'learning_rate': 1.1955380577427821e-05, 'epoch': 0.6014873140857393}
{'loss': 0.0789, 'grad_norm': 1.604648470878601, 'learning_rate': 1.031496062992126e-05, 'epoch': 0.6561679790026247}
{'loss': 0.0835, 'grad_norm': 0.016079207882285118, 'learning_rate': 8.674540682414699e-06, 'epoch': 0.7108486439195101}
{'loss': 0.0808, 'grad_norm': 1.3767253160476685, 'learning_rate': 7.034120734908137e-06, 'epoch': 0.7655293088363955}
{'loss': 0.0654, 'grad_norm': 0.1539415419101715, 'learning_rate': 5.393700787401575e-06, 'epoch': 0.8202099737532809}
{'loss': 0.0684, 'grad_norm': 38.01395034790039, 'learning_rate': 3.7532808398950133e-06, 'epoch': 0.8748906386701663}
{'loss': 0.0602, 'grad_norm': 48.148311614990234, 'learning_rate': 2.1128608923884516e-06, 'epoch': 0.9295713035870516}
{'loss': 0.0573, 'grad_norm': 0.12357709556818008, 'learning_rate': 4.724409448818898e-07, 'epoch': 0.984251968503937}
{'eval_loss': 0.34416860342025757, 'eval_runtime': 1850.8466, 'eval_samples_per_second': 179.045, 'eval_steps_per_second': 0.7, 'epoch': 1.0}
{'train_runtime': 4311.9461, 'train_samples_per_second': 33.927, 'train_steps_per_second': 2.121, 'train_loss': 0.14444518694205963, 'epoch': 1.0}
Post-processing 647268 example predictions split into 1406330 features.
{
    "149": {
        "QA": {
            "exact_match": 92.19811184432349,
            "f1": 97.47476119893413
        },
        "PR": {
            "p@1": 0.988783054766148,
            "p@2": 0.9981636241028852,
            "p@3": 0.9998253937671596
        },
        "PRQA": {
            "exact_match": 91.29437406675979,
            "f1": 96.6936690149475
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 490894 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 490894 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
