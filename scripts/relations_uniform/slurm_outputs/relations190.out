2024-05-06 23:44:41 INFO     ------------- Experiment: model ClinicalBERT, frequency threshold 190 ---------------
2024-05-06 23:44:41 INFO     Contexts were splited into 525 paragraphs, which are 1.761744966442953 paragraphs on average per one report. The overall paragraph average length (characters) is 3151.7542857142857
2024-05-06 23:44:42 INFO     Contexts were splited into 63 paragraphs, which are 1.5 paragraphs on average per one report. The overall paragraph average length (characters) is 2857.095238095238
2024-05-06 23:44:42 INFO     Contexts were splited into 140 paragraphs, which are 1.627906976744186 paragraphs on average per one report. The overall paragraph average length (characters) is 3012.692857142857
2024-05-06 23:45:12 INFO     datasets are converted to Datset format
Some weights of BertForQuestionAnswering were not initialized from the model checkpoint at ../models/Bio_ClinicalBERT and are newly initialized: ['qa_outputs.bias', 'qa_outputs.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-05-06 23:52:48 INFO     training data are prepared
/home/lanz/.local/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2024-05-07 01:44:48 INFO     the model is trained
2024-05-07 02:05:17 INFO     evaluation data are prepared
2024-05-07 06:05:17 INFO     QA scores: {'exact_match': 91.95065266605654, 'f1': 97.37304659526728}
2024-05-07 06:05:17 INFO     PR scores: {'p@1': 0.9870430133423246, 'p@2': 0.9984345648090169, 'p@3': 0.9998795819083859}
2024-05-07 06:05:27 INFO     PRQA scores: {'exact_match': 90.90963826405279, 'f1': 96.5158765019159}
{'loss': 0.653, 'grad_norm': 7.596754550933838, 'learning_rate': 2.8957029620358782e-05, 'epoch': 0.03476567932137394}
{'loss': 0.2381, 'grad_norm': 41.623313903808594, 'learning_rate': 2.7914059240717567e-05, 'epoch': 0.06953135864274788}
{'loss': 0.1979, 'grad_norm': 1.5666176080703735, 'learning_rate': 2.6871088861076345e-05, 'epoch': 0.10429703796412182}
{'loss': 0.1595, 'grad_norm': 13.462095260620117, 'learning_rate': 2.5828118481435126e-05, 'epoch': 0.13906271728549577}
{'loss': 0.1524, 'grad_norm': 0.010920719243586063, 'learning_rate': 2.478514810179391e-05, 'epoch': 0.1738283966068697}
{'loss': 0.1389, 'grad_norm': 2.7345378398895264, 'learning_rate': 2.3742177722152693e-05, 'epoch': 0.20859407592824364}
{'loss': 0.1279, 'grad_norm': 8.357891082763672, 'learning_rate': 2.269920734251147e-05, 'epoch': 0.2433597552496176}
{'loss': 0.1172, 'grad_norm': 3.4085066318511963, 'learning_rate': 2.1656236962870256e-05, 'epoch': 0.27812543457099154}
{'loss': 0.122, 'grad_norm': 7.758964538574219, 'learning_rate': 2.0613266583229037e-05, 'epoch': 0.31289111389236546}
{'loss': 0.1001, 'grad_norm': 0.9359135031700134, 'learning_rate': 1.957029620358782e-05, 'epoch': 0.3476567932137394}
{'loss': 0.1007, 'grad_norm': 26.205106735229492, 'learning_rate': 1.85273258239466e-05, 'epoch': 0.38242247253511336}
{'loss': 0.0887, 'grad_norm': 0.12744979560375214, 'learning_rate': 1.748435544430538e-05, 'epoch': 0.4171881518564873}
{'loss': 0.0909, 'grad_norm': 3.183351755142212, 'learning_rate': 1.6441385064664163e-05, 'epoch': 0.4519538311778612}
{'loss': 0.0842, 'grad_norm': 28.102746963500977, 'learning_rate': 1.5398414685022947e-05, 'epoch': 0.4867195104992352}
{'loss': 0.0891, 'grad_norm': 1.4970378875732422, 'learning_rate': 1.4355444305381727e-05, 'epoch': 0.5214851898206091}
{'loss': 0.0843, 'grad_norm': 17.28179359436035, 'learning_rate': 1.331247392574051e-05, 'epoch': 0.5562508691419831}
{'loss': 0.0723, 'grad_norm': 11.829106330871582, 'learning_rate': 1.226950354609929e-05, 'epoch': 0.5910165484633569}
{'loss': 0.0784, 'grad_norm': 3.4527831077575684, 'learning_rate': 1.1226533166458073e-05, 'epoch': 0.6257822277847309}
{'loss': 0.0696, 'grad_norm': 1.62920343875885, 'learning_rate': 1.0183562786816855e-05, 'epoch': 0.6605479071061049}
{'loss': 0.0613, 'grad_norm': 4.497320652008057, 'learning_rate': 9.140592407175636e-06, 'epoch': 0.6953135864274788}
{'loss': 0.0621, 'grad_norm': 0.3069970905780792, 'learning_rate': 8.097622027534417e-06, 'epoch': 0.7300792657488527}
{'loss': 0.0585, 'grad_norm': 0.008446079678833485, 'learning_rate': 7.0546516478932e-06, 'epoch': 0.7648449450702267}
{'loss': 0.0612, 'grad_norm': 0.08904366940259933, 'learning_rate': 6.011681268251982e-06, 'epoch': 0.7996106243916006}
{'loss': 0.0522, 'grad_norm': 0.04600232094526291, 'learning_rate': 4.968710888610763e-06, 'epoch': 0.8343763037129746}
{'loss': 0.0573, 'grad_norm': 0.4737011790275574, 'learning_rate': 3.925740508969545e-06, 'epoch': 0.8691419830343485}
{'loss': 0.0526, 'grad_norm': 0.16988150775432587, 'learning_rate': 2.8827701293283275e-06, 'epoch': 0.9039076623557224}
{'loss': 0.0497, 'grad_norm': 0.8031854629516602, 'learning_rate': 1.8397997496871089e-06, 'epoch': 0.9386733416770964}
{'loss': 0.0463, 'grad_norm': 0.006214055698364973, 'learning_rate': 7.968293700458907e-07, 'epoch': 0.9734390209984704}
{'eval_loss': 0.25216642022132874, 'eval_runtime': 2854.5756, 'eval_samples_per_second': 178.847, 'eval_steps_per_second': 0.699, 'epoch': 1.0}
{'train_runtime': 6719.5605, 'train_samples_per_second': 34.245, 'train_steps_per_second': 2.14, 'train_loss': 0.11480833416173429, 'epoch': 1.0}
Post-processing 373252 example predictions split into 1405156 features.
{
    "190": {
        "QA": {
            "exact_match": 91.95065266605654,
            "f1": 97.37304659526728
        },
        "PR": {
            "p@1": 0.9870430133423246,
            "p@2": 0.9984345648090169,
            "p@3": 0.9998795819083859
        },
        "PRQA": {
            "exact_match": 90.90963826405279,
            "f1": 96.5158765019159
        }
    }
}
slurmstepd: error: common_file_write_uint32s: write pid 628813 to /sys/fs/cgroup/cgroup.procs failed: Device or resource busy
slurmstepd: error: Unable to move pid 628813 to init root cgroup /sys/fs/cgroup
slurmstepd: error: error unlocking cgroup '/sys/fs/cgroup/system.slice/slurmstepd.scope' : Bad file descriptor
